<!-- TEMPLATE FILE - DO NOT ADD METADATA -->
<!-- markdownlint-disable MD002 MD041 -->
> [!NOTE]
> Если бизнес-требования вашей организации изменятся, группы управления Azure помогут вам без усилий реогранизовать иерархию управления и назначения групп подписок. Но при этом имейте в виду, что назначенные группе управления роли и политики наследуются всеми дочерними подписками этой группы в иерархии. Если вы планируете переназначить подписки другим группам управления, тщательно изучите все возможные изменения политик и ролей. Дополнительные сведения см. в документации по [группам управления Azure](/azure/governance/management-groups).

### <a name="governance-of-resources"></a>Система управления ресурсами

Набор глобальных политик и ролей RBAC предоставит минимальный уровень контроля за системой управления. Для реализации MVP системы управления нужно выполнить ряд задач в соответствии с требованиями политик, определяемых командой облачного управления.

1. Задайте пользовательские определения Политики Azure, требуемые для соблюдения бизнес-требований. Вы можете использовать встроенные определения или создать новые пользовательские определения. Быть в курсе всех недавно выпущенных встроенных определений вам поможет [веб-канал Atom](https://github.com/Azure/azure-policy/commits/master/built-in-policies.atom) со всеми фиксациями встроенных политик, который можно настроить в качестве RSS-канала. Также можно использовать [AzAdvertizer](https://www.azadvertizer.net/). 
2. Создайте определение схемы на основе этих встроенных и пользовательских политик и назначений ролей в соответствии с требованиями MVP системы управления.
3. Примените политики и конфигурации глобально, назначив определение схемы всем подпискам.

#### <a name="identify-policy-definitions"></a>Использование определений политик

Azure предлагает несколько встроенных определений для политик и ролей, которые можно назначить любой группе управления, подписке или группе ресурсов. Многие распространенные требования к системе управления могут обрабатываться с использованием встроенных определений. При этом вполне вероятно, что вам также нужно будет создать пользовательские определения политик для обработки своих требований.

Пользовательские определения политик сохраняются в группе управления или в подписке, а затем наследуются по иерархии групп управления. Если определение политики сохранено в группе управления, это определение политики можно назначить любой из групп управления или подписок, дочерних для этой группы.

Так как политики, требуемые для поддержки MVP системы управления, должны применяться ко всем текущим подпискам, с использованием комбинации встроенных и пользовательских определений, созданных в корневой группе управления, будут реализованы приведенные ниже бизнес-требования.

1. Ограничение списка доступных назначений ролей набором встроенных ролей Azure, утвержденных командой управления облаком. Для этого требуется [определение пользовательской политики](https://github.com/azure/azure-policy/tree/master/samples/Authorization/allowed-role-definitions).
2. Обязательное использование следующих тегов для всех ресурсов: *отдел и единица измерения для выставления счетов*, _географический регион_, _тип классификации данных_, _уровень важности_, _соглашение об уровне обслуживания_, _тип среды_, _архетип приложения_, _имя приложения_ и _владелец приложения_. Это можно сделать, используя встроенное определение `Require specified tag`.
3. Обязательное использование одного имени для тега ресурсов `Application` и соответствующей группы ресурсов. Это можно сделать, используя встроенное определение, требующее использовать указанный тег и его значение.

Подробные сведения об определении пользовательских политик см. в [документации по Политике Azure](/azure/governance/policy/tutorials/create-custom-policy-definition). Рекомендации и примеры использования пользовательских политик вы найдете на [сайте примеров Политик Azure](/azure/governance/policy/samples) и в соответствующем [репозитории GitHub](https://github.com/azure/azure-policy).

#### <a name="assign-azure-policy-and-rbac-roles-using-azure-blueprints"></a>Назначение ролей Политики Azure и RBAC с помощью Azure Blueprints

Политики Azure можно назначить на уровне группы ресурсов, подписки и группы управления, а также включить в определения [Azure Blueprints](/azure/governance/blueprints/overview). Хотя требования политик, определенные в этой системе управления с минимальной функциональностью, применяются для всех текущих подписок, для будущих развертываний, скорее всего, потребуются исключения или альтернативные политики. То есть назначение политики с помощью группы управления, в которой все дочерние подписки наследуют это назначение, может оказаться недостаточно гибким для новых сценариев.

Служба Azure Blueprints помогает согласованно назначать политики и роли, применять шаблоны Resource Manager и развертывать группы ресурсов в нескольких подписках. Как и определения политик, определения схем сохраняются в группах управления или подписках. Определения политик доступны путем наследования любыми дочерними элементами в иерархии группы управления.

Команда управления облаком постановила, что применение требуемых назначений Политики Azure и RBAC для подписок будет выполняться через Azure Blueprints и связанные артефакты:

1. В корневой группе управления создайте определение схемы с именем `governance-baseline`.
2. Добавьте в это определение схемы следующие артефакты схемы:
    1. Назначения политик для пользовательских определений Политики Azure, определенные в корневой группе управления.
    2. Определения всех групп ресурсов, которые потребуются в подписках, созданных или управляемых через систему управления с минимальной функциональностью.
    3. Стандартные назначения ролей, которые потребуются в подписках, созданных или управляемых через систему управления с минимальной функциональностью.
3. Опубликуйте определение схемы.
4. Назначьте определения схемы `governance-baseline` всем подпискам.

Подробные сведения о создании и использовании определений схем вы найдете в [документации по Azure Blueprints](/azure/governance/blueprints/overview).

### <a name="secure-hybrid-vnet"></a>Использование защищенной гибридной виртуальной сети

Определенные подписки часто требуют определенный уровень доступа к локальным ресурсам. Это типично для сценариев миграции или разработки, в которых зависимые ресурсы находятся в локальном центре обработки данных.

Пока не установлено отношение доверия в облачной среде, важно строго контролировать и отслеживать все допустимые взаимодействия между локальной средой и облачными рабочими нагрузками, а также обеспечить защиту локальной сети от потенциального несанкционированного доступа облачных ресурсов. Чтобы реализовать поддержку таких сценариев, система управления с минимальной функциональностью включает следующие рекомендации:

1. Настройте защищенную гибридную облачную виртуальную сеть.
    1. [Эталонная архитектура VPN](/azure/architecture/reference-architectures/hybrid-networking/vpn) определяет шаблон и модель развертывания для создания VPN-шлюза в Azure.
    2. Убедитесь, что локальные механизмы управления безопасностью и трафиком не распознают подключенные облачные сети как ненадежные. Размещенные в облаке ресурсы и службы должны иметь доступ только к утвержденным локальным службам.
    3. Убедитесь, что пограничное устройство в локальном центре обработки данных совместимо с [требованиями для VPN-шлюза Azure](/azure/vpn-gateway/vpn-gateway-about-vpn-devices) и имеет выход в общедоступный Интернет.
    4. Обратите внимание, что туннели VPN можно использовать в качестве рабочих каналов только с самыми простыми рабочими нагрузками. Если в вашей среде выполняются не только простые рабочие нагрузки с локальными подключениями, используйте Azure ExpressRoute.
1. В корневой группе управления создайте второе определение схемы с именем `secure-hybrid-vnet`.
    1. Добавьте шаблон Resource Manager для VPN-шлюза в качестве артефакта к такому определению схемы.
    2. Добавьте шаблон Resource Manager для виртуальной сети в качестве артефакта к такому определению схемы.
    3. Опубликуйте определение схемы.
1. Назначьте определение схемы `secure-hybrid-vnet` всем подпискам, которым нужно подключение к локальной среде. Это определение назначается в дополнение к определению схемы `governance-baseline`.

Одной из самых больших проблем, с которой сталкиваются специалисты по ИТ-безопасности и команды традиционного управления, является риск компрометации существующих ресурсов на ранних этапах миграции. Вышеуказанный подход позволяет группам по внедрению облачных технологий создавать и переносить гибридные решения с меньшим риском для локальных ресурсов. По мере роста доверия в облачной среде вы можете позднее отказаться от этого временного решения.

> [!NOTE]
> Вышесказанное является отправной точкой для быстрого создания базового MVP системы управления. Это только начало пути системы управления. Необходима дальнейшая эволюция, так как компания продолжает внедрять облако и берет на себя больший риск в следующих областях:
>
> - Для критически важных рабочих нагрузок
> - защищенные данные;
> - управления затратами;
> - сценарии с несколькими облаками.
>
> Более того, конкретные детали этого продукта с минимальной функциональностью основаны на примере вымышленной компании, путь который описан в следующих статьях. Мы настоятельно рекомендуем ознакомиться с другими статьями этой серии перед реализацией этой рекомендации.
