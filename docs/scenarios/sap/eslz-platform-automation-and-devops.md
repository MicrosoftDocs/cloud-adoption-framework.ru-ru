---
title: Автоматизация платформы корпоративного уровня и DevOps для SAP в Azure
description: Узнайте о зависимостях между системами SAP, средами и ландшафтов для автоматизации развертывания приложений и управления ими.
author: JefferyMitchell
ms.author: brblanch
ms.date: 02/11/2021
ms.topic: conceptual
ms.service: cloud-adoption-framework
ms.subservice: ready
ms.custom: think-tank
ms.openlocfilehash: 0f1cf6045db4a6fabe0f1250bc517ae1bf1be19e
ms.sourcegitcommit: 676ba16fb02b395b048780a9296850934107efd8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/15/2021
ms.locfileid: "103468123"
---
<!-- docutune:casing Snow -->

# <a name="sap-enterprise-scale-platform-automation-and-devops"></a>SAP Enterprise — Автоматизация платформ и DevOps

Все принципы, изложенные в облачной инфраструктуре внедрения, применимы к автоматизации SAP. в этом разделе объясняется, как начать адресацию службы автоматизации SAP.

При принятии решения о применении автоматизации важно обратить внимание на ландшафт приложений SAP, чтобы определить ключевые компоненты и определить стратегию автоматизации на их основе.

Приложения SAP являются критически важными и образуют технологическую основу для предприятий по всему миру. Из-за того, что система SAP является значимой для предприятия, руководства предоставляются SAP и Microsoft Azure, чтобы обеспечить сертификацию, поддержку и успешное внедрение решений. Развертывания SAP и конфигурации системы — это сложные задачи. Используя динамичность облака Azure, организации ищут возможность автоматизировать действия по развертыванию SAP для повышения эффективности работы, управления и пластичная развертываний инфраструктуры.

Репозиторий Microsoft SAP Automation разработан таким образом, что клиенты Azure-SAP могут внедрять сценарии в существующие DevOpsные методики или использовать код "как есть" непосредственно из клона репозитория.

## <a name="sap-architecture"></a>Архитектура SAP

Пространство приложений SAP состоит из систем, зон рабочей нагрузки и ландшафтов.

### <a name="system"></a>Система

Система SAP — это экземпляр приложения SAP, который содержит ресурсы, необходимые для выполнения приложения, такие как виртуальные машины, диски, подсистемы балансировки нагрузки, группы размещения, наборы доступности, подсети и группы безопасности сети. Приложение идентифицируется по уникальному идентификатору SID 3-буквенного идентификатора.

В целях жизненного цикла Каждая система должна развертываться в отдельной группе ресурсов Azure.

### <a name="workload-zone"></a>Зона рабочей нагрузки

Зона рабочей нагрузки также называется средой развертывания и разделяет приложение SAP на такие среды, как непроизводственные и производственные, или может быть более сегментировано на уровни, такие как разработка, контроль качества и Рабочая среда. Среда развертывания предоставляет общие ресурсы, такие как виртуальные сети и хранилища ключей, для всех систем в зоне рабочей нагрузки.

### <a name="landscape"></a>Альбомная

Альбомный — это набор систем в различных средах приложения SAP. На диаграмме примера показаны три SAP ландшафтов: SAP ERP Central (ECC), Управление отношениями с клиентами SAP (CRM) и SAP Business Warehouse (BW).

На следующей схеме показаны зависимости между системами SAP, зонами рабочей нагрузки и ландшафтов. На следующем рисунке у клиента есть три ландшафтов: SAP ERP Central (ECC), Управление отношениями с клиентами SAP (CRM) и SAP Business Warehouse (BW). Каждый альбом имеет четыре зоны рабочей нагрузки: "песочница", "Разработка", "контроль качества" и "Рабочая среда". Каждая зона рабочей нагрузки может содержать одну или несколько систем.

![Приложение SAP. ](./media/SAP_estate.png)
 *Рис. 1. Приложение SAP.*

### <a name="additional-components"></a>Дополнительные компоненты

В дополнение к компонентам SAP, которые потребуется решению для автоматизации:

- Среда выполнения, из которой можно выполнить действия по развертыванию.
- Постоянное хранилище для установочного носителя и, если terraform используется для хранения файлов состояния terraform.

**Рекомендации по проектированию:**

- Используйте виртуальную машину с сетевым подключением к целевым виртуальным сетям, чтобы включить настройку и установку приложений.
- Используйте учетные записи хранения Azure для управления файлами состояния и как источник установки для установочного носителя SAP.

## <a name="preparation-activities"></a>Подготовительные действия

### <a name="deciding-on-a-devops-strategy"></a>Принятие решения о стратегии DevOps

Автоматизация развертывания SAP реализована в виде рабочего процесса, начиная с развертывания инфраструктуры и заканчивая настройкой операционной системы и установкой приложений.

**Рекомендации по проектированию:**

- Определение области автоматизации
  - Инфраструктура
  - конфигурация операционной системы;
  - Установка приложения
  - Текущие операции (операции с состоянием выполнения)
- Определение стратегии хранения файлов параметров

**Рекомендации по проектированию:**

- Хранить все файлы параметров в репозитории системы управления версиями
- Резервное копирование файлов состояния и параметров для защиты от повреждения файлов. Например, можно хранить файлы состояния terraform в учетных записях хранения для геоизбыточного хранилища с доступом для чтения (RA-GRS).

### <a name="region-planning"></a>Планирование регионов

Платформа автоматизации развертывания SAP поддерживает развертывания в нескольких регионах Azure. В каждом регионе будет размещаться следующее:

- Инфраструктура развертывания
- Библиотека SAP для состояния и установочного носителя SAP
- зоны рабочей нагрузки 1 – n
- 1-n систем SAP, развернутых в зонах рабочей нагрузки.

На следующем рисунке показана стратегия развертывания для двух регионов Azure.

![Стратегия SAP DevOps.](./media/SAP_DevOps_strategy.png)

*Рис. 2. Автоматизация SAP в разных регионах.*

**Рекомендации по проектированию:**

- Какие регионы Azure находятся в области действия?
- Рекомендации по аварийному восстановлению

### <a name="workload-zone-planning"></a>Планирование зоны рабочей нагрузки

Зона рабочей нагрузки объединяет виртуальную сеть рабочей нагрузки и набор учетных данных для использования в системах этой рабочей нагрузки, а также субъекта-службы, который используется для развертывания систем. Зоны рабочей нагрузки являются региональными, так как они зависят от виртуальной сети Azure. Соглашение об именовании службы автоматизации поддерживает использование зон рабочей нагрузки в нескольких регионах Azure, каждая из которых имеет собственную виртуальную сеть.

Зона рабочей нагрузки также называется средой развертывания и разделяет приложение SAP на такие среды, как непроизводственные и производственные, или может быть более сегментировано на уровни, такие как разработка, контроль качества и Рабочая среда. Среда развертывания предоставляет общие ресурсы, такие как виртуальные сети и хранилища ключей, для всех систем в зоне рабочей нагрузки.

Ниже приведены некоторые распространенные шаблоны для зон рабочей нагрузки.

#### <a name="production-and-non-production"></a>Рабочая и нерабочая среда

В этой модели среды SAP разделены на две зоны: Рабочая и нерабочая.

#### <a name="sandbox-development-quality-assurance-production"></a>Песочница, разработка, контроль качества, Рабочая среда

В этой модели среды SAP разделены на четыре зоны: "песочница", "Разработка", "контроль качества", "Рабочая"

**Рекомендации по проектированию:**

- Сколько зон рабочей нагрузки требуется?
- Разработка подписки
  - Содержит ли подписка несколько зон рабочей нагрузки
- В каких регионах разворачиваются рабочие нагрузки?
- Исходящее подключение к Интернету
- Сетевое подключение к локальной сети
- Является ли развертывание развертыванием нуля (без инфраструктуры Azure для рабочей нагрузки) или развертыванием серия статей Brownfield (некоторые или все артефакты, поддерживающие эту зону рабочей нагрузки, уже существуют)?
- Учетные данные развертывания, если каждой зоне рабочей нагрузки требуются уникальные учетные данные развертывания?

**Рекомендации по проектированию:**

- Сетевое подключение к Интернету должно предоставляться командой сети
- Сетевое подключение к локальной сети должно предоставляться командой сети
- Используйте уникальные учетные данные развертывания на каждую зону рабочей нагрузки. **Примечание** . Если зона рабочей нагрузки существует в нескольких регионах, они должны использовать одни и те же учетные данные развертывания.
- Постарайтесь сократить количество зон рабочей нагрузки, чтобы упростить планирование сети.

### <a name="sap-application-planning"></a>Планирование приложений SAP

Система SAP — это реальное приложение SAP, которое содержит все Azure Artifacts, необходимые для размещения приложения SAP. Дополнительные сведения о начале работы, планировании и рассмотрении факторов развертывания см. в статье [SAP в Azure](/azure/virtual-machines/workloads/sap/get-started) .

**Рекомендации по проектированию:**

- Какой сервер базы данных использовать?
- Сколько серверов баз данных?
- Требуется ли высокая доступность?
- Сколько серверов приложений?
- Число веб-диспетчеров (если есть)?
- Количество экземпляров центральных служб?
- Размеры виртуальных машин?
- Решите, следует ли использовать образ Azure Marketplace или пользовательский образ. Пользовательские образы имеют несколько преимуществ, таких как конфигурация ОС конкретного клиента, усиление безопасности и средства обеспечения соответствия. Пользовательские образы также потенциально могут упростить управление жизненным циклом изображений.
- Является ли развертывание развертыванием нуля (без инфраструктуры Azure для созданных подсетей) или развертыванием серия статей Brownfield (некоторые или все артефакты для подсетей уже существуют)?
- Стратегия выделения IP-адресов (предоставлены Azure или заказчик)
- Соглашение об именовании для ресурсов Azure
- Определение требований к управлению учетными данными. могут ли все системы в зоне рабочей нагрузки использовать одни и те же учетные данные для доступа к виртуальным машинам?

**Рекомендации по проектированию:**

- Используйте стандартные соглашения об именовании SAP Automation по умолчанию. Автоматизация SAP публикует набор правил именования для соглашений об [именовании.](https://github.com/Azure/sap-hana/blob/master/documentation/SAP_Automation_on_Azure/Software_Documentation/standards-naming.md)
- Используйте один и тот же набор учетных данных для каждой системы, развернутой в зоне рабочей нагрузки. Azure Key Vault является рекомендуемым решением для управления ключами и хранилища ключей.

## <a name="the-sap-deployment-automation-framework"></a>Платформа автоматизации развертывания SAP

Платформа автоматизации развертывания SAP предоставляет как шаблоны terraform, так и Ansible модули PlayBook, которые можно использовать для создания и настройки сред для запуска SAP в Azure. Артефакты размещаются в репозитории [SAP-HANA](https://github.com/Azure/sap-hana) . Сценарии развертывания SAP в Azure являются открытыми и поддерживаются в Azure (не настраиваемый код).

### <a name="automation-capabilities"></a>Возможности службы автоматизации

#### <a name="supported-platforms"></a>Поддерживаемые платформы

Автоматизация развертывания SAP поддерживает развертывание как в Linux, так и в Windows

#### <a name="supported-topologies"></a>Поддерживаемые топологии

Модель развертывания по умолчанию с использованием автоматизации развертывания SAP — это распределенная модель с уровнем базы данных и уровнем приложения. Уровень приложения можно разделить на три уровня: серверы приложений, серверы Центральной службы и веб-диспетчеры.

Кроме того, службу автоматизации можно развернуть на отдельном сервере, указав конфигурацию без уровня приложения.

#### <a name="included-capabilities"></a>Включаемые возможности

Матрица возможностей платформы автоматизации развертывания SAP

| Компонент | Включено | Примечания |
|:-|:-|:-|
| Ускорение работы в сети | Y | Функция ускорения сети включена на виртуальных машинах |
| Группы безопасности приложений | N | В плане |
| Привязка виртуальной машины | Y | Виртуальная машина, которая используется для привязки группы размещения с учетом расположения в зоне доступности. |
| Конфигурация приложений | N | Конфигурация на основе Ansible будет выпущена в ближайшее время |
| Установка приложения | N | Установка на основе Ansible вскоре будет выпущена |
| Аутентификация | Y | Проверка подлинности поддерживает проверку подлинности на основе SSH, а также проверку подлинности на основе пароля и имени пользователя. |
| зоны доступности; | Y | Автоматизация позволяет развертывать виртуальные машины зональные или в Зоны доступности |
| Службы файлов Azure для NFS | N | В плане |
| Брандмауэр Azure | Y | Служба автоматизации может развернуть брандмауэр Azure в сети развертывания. |
| Azure Load Balancer | Y | Автоматизация использует стандартные подсистемы балансировки нагрузки Azure |
| Azure NetApp Files | N | В плане |
| Учетная запись хранения для диагностики загрузки | Y | Учетная запись хранения для диагностики загрузки является общей для всех систем в зоне рабочей нагрузки. |
| Хранилища ключей Azure | Y | Новые хранилища ключей Azure или существующие |
| Образы клиентов | Y | Пользовательские образы должны быть реплицированы в регион |
| Ключи шифрования дисков, управляемых клиентом | Y | Ключи необходимо предварительно создать и сохранить в Azure Key Vault |
| Среда развертывания | Y | Виртуальная машина в сети, подключенная к сетям SAP |
| Размер диска | Y | Задано определение размера диска по умолчанию, можно настроить |
| Назначение IP-адресов | Y | Указанные пользователем IP-адреса и предоставленные Azure |
| Соглашение об именовании | Y | Соглашение об именовании по умолчанию, можно настроить |
| Группы безопасности сети | Y | Новые группы безопасности сети или существующие |
| конфигурация операционной системы; | N | Конфигурация на основе Ansible будет выпущена в ближайшее время |
| Группы размещения близкого взаимодействия | Y | Новые группы размещения с учетом расположения или существующие |
| групп ресурсов; | Y | Новая группа ресурсов или существующая |
| Подсети | Y | Новые подсети или существующие |
| Хранилище для установочного носителя SAP | Y | Создать учетную запись хранения или существующую |
| Хранилище для состояния terraform | Y | Создать учетную запись хранения или существующую |
| Номер SKU виртуальной машины | Y | Все номера SKU виртуальных машин можно настроить. |
| Виртуальные сети | Y | Новая виртуальная сеть или существующая |
| Учетная запись хранения следящего сервера | Y | Учетная запись хранения следящего сервера является общей для всех систем в зоне рабочей нагрузки. Используется для сценариев высокого уровня доступности Windows |

### <a name="planning-for-the-parameter-files"></a>Планирование файлов параметров

Автоматизация развертывания SAP использует файлы параметров JSON для настройки среды Azure с разными файлами параметров для различных артефактов.

Среда разработки должна клонировать `SAP HANA` репозиторий и репозиторий клиентов в одну корневую папку.

Наличие файлов параметров в предварительно определенной структуре папок упростит автоматизированные операции развертывания.

**Рекомендации по проектированию:**

Все файлы параметров должны храниться в среде системы управления версиями.
