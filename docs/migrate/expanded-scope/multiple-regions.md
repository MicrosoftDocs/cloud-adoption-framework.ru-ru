---
title: Устранение сложности миграции в нескольких географических регионах
titleSuffix: Microsoft Cloud Adoption Framework for Azure
description: Устранение сложности миграции в нескольких географических регионах.
author: BrianBlanchard
ms.author: brblanch
ms.date: 04/04/2019
ms.topic: guide
ms.service: cloud-adoption-framework
ms.subservice: migrate
ms.openlocfilehash: 2d834b9e7c3e661561dc44b8d3104ef819f0c6af
ms.sourcegitcommit: 443c28f3afeedfbfe8b9980875a54afdbebd83a8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "71025486"
---
# <a name="multiple-geographic-regions"></a>Несколько географических регионов

Когда организация работает в нескольких географических регионах, процесс миграции в облако усложняется. Эти сложности выражаются в трех основных формах: распределение ресурсов, профили доступа пользователей и требования соответствия. Прежде чем устранять сложности, связанные с несколькими регионами, важно понять степень потенциальной сложности.

## <a name="general-scope-expansion"></a>Расширение общей области

Следующий подход поможет оценить потенциальные проблемы и определить общее направление действий.

- Рассмотрите более надежную реализацию средств обеспечения готовности и системы управления.
- Выполните инвентаризацию затронутых географий. Составьте список регионов и стран, на которые влияет миграция в облако.
- Задокументируйте требования к независимости данных. Действуют ли в указанных странах требования, регулирующие независимость данных?
- Задокументируйте базу пользователей. Повлияет ли миграция облака на сотрудников, партнеров или клиентов в указанной стране?
- Задокументируйте центры обработки данных и ресурсы. Размещены ли в указанной стране ресурсы, которые могут участвовать в процессе миграции?

Сопоставьте изменения в процессе миграции, чтобы учесть первоначальные данные инвентаризации.

### <a name="documenting-complexity"></a>Документирование сложности

Следующая таблица поможет в документировании результатов описанных выше действий.

|Район  |Country  |Местные сотрудники  |Местные внешние пользователи  |Местные центры обработки данных или ресурсы |Требования к независимости данных  |
|---------|---------|---------|---------|---------|---------|
|Северная Америка     |США         |Да         |Партнеры и клиенты         |Да         |Нет         |
|Северная Америка     |Канада         |Нет         |Клиентов:         |Да         |Да         |
|Европа     |Германия         |Да         |Партнеры и клиенты         |Нет, только сеть         |Да         |
|Азиатско-Тихоокеанский регион     |Республика Корея         |Да         |Партнеры         |Да         |Нет         |

<!-- markdownlint-disable MD026 -->

### <a name="why-is-data-sovereignty-relevant"></a>Почему важна независимость данных?

По всему миру правительственные организации начали устанавливать требования к независимости данных, такие как Общий регламент по защите данных (GDPR). Подобные требования соответствия часто требуют локализации в определенном регионе или даже в определенной стране для защиты граждан. В некоторых случаях данные, относящиеся к клиентам, сотрудникам или партнерам, должны храниться на облачной платформе в регионе, в котором находится сам пользователь.

Решение этой задачи было важным фактором, мотивирующим компании, которые работают по всему миру, выполнить миграцию в облако. Для обеспечения требований соответствия некоторые компании решили развернуть дубликаты ИТ-ресурсов в облачных поставщиках в соответствующем регионе. В приведенной выше таблице хорошим примером такого сценария является Германия. В этом примере есть клиент, партнеры и сотрудники, которые находятся в Германии, но ИТ-ресурсы размещены в другой стране. Эта компания может развернуть некоторые ресурсы в центре обработки данных в области действия GDPR, возможно, даже используя центр обработки данных Azure для Германии. Поняв, на какие данные распространяется действие GDPR, команда по внедрению в облако сможет выбрать наилучший подход к миграции для текущей ситуации.

### <a name="why-is-the-location-of-end-users-relevant"></a>Почему важно расположение пользователей?

Компании, обслуживающие пользователей в нескольких странах, разработали технические решения для передачи трафика пользователей. В некоторых случаях это подразумевает локализацию ресурсов. В других сценариях вместо этого компания может внедрить глобальные сети, чтобы использовать разнородные базы пользователей с помощью сетевых решений. В любом случае на стратегию миграции могут влиять профили использования этих разнородных пользователей.

Так как компания обслуживает сотрудников, партнеров и клиентов в Германии, но сейчас в этой стране нет центров обработки данных, скорее всего, эта компания внедрила некоторое решение с арендой каналов для передачи трафика в центры обработки данных в других странах. Эта маршрутизация представляет значительный риск для наблюдаемой производительности перенесенных приложений. Внедрение дополнительных прыжков в установленную и настроенную глобальную сеть может привести к видимому ухудшению работы приложений после миграции. Поиск и устранение этих проблем может значительно задержать завершение проекта. В каждом из описанных ниже процессов рекомендации по устранению этой сложности включают в себя предварительные требования, оценку, миграцию и оптимизацию. Чтобы правильно управлять этой сложностью, важно понимать профили пользователей в каждой стране.

### <a name="why-is-the-location-of-datacenters-relevant"></a>Почему важно расположение центров обработки данных?

Расположение существующих центров обработки данных может повлиять на стратегию миграции. Ниже приведены некоторые из наиболее распространенных факторов.

**Решения по архитектуре.** Целевой регион или расположение являются одним из первых факторов, учитываемых при проектировании стратегии миграции. На стратегию часто влияет расположение существующих ресурсов. Кроме того, доступные облачные службы и стоимость единицы этих служб могут отличаться для разных регионов. Поэтому понимание текущего и будущего расположения ресурсов влияет на решения по архитектуре и может повлиять на оценку бюджета.

**Зависимости центров обработки данных.** Согласно данным в таблице выше, вероятно, между различными центрами обработки данных, расположенными по всему миру, существуют зависимости. Во многих организациях, которые работают в таком масштабе, эти зависимости могут быть не задокументированы или не определены. Подходы, используемые для оценки профилей пользователей, помогут определить некоторые из этих зависимостей. Однако во время процесса оценки предлагается принять дополнительные меры по устранению рисков, связанных с этой сложностью.

## <a name="implementing-the-general-approach"></a>Реализация общего подхода

Этот подход основан на количественной информации. Таким образом, в приведенном ниже подходе для устранения сложностей глобальной миграции будет применена модель, управляемая данными.

## <a name="suggested-prerequisites"></a>Рекомендуемые предварительные требования

Рекомендуется, чтобы команда по внедрению в облако начала миграцию с простой рабочей нагрузки с помощью [руководства по миграции в Azure](../azure-migration-guide/index.md), прежде чем пытаться выполнить глобальный перенос. Это позволит группе изучить общий процесс миграции в облако, прежде чем выполнять более сложный сценарий миграции.

Если область миграции включает в себя несколько регионов, следует оценить следующие аспекты готовности. Оценку должна выполнить команда по внедрению в облако.

- Для обеспечения независимости данных может потребоваться локализовать некоторые ресурсы, но существует множество ресурсов, которые не регулируются этими ограничениями соответствия. Службы, отвечающие за ведение журнала, создание отчетов, маршрутизацию сетей, идентификацию и другие центральные ИТ-службы могут быть размещены как общие службы в нескольких подписках или даже в нескольких регионах. Рекомендуется, чтобы группа по внедрению облачных технологий оценила применение модели общей службы для этих служб, как описано в [эталонной архитектуре топологии "звезда" с общими службами](https://docs.microsoft.com/azure/architecture/reference-architectures/hybrid-networking/shared-services).
- При развертывании нескольких экземпляров аналогичных сред фабрика сред может обеспечить согласованность, улучшить управление и ускорить развертывание. [Внедрение системы управления на крупном предприятии](../../govern/guides/complex/index.md) обеспечивает подход, позволяющий создать фабрику сред, которая охватывает несколько регионов.

После того, как группа одобрила базовый подход и все готово к миграции, нужно рассмотреть несколько предварительных условий, определяемых данными.

- **Общее обнаружение.** Заполните приведенную выше таблицу [Документирование сложности](#documenting-complexity).
- **Анализ профилей пользователей в каждой затронутой стране.** Важно понимать общие маршруты данных пользователей на ранних этапах процесса миграции. Изменение глобальных арендованных каналов и добавление таких подключений, как ExpressRoute, в облачный центр обработки данных может потребовать месяцев задержек в сети. Выполните эту задачу как можно раньше в процессе миграции.
- **Рационализация начальных цифровых активов.** Как только стратегия миграции усложняется, необходимо выполнить рационализацию начальных цифровых активов. Дополнительные сведения см. в руководстве по [рационализации цифровых активов](../../digital-estate/index.md).
  - **Дополнительные требования к цифровым активам.** Установите политики добавления тегов, чтобы определить рабочие нагрузки, на которые распространяются требования к независимости данных. Обязательные теги должны появиться на этапе рационализации цифровых активов, а потом их нужно передать в перенесенные ресурсы.
- **Оценка модели "звезда".** В распределенных системах часто используются общие зависимости. Эти зависимости часто могут быть реализованы с помощью модели "звезда". Хотя такая модель не входит в процесс миграции, она должна быть помечена для рассмотрения на будущих этапах [процессов подготовки](../../ready/index.md).
- **Установка приоритетов невыполненной работы по миграции.** Если для поддержки рабочего развертывания рабочей нагрузки, которая обслуживает несколько регионов, требуются изменения сети, важно, чтобы команда по вопросам облачной стратегии отслеживала и контролировала последствия этих изменений. Поддержка руководителей более высокого уровня поможет ускорить изменение. Однако, что более важно: это дает группе по стратегии возможность задать приоритет невыполненной работы, чтобы гарантировать, что глобальные рабочие нагрузки не будут блокироваться изменениями сети. Таким рабочим нагрузкам следует назначать приоритет только после завершения изменений сети.

Эти предварительные требования помогут установить процессы, которые могут устранить эту сложность во время реализации стратегии миграции.

## <a name="assess-process-changes"></a>Изменения в процессе оценки

При устранении сложности, обусловленной глобальными ресурсами и базами пользователей, существует несколько ключевых действий, которые следует добавить в оценку любого кандидата на перенос. Все эти изменения прояснят влияние глобальных пользователей и ресурсов при применении подхода, управляемого данными.

### <a name="suggested-action-during-the-assess-process"></a>Предлагаемое действие во время процесса оценки

**Оценка зависимостей между центрами обработки данных.** [Инструменты визуализации зависимостей в Миграции Azure](https://docs.microsoft.com/azure/migrate/concepts-dependency-visualization) помогут выявить зависимости. Используйте этот набор средств до миграции — это хорошая общая рекомендация. Однако при решении задач глобальной сложности она станет необходимым шагом для процесса оценки. Благодаря [группированию зависимостей](https://docs.microsoft.com/azure/migrate/how-to-create-group-machine-dependencies) визуализация поможет определить IP-адреса и порты всех ресурсов, необходимых для поддержки рабочей нагрузки.

> [!IMPORTANT]
> Два важных примечания. Во-первых, профильный эксперт, имеющий представление о размещении ресурсов и схемах IP-адресов, должен выявить ресурсы, которые находятся в дополнительном центре обработки данных. Во-вторых, важно оценить нисходящие зависимости и клиенты в визуализации, чтобы выявить двунаправленные зависимости.

**Определение влияния глобальных пользователей.** Результаты обязательного предварительного анализа профилей пользователей должны выявить все рабочие нагрузки, охватываемые глобальными профилями пользователей. Если кандидат на миграцию находится в списке затронутых рабочих нагрузок, архитектор, подготавливающий миграцию, должен обратиться к профильным специалистам по сетям и операциям, чтобы проверить сетевую маршрутизацию и ожидаемую производительность. Как минимум, архитектура должна включать в себя подключение ExpressRoute между ближайшим сетевым операционным центром (NOC) и Azure. [Эталонная архитектура для подключений ExpressRoute](https://docs.microsoft.com/azure/architecture/reference-architectures/hybrid-networking/expressroute) может помочь в настройке необходимого подключения.

**Проектирование для обеспечения соответствия.** Результаты обязательного предварительного анализа профилей пользователей должны выявить все рабочие нагрузки, на которые распространяются требования к независимости данных. Во время операций с архитектурой, выполняемых в процессе оценки, назначенный архитектор должен проконсультироваться у профильных специалистов по соответствию, чтобы понять требования к миграции и развертыванию в нескольких регионах. Эти требования существенно повлияют на стратегии проектирования. Эталонные архитектуры [веб-приложений в нескольких регионах](https://docs.microsoft.com/azure/architecture/reference-architectures/app-service-web-app/multi-region) и [n-уровневых приложений в нескольких регионах](https://docs.microsoft.com/azure/architecture/reference-architectures/n-tier/multi-region-sql-server) могут помочь в проектировании.

> [!WARNING]
> При использовании любой из указанных выше эталонных архитектур может потребоваться исключить определенные элементы данных из процессов репликации, чтобы выполнить требования к независимости данных. Это приведет к добавлению дополнительного шага в процесс перемещения в рабочую среду.

## <a name="migrate-process-changes"></a>Изменения в процессе миграции

При переносе приложения, которое должно быть развернуто в нескольких регионах, существует ряд рекомендаций, которые следует учесть команде по внедрению в облако. Эти рекомендации относятся к проектированию хранилища Azure Site Recovery, проектированию серверов конфигурации и обработки, проектированию пропускной способности сети и синхронизации данных.

### <a name="suggested-action-during-the-migrate-process"></a>Предлагаемое действие во время процесса миграции

**Проектирование хранилища Azure Site Recovery.** Azure Site Recovery — это рекомендуемый облачный инструмент для репликации и синхронизации цифровых активов в Azure. Site Recovery реплицирует данные о ресурсе в хранилище Site Recovery, которое привязано к определенной подписке в определенном регионе и центре обработки данных Azure. При репликации ресурсов во второй регион может потребоваться второе хранилище Site Recovery.

**Проектирование серверов конфигурации и обработки.** Site Recovery взаимодействует с локальными экземплярами серверов конфигурации и обработки, которые привязаны к отдельному хранилищу Site Recovery. Это означает, что для упрощения репликации может потребоваться установить вторые экземпляры этих серверов в исходном центре обработки данных.

**Проектирование пропускной способности сети.** Во время репликации и текущей синхронизации двоичные данные перемещаются по сети из исходного центра обработки данных в хранилище Site Recovery, размещенное в целевом центре обработки данных Azure. Этот процесс потребляет пропускную способность. Дублирование рабочей нагрузки во второй регион приведет к удвоению потребляемой пропускной способности. Если пропускная способность ограничена или рабочая нагрузка требует передачи большого объема данных конфигурации или отклонения данных, это может повлиять на время, необходимое для завершения миграции. Что более важно, это может повлиять на работу пользователей или приложений, которые по-прежнему зависят от пропускной способности исходного центра обработки данных.

**Синхронизация данных.** Часто увеличение потребления пропускной способности происходит из-за синхронизации платформы данных. Как определено в эталонных архитектурах [веб-приложений для нескольких регионов](https://docs.microsoft.com/azure/architecture/reference-architectures/app-service-web-app/multi-region) и [n-уровневых приложений для нескольких регионов](https://docs.microsoft.com/azure/architecture/reference-architectures/n-tier/multi-region-sql-server), синхронизация данных часто требуется для того, чтобы поддерживать согласованность приложений. Если это требуемое рабочее состояние приложения, может быть целесообразно выполнить синхронизацию исходной платформы данных с каждой облачной платформой перед переносом приложений и ресурсов среднего уровня.
**Синхронизация данных.** Часто увеличение потребления пропускной способности происходит из-за синхронизации платформы данных. Как определено в эталонных архитектурах [веб-приложений для нескольких регионов](https://docs.microsoft.com/azure/architecture/reference-architectures/app-service-web-app/multi-region) и [n-уровневых приложений для нескольких регионов](https://docs.microsoft.com/azure/architecture/reference-architectures/n-tier/multi-region-sql-server), синхронизация данных часто требуется для того, чтобы поддерживать согласованность приложений. Если это требуемое рабочее состояние приложения, может быть целесообразно выполнить синхронизацию исходной платформы данных с каждой облачной платформой перед переносом приложений и ресурсов среднего уровня.

**Аварийное восстановление из Azure в Azure.** Существует альтернативное решение, которое может уменьшить сложность. Если подходы на основе временных шкал и синхронизации данных применяются к двухэтапному развертыванию, [аварийное восстановление из Azure в Azure](https://docs.microsoft.com/azure/site-recovery/azure-to-azure-architecture) оказаться вполне приемлемым решением. В этом сценарии рабочая нагрузка переносится в первый центр обработки данных Azure с помощью одного хранилища Site Recovery и сервера конфигурации или обработки. После тестирования рабочей нагрузки ее можно будет восстановить во второй центр обработки данных Azure с помощью перенесенных ресурсов. Такой подход позволяет сократить влияние на ресурсы в исходном центре обработки данных и использовать преимущества ускоренной передачи данных и высокой пропускной способности подключения между центрами обработки данных Azure.

> [!NOTE]
> Данный подход может увеличить краткосрочную стоимость миграции, так как может привести к дополнительным расходам на пропускную способность.

## <a name="optimize-and-promote-process-changes"></a>Изменение процесса оптимизации и перемещения в рабочую среду

Устранение глобальной сложности во время оптимизации и перемещения в рабочую среду может потребовать повторения действий в каждом из дополнительных регионов. Если отдельное развертывание приемлемо, может потребоваться дублирование планов тестирования и изменения организации.

### <a name="suggested-action-during-the-optimize-and-promote-process"></a>Предлагаемое действие во время процесса оптимизации и перемещения в рабочую среду

**Оптимизация перед тестированием.** Первоначальное тестирование автоматизации позволяет выявить потенциальные возможности для оптимизации, как и при любых процессах миграции. В случае глобальной рабочей нагрузи важно отдельно протестировать рабочую нагрузку в каждом регионе, так как небольшие изменения в конфигурации сети или целевого центра обработки данных Azure могут повлиять на производительность.

**План изменения организации.** Для любого сложного сценария миграции рекомендуется создать план изменения организации, чтобы обеспечить четкое взаимопонимание в отношении изменений в бизнес-процессах, взаимодействии с пользователями и графике действий, необходимых для внедрения изменений. В случае глобальной миграции этот план должен включать в себя рекомендации для пользователей в каждой охваченной географии.

**Тестирование организации.** В сочетании с планом изменения организации может потребоваться выполнить тестирование организации в каждом регионе, чтобы обеспечить необходимую производительность и соответствие измененным шаблонам сетевой маршрутизации.

**Поэтапное перемещение в рабочую среду.** Часто перемещение в рабочую среду происходит как одно действие, перенаправляющее рабочий трафик в перенесенные рабочие нагрузки. В случае глобального выпуска рекомендуется перемещать данные в рабочую среду поэтапно (или для предопределенных коллекций пользователей). Это позволяет команде по вопросам облачной стратегии и команде по внедрению в облако выполнять эффективный мониторинг производительности и обеспечивать поддержку пользователей в каждом регионе. Этапы перемещения в рабочую среду часто контролируются на уровне сети. Для этого изменяется маршрутизация для конкретных диапазонов IP-адресов ресурсов исходной рабочей нагрузки, после чего трафик передается в только что перенесенные ресурсы. После переноса указанной коллекции пользователей можно изменить маршрутизацию для следующей группы.

**Оптимизация этапов.** Одним из преимуществ поэтапного перемещения в рабочую среду является то, что это позволяет эффективнее отслеживать и дополнительно оптимизировать развернутые ресурсы. По истечении непродолжительного периода использования рабочей среды после первого этапа перемещения предлагается дополнительная корректировка перенесенных ресурсов, если это допускается процедурами ИТ-операций.

## <a name="next-steps"></a>Следующие шаги

Отдельным фактором, нередко усложняющим миграцию в нескольких регионах, является необходимость подготовиться к миграции [нескольких центров обработки данных](./multiple-datacenters.md). Аналогичным образом, эта сложность обусловлена и объемом ресурсов, подлежащих переносу при миграции нескольких центров обработки данных в облако.

> [!div class="nextstepaction"]
> [Миграция нескольких центров обработки данных](./multiple-datacenters.md)
