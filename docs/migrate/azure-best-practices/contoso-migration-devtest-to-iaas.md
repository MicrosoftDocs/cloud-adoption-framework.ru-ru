---
title: Повторное размещение локальной среды разработки и тестирования на виртуальных машинах Azure с помощью службы "миграция Azure"
description: Узнайте, как Contoso переводит локальную среду разработки и тестирования, переключая локальные компьютеры в Azure, используя подход с приближением и сдвигом, а также службу "миграция Azure".
author: deltadan
ms.author: abuck
ms.date: 07/1/2020
ms.topic: conceptual
ms.service: cloud-adoption-framework
ms.subservice: migrate
ms.custom: think-tank
ms.openlocfilehash: 6256de325aff36a6a9788722a2689cdf7af71657
ms.sourcegitcommit: a0ddde4afcc7d8c21559e79d406dc439ee4f38d2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/21/2020
ms.locfileid: "97712440"
---
<!-- cSpell:ignore vcenter contosohost contosodc NSGs agentless WEBVMDEV SQLVMDEV OSTICKETWEBDEV OSTICKETMYSQLDEV -->

# <a name="rehost-an-on-premises-devtest-environment-on-azure-virtual-machines-via-azure-migrate"></a>Повторное размещение локальной среды разработки и тестирования на виртуальных машинах Azure с помощью службы "миграция Azure"

В этой статье показано, как вымышленная компания Contoso повторно размещает свою среду разработки и тестирования для двух приложений, работающих на виртуальных машинах VMware, путем перехода на виртуальные машины Azure.

Приложения [SmartHotel360](https://github.com/Microsoft/SmartHotel360) и [остиккет](https://github.com/osTicket/osTicket) , используемые в этом примере, имеют открытый исходный код. Их можно скачать для собственных целей тестирования.

## <a name="migration-options"></a>Варианты переноса

У компании Contoso есть несколько вариантов перемещения сред разработки и тестирования в Azure:

| Варианты переноса | Результат |
| --- | --- |
| [Миграция Azure](/azure/migrate/migrate-services-overview) | [Оценка](/azure/migrate/tutorial-assess-vmware-azure-vm) и [Миграция](/azure/migrate/tutorial-migrate-vmware) локальных виртуальных машин. <br><br> Запуск серверов разработки и тестирования с помощью инфраструктуры Azure как услуги (IaaS). <br><br> Управление виртуальными машинами с помощью [Azure Resource Manager](/azure/azure-resource-manager/management/overview). |
| [Azure DevTest Labs](/azure/devtest-labs/devtest-lab-overview) | Быстро подготавливайте среды разработки и тестирования. <br><br> Сократите отходы с помощью квот и политик. <br><br> Установите автоматические завершения работы, чтобы снизить затраты. <br><br> Создание сред Windows и Linux. |

> [!NOTE]
> Узнайте, как компания Contoso переместила свою [среду разработки и тестирования в Azure с помощью DevTest Labs](./contoso-migration-devtest-to-labs.md).

## <a name="business-drivers"></a>Бизнес-факторы

Группа разработки лидера разработчиков получит описание того, что нужно достичь при этом переносе. Она нацелена на быстрое перемещение возможностей разработки и тестирования из локального центра обработки данных, а также на приобретение оборудования для разработки программного обеспечения. Он также пытается предоставить разработчикам возможность создавать и запускать свои среды без участия в них.

> [!NOTE]
> Contoso будет использовать [предложение подписки разработка и тестирование с оплатой по мере использования](https://azure.microsoft.com/offers/ms-azr-0023p/) для своих сред. Каждый активный подписчик Visual Studio в группе может использовать программное обеспечение Майкрософт, включенное в виртуальные машины подписки для разработки и тестирования без дополнительной платы. Компания Contoso будет просто платить за ставку Linux для виртуальных машин, которые он выполняет. Включая виртуальные машины с SQL Server, SharePoint Server или другим программным обеспечением, для которых обычно взимается плата с более высокой ставкой.

## <a name="migration-goals"></a>Цели миграции

Команда разработчиков Contoso заблокировала цели для этой миграции. Эти цели используются для определения оптимального метода миграции.

- Компания Contoso хочет быстро перейти из своей локальной среды разработки и тестирования.
- После миграции среда разработки и тестирования Contoso в Azure должна иметь расширенные возможности по сравнению с текущей системой в VMware.
- Модель операций будет перенесена из ИТ-службы в DevOps с самостоятельной подготовкой.

## <a name="solution-design"></a>Архитектура решения

После фиксации целей и требований компания Contoso проектирует и изучает решение для развертывания и определяет процесс миграции. Этот процесс включает службы Azure, которые компания Contoso будет использовать для миграции.

### <a name="current-application"></a>Текущее приложение

- Виртуальные машины для разработки и тестирования для двух приложений работают на виртуальных машинах ( `WEBVMDEV` ,, `SQLVMDEV` `OSTICKETWEBDEV` , `OSTICKETMYSQLDEV` ). Эти виртуальные машины используются для разработки до того, как код будет выдвинут на рабочие виртуальные машины.
- Виртуальные машины расположены на узле VMware ESXi `contosohost1.contoso.com` (версии 6.5).
- Среда VMware находится под управлением сервера vCenter Server 6.5 (`vcenter.contoso.com`), запущенного на виртуальной машине.
- Contoso имеет локальный центр обработки данных ( `contoso-datacenter` ) с локальным контроллером домена ( `contosodc1` ).

### <a name="proposed-architecture"></a>Предлагаемая архитектура

- Так как виртуальные машины используются для разработки и тестирования, они будут находиться в `ContosoDevRG` группе ресурсов в Azure.
- Виртуальные машины будут перенесены в основной регион Azure ( `East US 2` ) и помещены в виртуальную сеть разработки ( `VNET-DEV-EUS2` ).
- Виртуальные машины веб-интерфейса будут находиться в интерфейсной подсети ( `DEV-FE-EUS2` ) в сети разработки.
- Виртуальная машина базы данных будет находиться в подсети базы данных ( `DEV-DB-EUS2` ) в сети разработки.
- После завершения миграции локальные виртуальные машины в центре обработки данных Contoso будут выведены из эксплуатации.

  ![Схема предполагаемой архитектуры сценария с локальными и виртуальными машинами.](./media/contoso-migration-devtest-to-iaas/architecture.png)

  _Рис. 1. Предлагаемая архитектура._

### <a name="database-considerations"></a>Рекомендации по базе данных

Для поддержки текущей разработки компания Contoso решила продолжать использовать существующие виртуальные машины и перенести их в Azure. В будущем компания Contoso будет использовать службы "платформа как услуга" (PaaS), такие как [база данных SQL Azure](/azure/azure-sql/azure-sql-iaas-vs-paas-what-is-overview) и [база данных Azure для MySQL](/azure/mysql/overview).

- Виртуальные машины базы данных будут перенесены как есть без изменений.
- С помощью предложения подписки Azure для разработки и тестирования компьютеры под управлением Windows Server и SQL Server не будут оплачивать лицензии. Отсутствие платных средств обеспечит минимальную стоимость вычислений.
- В будущем компания Contoso будет рассмотрю интеграцию своей разработки со службами PaaS.

### <a name="solution-review"></a>Проверка решения

Компания Contoso оценивает предлагаемую конструкцию, помещая вместе со списком достоинств и недостатков.

| Оценка | Сведения |
| --- | --- |
| **Преимущества** | Все виртуальные машины разработки будут перемещены в Azure без изменений, что сделает миграцию простой. <br><br> Поскольку компания Contoso использует подход с приближением и сдвигом для обоих наборов виртуальных машин, Специальные средства настройки или миграции не требуются для базы данных приложения. <br><br> Компания Contoso может воспользоваться преимуществами своей инвестиции в подписку на разработку и тестирование Azure, чтобы сэкономить на лицензировании. <br><br> Contoso будет хранить полный контроль над виртуальными машинами приложений в Azure. <br><br> Разработчики будут предоставлять права доступа к подписке, что позволит им создавать новые ресурсы, не дожидаясь ответа на запросы. |
| **Недостатки** | Миграция приведет к перемещению только виртуальных машин, но пока не будет перемещено в службы PaaS для их разработки. Это означает, что Contoso потребуется начать поддержку операций виртуальных машин, включая исправления системы безопасности. Это было сохранено в прошлом, поэтому Contoso потребуется найти решение для этой новой рабочей задачи. <br><br> Облачное решение предоставляет разработчикам и не имеет средств защиты для избыточной подготовки систем. Разработчики смогут быстро подготавливать свои системы, но они могут создавать ресурсы, которые изменяют деньги и не включаются в бюджет. |

> [!NOTE]
> Contoso может обращаться к недостаткам в своем списке с помощью [DevTest Labs](/azure/devtest-labs/devtest-lab-overview).

### <a name="migration-process"></a>Процесс миграции

Компания Contoso перенесет клиентскую часть разработки и базу данных на виртуальные машины Azure с помощью метода без агента в средстве миграции Azure Migration: сервер.

- Компания Contoso готовит и настраивает компоненты Azure для службы "миграция Azure": миграция сервера и подготовка локальной инфраструктуры VMware.
- [Инфраструктура Azure](./contoso-migration-infrastructure.md) размещается, поэтому Contoso необходимо только настроить репликацию виртуальных машин с помощью средства миграции Azure Migration: сервер.
- Когда все будет подготовлено, Contoso сможет начать репликацию виртуальных машин.
- После включения и работы репликации компания Contoso переносит виртуальные машины, проверяя миграцию и при успешном выполнении отработку отказа в Azure.
- После того как виртуальные машины разработки будут работать в Azure, компания Contoso перестроит свои рабочие станции разработки, чтобы они указывали на виртуальные машины, работающие в Azure.

![Схема процесса миграции.](./media/contoso-migration-devtest-to-iaas/migration-process-az-migrate.png)

_Рис. 2. Обзор процесса миграции._

### <a name="azure-services"></a>Службы Azure

| Служба | Описание | Стоимость |
| --- | --- | --- |
| [Azure Migrate: Server Migration](/azure/migrate/) (Миграция Azure: миграция сервера). | Служба управляет миграцией локальных приложений и рабочих нагрузок, а также экземпляров виртуальных машин AWS или обеспечить. | Во время репликации в Azure взимается плата за службу хранилища Azure. Виртуальные машины Azure создаются и оплачиваются, когда выполняется миграция и виртуальные машины работают в Azure. Дополнительные сведения о [расходах и ценах](https://azure.microsoft.com/pricing/details/azure-migrate/). |

## <a name="prerequisites"></a>Предварительные требования

Это то, что Contoso требуется для выполнения этого сценария:

| Требования | Сведения |
| --- | --- |
| **Подписка на разработку и тестирование Azure** | Contoso создает [подписку на разработку и тестирование Azure](https://azure.microsoft.com/offers/ms-azr-0023p/) , чтобы воспользоваться преимуществами снижения затрат до 80%. <br><br> Если у вас еще нет подписки Azure, создайте [бесплатную учетную запись Azure](https://azure.microsoft.com/free/). <br><br> Если вы создаете бесплатную учетную запись, вы являетесь администратором подписки и можете выполнять все действия. <br><br> Если вы используете существующую подписку, но вы не являетесь администратором, обратитесь к администратору, чтобы назначить вам разрешения владельца или участника. <br><br> Если вам нужны более детализированные разрешения, см. статью [Управление доступом Site Recovery с помощью управления доступом на основе ролей Azure (Azure RBAC)](/azure/site-recovery/site-recovery-role-based-linked-access-control). |
| **Инфраструктура Azure** | Узнайте, как Contoso [настраивает инфраструктуру Azure](./contoso-migration-infrastructure.md). <br><br> Дополнительные сведения о конкретных [предварительных требованиях](#prerequisites) для службы "миграция Azure": миграция сервера. |
| **Локальные серверы** | На локальных серверах vCenter Server должна быть установлена версия 5,5, 6,0, 6,5 или 6,7. <br><br> Узлы ESXi должны работать под управлением версии 5,5, 6,0, 6,5 или 6,7. <br><br> Одна или несколько виртуальных машин VMware должны работать на узле ESXi. |

## <a name="scenario-steps"></a>Шаги выполнения сценария

Ниже рассказывается, как администраторы компании Contoso выполняют миграцию.

> [!div class="checklist"]
>
> - **Шаг 1. Подготовка Azure для миграции Azure: миграция сервера.** Они добавляют средство миграции сервера в проект службы "миграция Azure".
> - **Шаг 2. Подготовка локальной среды VMware для миграции в Azure: миграция сервера.** Они подготавливают учетные записи для обнаружения виртуальных машин и подготовятся к подключению к виртуальным машинам Azure после миграции.
> - **Шаг 3. репликация виртуальных машин.** Они настроили репликацию и начинают репликацию виртуальных машин в службу хранилища Azure.
> - **Шаг 4. Миграция виртуальных машин с помощью службы "миграция Azure": миграция сервера.** Они выполняют тестовую миграцию, чтобы убедиться, что все работает, а затем выполняет полную миграцию, чтобы переместить виртуальные машины в Azure.

## <a name="step-1-prepare-azure-for-the-azure-migrate-server-migration-tool"></a>Шаг 1. Подготовка Azure к работе с миграцией Azure: средство миграции сервера

Contoso необходимо перенести виртуальные машины в виртуальную сеть, в которой будут размещаться виртуальные машины Azure при их создании, подготовке и настройке с помощью средства миграции Azure Migration: Server.

1. Настройка сети. компания Contoso уже настроила сеть, которая может быть для службы "миграция Azure": миграция сервера при [развертывании инфраструктуры Azure](./contoso-migration-infrastructure.md).

    - Виртуальные машины, подлежат миграции, используются для разработки. Они будут перенесены в виртуальную сеть разработки Azure ( `VNET-DEV-EUS2` ) в основном `East US 2` регионе.
    - Обе виртуальные машины будут помещены в `ContosoDevRG` группу ресурсов, которая будет использоваться для ресурсов разработки.
    - Клиентские виртуальные машины приложения ( `WEBVMDEV` и `OSTICKETWEBDEV` ) будут перенесены в интерфейсную подсеть ( `DEV-FE-EUS2` ) в виртуальной сети разработки.
    - Виртуальная машина базы данных приложений ( `SQLVMDEV` и `OSTICKETMYSQLDEV` ) будет перенесена в подсеть базы данных ( `DEV-DB-EUS2` ) в виртуальной сети разработки.

2. Выполните подготовку к работе средства миграции Azure: Server Migration Tool.

    1. В службе "миграция Azure" Скачайте. OVA образ и импортируйте его в VMware.

       ![Снимок экрана с экраном для загрузки. Файл OVA.](./media/contoso-migration-devtest-to-iaas/migration-download-ova.png)

       _Рис. 3. Загрузка. Файл OVA._

    1. Запустите импортированное изображение и настройте средство, включая следующие шаги:

       - Настройте необходимые компоненты.

         ![Снимок экрана раздела, посвященного настройке необходимых компонентов.](./media/contoso-migration-devtest-to-iaas/migration-setup-prerequisites.png)

         _Рис. 4. Настройка необходимых компонентов._

       - Наведите указатель на инструмент на подписку Azure.

         ![Снимок экрана, посвященный настройке обнаружения для службы "миграция Azure".](./media/contoso-migration-devtest-to-iaas/migration-register-azure.png)

         _Рис. 5. Подписка Azure._

       - Задайте учетные данные VMware vCenter.

         ![Снимок экрана, посвященный настройке учетных данных VMware vCenter.](./media/contoso-migration-devtest-to-iaas/migration-vcenter-server.png)

         _Рис. 6. Настройка учетных данных VMware vCenter._

       - Добавьте все учетные данные на основе Windows для обнаружения.

         ![Снимок экрана раздела, посвященного обнаружению приложений и зависимостей на виртуальных машинах.](./media/contoso-migration-devtest-to-iaas/migration-credentials.png)

         _Рис. 7. Добавление учетных данных на основе Windows для обнаружения._

3. После завершения настройки для перечисления всех виртуальных машин средство займет некоторое время. Вы увидите, что они заполнят средство миграции Azure в Azure по завершении этого процесса.

**Требуется дополнительная помощь?**

Узнайте, как [настроить средство миграции для Azure Migration](/azure/migrate/).

### <a name="prepare-on-premises-vms"></a>Подготовка локальных виртуальных машин

После миграции компания Contoso хочет подключиться к виртуальным машинам Azure и разрешить Azure управлять виртуальными машинами. Для этого перед миграцией администраторы компании Contoso выполняют указанные ниже действия.

1. Для доступа через Интернет они делают следующее.

    - Включите RDP или SSH на локальной виртуальной машине перед миграцией.
    - Убедитесь, что для профиля добавлены правила TCP и UDP `Public` .
    - Убедитесь, что протокол RDP или SSH разрешен в брандмауэре операционной системы.
    - Установите SSH с помощью следующей команды: `sudo apt-get ssh install -y` .

2. Для доступа через VPN типа "сеть — сеть":

    - Включите RDP или SSH на локальной виртуальной машине перед миграцией.
    - Убедитесь, что протокол RDP или SSH разрешен в брандмауэре операционной системы.
    - Для Windows задайте для политики SAN операционной системы на локальной виртуальной машине значение `OnlineAll` .

3. Установите [Агент Azure для Windows](/azure/virtual-machines/extensions/agent-windows) и [Агент Linux для Azure](/azure/virtual-machines/extensions/agent-linux).

Для Windows на виртуальной машине не должно быть ожидающих обновлений Windows при активации миграции. Если это так, администраторы не смогут войти в виртуальную машину до завершения обновления. После миграции администраторы могут проверить **диагностику загрузки** , чтобы просмотреть снимок экрана виртуальной машины. Если это не поможет, убедитесь, что виртуальная машина запущена, и ознакомьтесь с [советами по устранению неполадок](https://social.technet.microsoft.com/wiki/contents/articles/31666.troubleshooting-remote-desktop-connection-after-failover-using-asr.aspx).

**Требуется дополнительная помощь?**

Узнайте, как [подготовить виртуальные машины для миграции](/azure/migrate/prepare-for-migration).

## <a name="step-3-replicate-the-on-premises-vms"></a>Шаг 3. Репликация локальных виртуальных машин

Чтобы можно было запустить миграцию в Azure, администраторам компании Contoso потребуется настроить и включить репликацию. После завершения обнаружения они могут начать репликацию виртуальных машин VMware в Azure.

1. В проекте службы "миграция Azure" перейдите к разделу **серверы**  >  **Миграция Azure: миграция сервера**. Затем выберите **реплицировать**.

    ![Снимок экрана, на котором показана кнопка "реплицировать" в разделе "средства миграции".](./media/contoso-migration-devtest-to-iaas/select-replicate.png)

    _Рис. 8. репликация виртуальных машин._

2. В разделе Параметры **репликации**  >  **источника**  >  **виртуальные машины виртуализированы?** выберите **Да, с VMware vSphere**.

3. В поле **локальное устройство** выберите имя настроенного устройства для миграции Azure и нажмите кнопку **ОК**.

    ![Снимок экрана, на котором показаны параметры источника и поле для имени устройства.](./media/contoso-migration-devtest-to-iaas/source-settings.png)

    _Рис. 9. параметры источника._

4. В области **виртуальные машины** выберите компьютеры, которые требуется реплицировать.
    - Если вы выполняете оценку виртуальных машин, вы можете применить рекомендации по выбору размера и типа диска (Premium или Standard) в результатах оценки. Для этого в поле **Импортировать параметры миграции из средства оценки Миграции Azure?** выберите вариант **Да**.
    - Если вы не выполняли оценку или вы не хотите использовать параметры оценки, выберите параметр **нет** .
    - Если выбрано использование оценки, выберите группу виртуальных машин и имя оценки.

      ![Снимок экрана, на котором показан выбор оценки для виртуальных машин.](./media/contoso-migration-devtest-to-iaas/select-assessment.png)

      _Рис. 10. Настройка необходимых компонентов._

5. В окне **виртуальные машины** выполните поиск виртуальных машин по мере необходимости и проверьте каждую виртуальную машину, которую требуется перенести. Затем нажмите кнопку **Далее: целевые параметры**.

6. В поле **целевые параметры** выберите подписку и целевой регион для переноса. Затем укажите группу ресурсов, в которой будут размещаться виртуальные машины Azure после миграции. В поле **Виртуальная сеть** выберите виртуальную сеть или подсеть, к которой будут присоединены виртуальные машины Azure после миграции.

7. В **преимущество гибридного использования Azure** выберите **нет** , если вы не хотите применять преимущество гибридного использования Azure. Нажмите кнопку **Далее**. Выберите **Да** , если у вас есть компьютеры Windows Server, на которых распространяется действующая программа Software Assurance или подписки Windows Server, и вы хотите применить преимущества к компьютерам, которые вы будете переносить. Нажмите кнопку **Далее**.

      > [!NOTE]
      > В случае Contoso администратор выберет " **нет** ", чтобы преимущество гибридного использования Azure, так как это подписка Azure для разработки и тестирования. Это означает, что они будут оплачиваться только для вычислений. [Преимущество гибридного использования Azure](https://azure.microsoft.com/pricing/hybrid-benefit/) следует использовать только для рабочих систем, имеющих преимущества Software Assurance.

8. В разделе **Вычисления** просмотрите имя виртуальной машины, размер, тип диска ОС и группу доступности. Виртуальные машины должны соответствовать [требованиям Azure](/azure/migrate/migrate-support-matrix-vmware#vmware-requirements).

    - **Размер виртуальной машины:** Если вы используете рекомендации по оценке, этот раскрывающийся список содержит рекомендуемый размер. В противном случае служба "миграция Azure" выбирает размер в соответствии с ближайшим совпадением в подписке Azure. Вместо этого можно выбрать размер вручную в качестве **размера виртуальной машины Azure**.
    - **Диск ОС:** Укажите диск операционной системы (загрузочный) для виртуальной машины. На диске ОС имеется загрузчик и установщик операционной системы.
    - **Группа доступности:** Если после миграции виртуальная машина должна находиться в группе доступности Azure, укажите набор. Набор должен находиться в Целевой группе ресурсов, указанной для миграции.

9. В поле **диски** укажите, следует ли реплицировать диски виртуальной машины в Azure и выберите тип диска (стандартный SSD/HDD или управляемые диски уровня "Премиум") в Azure. Нажмите кнопку **Далее**. Диски можно исключить из репликации. В противном случае они не будут присутствовать на виртуальной машине Azure после миграции.

10. В окне **Проверка и запуск репликации** проверьте параметры и выберите **репликация** , чтобы запустить начальную репликацию для серверов.

> [!NOTE]
> Параметры репликации можно обновить в любое время до начала репликации на странице **Управление**  >  **репликацией компьютеров**. Настройки невозможно изменить после начала репликации.

## <a name="step-4-migrate-the-vms"></a>Шаг 4. Миграция виртуальных машин

Администраторы Contoso выполняют быструю тестовую миграцию, а затем полную миграцию для миграции виртуальных машин.

### <a name="run-a-test-migration"></a>Выполнение тестовой миграции

1. В списке **цели миграции**  >  **серверы**  >  **Миграция Azure: миграция сервера** выберите **тестировать перенесенные серверы**.

    ![Снимок экрана, на котором показан выбор для тестирования перенесенных серверов.](./media/contoso-migration-devtest-to-iaas/test-migrated-servers.png)

    _Рис. 11. Тестирование перенесенных серверов._

2. Выберите и удерживайте (или щелкните правой кнопкой мыши) виртуальную машину для тестирования, а затем выберите пункт **Тестовая миграция**.

    ![Снимок экрана, на котором показана кнопка для тестирования миграции.](./media/contoso-migration-devtest-to-iaas/test-migrate.png)

    _Рис. 12. Тестирование миграции._

3. В области **Тестовая миграция** выберите виртуальную сеть, в которой будет РАЗМЕЩЕНа виртуальная машина Azure после миграции. Рекомендуется использовать виртуальную сеть непроизводства.
4. Запустится задание **Тестовая миграция**. Отслеживайте задание и уведомления на портале.
5. После завершения миграции просмотрите перенастроенную виртуальную машину Azure в разделе **Виртуальные машины** на портале Azure. Имя компьютера содержит суффикс **-Test** .
6. После завершения теста выберите и удерживайте (или щелкните правой кнопкой мыши) виртуальную машину Azure на странице **репликация компьютеров**, а затем выберите **очистить тестовую миграцию**.

    ![Снимок экрана, на котором показан выбор для очистки тестовой миграции.](./media/contoso-migration-devtest-to-iaas/clean-up.png)

    _Рис. 13. Очистка тестовой миграции._

### <a name="migrate-the-vms"></a>Миграция виртуальных машин

Теперь администраторы Contoso выполняют полную миграцию.

1. В проекте службы "миграция Azure" выберите **серверы**  >  **Миграция Azure: миграция сервера**  >  **репликация серверов**.

    ![Снимок экрана, на котором показаны параметры репликации серверов.](./media/contoso-migration-devtest-to-iaas/replicating-servers.png)

    _Рис. 14. репликация серверов._

2. В области **репликация компьютеров** выберите и удерживайте (или щелкните правой кнопкой мыши) виртуальную машину, а затем выберите **Миграция**.
3. В разделе **Миграция** > **Shut down virtual machines and perform a planned migration with no data loss** (Завершить работу виртуальных машин и выполнить запланированную миграцию без потери данных?) выберите вариант **Да** > **ОК**. По умолчанию служба "миграция Azure" завершает работу локальной виртуальной машины и выполняет репликацию по требованию для синхронизации любых изменений виртуальной машины, произошедших с момента последней репликации. Это гарантирует отсутствие потери данных. Если вы не хотите выключать виртуальную машину, выберите вариант **Нет**.
4. Запустится задание миграции виртуальной машины. Отслеживайте задание в уведомлениях Azure.
5. После завершения работы вы можете просматривать виртуальную машину и управлять ею на странице **Виртуальные машины**.

**Требуется дополнительная помощь?**

Узнайте, как [выполнить тестовую миграцию](/azure/migrate/tutorial-migrate-vmware#run-a-test-migration) и как выполнить [миграцию виртуальных машин в Azure](/azure/migrate/tutorial-migrate-vmware#migrate-vms).

## <a name="clean-up-after-migration"></a>Очистка после миграции

Виртуальные машины разработки для приложений SmartHotel360 и Остиккет начинают работать на виртуальных машинах Azure по завершении миграции.

Теперь специалистам компании Contoso необходимо выполнить указанные ниже действия по очистке.

- После завершения миграции отключите репликацию.
- Удалите `WEBVMDEV` `SQLVMDEV` `OSTICKETWEBDEV` виртуальные машины,, и `OSTICKETMYSQLDEV` из инвентаризации vCenter.
- Удалите все виртуальные машины из локальных заданий резервного копирования.
- Обновите внутреннюю документацию, чтобы отобразить новое расположение и IP-адреса для виртуальных машин.
- Проверить все ресурсы, взаимодействующие с виртуальными машинами, и обновить все соответствующие параметры или документы согласно новой конфигурации.

## <a name="review-the-deployment"></a>Проверка развертывания

Теперь, когда приложение работает, Contoso теперь должен полностью эксплуатацию и защищать его в Azure.

### <a name="security"></a>Безопасность

Группа безопасности Contoso рассматривает виртуальные машины Azure, чтобы определить проблемы безопасности. Чтобы можно было управлять доступом, команда проверяет группы безопасности сети (NSG) для виртуальных машин. Группы безопасности сети используются, чтобы обеспечить доступ к нему только для трафика, разрешенного приложению. Группа также рассматривает защиту данных на диске с помощью шифрования дисков Azure и Azure Key Vault.

Дополнительные сведения см. в статье рекомендации [по обеспечению безопасности для рабочих нагрузок IaaS в Azure](/azure/security/fundamentals/iaas).

## <a name="business-continuity-and-disaster-recovery"></a>Непрерывность бизнес-процессов и аварийное восстановление

Для обеспечения непрерывности бизнес-процессов и аварийного восстановления компания Contoso выполняет следующее действие: Обеспечьте безопасность данных. Contoso создает резервные копии данных на виртуальных машинах с помощью службы Azure Backup. Дополнительные сведения см. [в обзоре резервного копирования виртуальных машин Azure](/azure/backup/backup-azure-vms-introduction).

### <a name="licensing-and-cost-optimization"></a>Лицензирование и оптимизация затрат

Компания Contoso обеспечит создание ресурсов Azure для разработки с помощью этой подписки для разработки и тестирования, чтобы сэкономить 80%. Администраторы будут включать [Управление затратами Azure и выставление счетов](/azure/cost-management-billing/cost-management-billing-overview) для помощи в мониторинге ресурсов Azure и управлении ими.

## <a name="conclusion"></a>Заключение

В этой статье компания Contoso повторно размещает виртуальные машины разработки, используемые для своих приложений SmartHotel360 и Остиккет в Azure. Администраторы перенесли виртуальные машины приложений на виртуальные машины Azure с помощью средства миграции Azure: Server Migration Tool.
