---
title: Масштабирование миграции в Azure
description: Используйте платформу внедрения облачных технологий для Azure, чтобы научиться планировать и выполнять миграцию в Azure.
author: BrianBlanchard
ms.author: brblanch
ms.date: 07/01/2020
ms.topic: conceptual
ms.service: cloud-adoption-framework
ms.subservice: migrate
services: azure-migrate
ms.openlocfilehash: 4986b8890df72abc12c2f377881995dcf070c575
ms.sourcegitcommit: bcc73d194c6d00c16ae2e3c7fb2453ac7dbf2526
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/09/2020
ms.locfileid: "86193989"
---
<!-- docsTest:ignore ARO POC Y/N None/Some/Severe Rehost/Refactor/Rearchitect/Rebuild -->

<!-- cSpell:ignore VHDs autosnooze unsnooze Hanu Scalr -->

# <a name="scale-a-migration-to-azure"></a>Масштабирование миграции в Azure

В этой статье показано, как вымышленная компания Contoso выполняет масштабную миграцию в Azure. Компания планирует и выполняет миграцию более 3000 рабочих нагрузок, 8000 баз данных и более 10 000 виртуальных машин.

## <a name="business-drivers"></a>Бизнес-факторы

Совместными усилиями ИТ-руководство и деловые партнеры определили указанные ниже цели этой миграции.

- **Устраните бизнес-рост.** По мере развития компании Contoso растет нагрузка на локальные системы и инфраструктуру.
- **Повышение эффективности.** Contoso необходимо удалить ненужные процедуры и оптимизировать процессы для разработчиков и пользователей. Бизнес нуждается в том, чтобы ИТ были быстрыми и чтобы не тратить время или деньги, обеспечивая более высокие требования клиентов.
- **Повышение гибкости.** ИТ-отдел компании Contoso должен проявлять большую гибкость в отношении потребностей бизнеса. Должна реагировать быстрее, чем изменения на рынке, чтобы включить успех в глобальную экономику реагирования. Он не должен мешать или становиться помехой для бизнеса.
- **Измените.** По мере того как бизнес успешно растет, ИТ-отдел компании Contoso должен предоставлять системы, способные расти в том же темпе.
- **Улучшение моделей затрат.** Компании Contoso требуется снизить потребности в капитале, указанные в бюджете ИТ-отдела. Компания Contoso хочет использовать возможности облака для масштабирования ресурсов и снижения потребности в дорогостоящем оборудовании.
- **Снижение затрат на лицензии.** Компании Contoso требуется минимизировать затраты на облако.

## <a name="migration-goals"></a>Цели миграции

Группа, работающая над облачной инфраструктурой компании Contoso, определила цели этой миграции. Эти цели использовались для определения оптимального метода миграции.

| Требования | Сведения |
| --- | --- |
| Быстрый переход на Azure | Компания Contoso хочет быстро начать перемещение приложений и виртуальных машин в Azure. |
| Составление полного списка ресурсов | Contoso хочет выполнить полную инвентаризацию всех приложений, баз данных и виртуальных машин в Организации. |
| Оценка и классификация приложений | Компания Contoso хочет воспользоваться всеми преимуществами облака. По умолчанию предполагается, что все службы будут выполняться как PaaS. Модель IaaS будет использоваться в случаях, где PaaS не подходит. |
| Обучение и переход на модель DevOps | Компания Contoso намеревается перейти на модель DevOps. Будет проведено обучение по Azure и DevOps, после чего группы будут реорганизованы (при необходимости). |

После уточнения целей и требований компания Contoso проверяет инфраструктуру ИТ и определяет процесс миграции.

## <a name="current-deployment"></a>Текущее развертывание

После планирования и настройки [инфраструктуры Azure](./contoso-migration-infrastructure.md) и испытания различных сочетаний подтверждений концепции миграции, перечисленных в таблице выше, компания Contoso готова приступить к полной миграции в Azure в нужном масштабе. Вот что компании Contoso необходимо перенести.

| Компонент | Громкость | Сведения |
| --- | --- | --- |
| Рабочие нагрузки | Приложения > 3 000 | <li> Приложения запускаются на виртуальных машинах. <li> К платформам приложений относятся Windows, SQL Server и [лампа](https://wikipedia.org/wiki/LAMP_(software_bundle)). |
| Базы данных | ~ 8 500 баз данных | К базам данных относятся SQL Server, MySQL и PostgreSQL. |
| Виртуальные машины | > 35 000 виртуальных машин | Виртуальные машины выполняются на узлах VMware и управляются серверами vCenter Server. |

## <a name="migration-process"></a>Процесс миграции

Теперь, когда компания Contoso заблокировала бизнес-драйверы и цели миграции, она может присвоить [методологии](../index.md)миграции, основываясь на процессе миграции и спринтах миграции, чтобы итеративно планировать и выполнять перенос.

## <a name="plan"></a>План

Компания Contoso запускает процесс планирования, выполнив обнаружение и оценку локальных приложений, данных и инфраструктуры. Ниже приведены действия специалистов Contoso:

- Contoso необходимо обнаружить приложения, сопоставить зависимости между приложениями, а затем выбрать порядок миграции и приоритет.
- Как только компания Contoso оценивается, она создает полный список приложений и ресурсов. Вместе с новой инвентаризацией Contoso будет использовать и обновлять существующую базу данных управления конфигурацией (CMDB) и каталог услуг.
  - В CMDB содержатся технические настройки для приложений contoso.
  - В каталоге услуг документируется Рабочая информация о приложениях, в том числе о связанных бизнес-партнерах и соглашениях об уровне обслуживания (SLA).

### <a name="discover-applications"></a>Обнаружение приложений

Компания Contoso запускает тысячи приложений на разных серверах. В дополнение к CMDB и каталогу услуг, компании Contoso требуются средства обнаружения и оценки.

- Эти инструменты должны обеспечить механизм, позволяющий передавать данные оценки в процесс миграции.
- Инструменты оценки должны предоставлять данные, которые помогут создать интеллектуальный список физических и виртуальных ресурсов компании Contoso. Эти данные должны включать в себя сведения о профилях и метрики производительности.
- По завершении обнаружения у компании Contoso должен быть полный список ресурсов, а также метаданные, связанные с ними. Этот список будет использоваться для определения плана миграции.

### <a name="identify-classifications"></a>Определение классификаций

Компания Contoso определяет несколько общих категорий для классификации ресурсов в списке. Эти классификации важны для принятия решений компании Contoso по миграции. Список классификаций помогает установить приоритеты для миграции и выявить сложные проблемы.

| Категория | Присвоенное значение | Сведения |
| --- | --- | --- |
| Бизнес-группа | Список имен бизнес-групп. | Какая группа ответственна за элемент списка? |
| Кандидат для подтверждения концепции | Да/нет | Можно ли использовать приложение в качестве подтверждения концепции или раннего внедрения облачной миграции? |
| Технический долг | Отсутствует; имеется некоторый или серьезный | Работает ли элемент инвентаризации или использует неподдерживаемый продукт, платформу или операционную систему? |
| Влияние брандмауэра | Да/нет | Взаимодействует ли приложение с Интернетом или вне трафика? Интегрируется ли оно с брандмауэром? |
| Проблемы с безопасностью | Да/нет | Существуют ли известные проблемы с безопасностью приложения? Использует ли приложение незашифрованные данные или самые актуальные платформы? |

### <a name="discover-application-dependencies"></a>Обнаружение зависимостей приложений

В рамках процесса оценки компания Contoso должна определить, где работают приложения, и определить зависимости и подключения между серверами приложений. Компания сопоставляет среду поэтапно.

1. В качестве первого шага компания Contoso обнаруживает, как серверы и компьютеры сопоставляются с отдельными приложениями, сетевыми расположениями и группами.
2. С помощью этой информации компания Contoso может четко определить приложения с небольшими зависимостями и подходят для быстрой миграции.
3. Contoso может использовать сопоставление, чтобы помочь им определить более сложные зависимости и связи между серверами приложений. Затем компания Contoso может сгруппировать эти серверы логически для представления приложений и спланировать стратегию миграции на основе этих групп.

После сопоставления компания Contoso может гарантировать, что все компоненты приложения будут идентифицированы и учитывать при создании плана миграции.

![Сопоставление зависимостей](./media/contoso-migration-scale/dependency-map.png)

### <a name="evaluate-applications"></a>Оценка приложений

В качестве последнего шага в процессе обнаружения и оценки компания Contoso может оценить результаты оценки и сопоставления, чтобы узнать, как перенести каждое приложение из каталога услуг.

Чтобы описать этот процесс оценки, в список добавляется ряд дополнительных классификаций.

| Категория | Присвоенное значение | Сведения |
| --- | --- | --- |
| Бизнес-группа | Список имен бизнес-групп. | Какая группа ответственна за элемент списка? |
| Кандидат для подтверждения концепции | Да/нет | Можно ли использовать приложение в качестве подтверждения концепции или раннего внедрения облачной миграции? |
| Технический долг | Отсутствует; имеется некоторый или серьезный | Работает ли элемент инвентаризации или использует неподдерживаемый продукт, платформу или операционную систему? |
| Влияние брандмауэра | Да/нет | Взаимодействует ли приложение с Интернетом или вне трафика? Интегрируется ли оно с брандмауэром? |
| Проблемы с безопасностью | Да/нет | Существуют ли известные проблемы с безопасностью приложения? Использует ли приложение незашифрованные данные или самые актуальные платформы? |
| Стратегия миграции | Повторное размещение, рефакторинг, перепроектирование или перестроение | Какой тип миграции требуется для приложения? Как будет развернуто приложение в Azure? [Подробнее](./contoso-migration-overview.md#migration-patterns). |
| Техническая сложность | 1–5 | Насколько сложной является миграция? Это значение должно определяться отделом DevOps компании Contoso и соответствующими партнерами. |
| Важность для бизнеса | 1–5 | Насколько важна деятельность приложения для бизнеса? Например, небольшому приложению Рабочей группы может быть назначена оценка одного, тогда как критическое приложение, используемое в Организации, может иметь оценку 5. Эта оценка повлияет на уровень приоритета миграции. |
| Приоритет миграции | 1, 2, 3 | Каков приоритет миграции для приложения? |
| Риск при миграции | 1–5 | Каков уровень риска для миграции приложения? Это значение должно быть согласовано с отделом DevOps компании Contoso и соответствующими партнерами. |

### <a name="determine-costs"></a>Определение затрат

Чтобы определить затраты и сэкономить возможности миграции Azure, компания Contoso может использовать Калькулятор совокупной [стоимости владения (TCO)](https://azure.microsoft.com/pricing/tco/calculator) для вычисления и сравнения общей стоимости владения Azure с сравнимым локальным развертыванием.

### <a name="identify-assessment-tools"></a>Определение инструментов оценки

Компания Contoso выбирает инструменты для обнаружения, оценки и создания списка ресурсов. Contoso определяет набор средств и служб Azure, собственные средства и сценарии приложений, а затем средства партнеров. В частности, компании Contoso необходимо узнать, как можно использовать службу "Миграция Azure" для выполнения оценки в нужном масштабе.

#### <a name="azure-migrate"></a>Служба "Миграция Azure"

С помощью службы "Миграция Azure" можно обнаруживать и оценивать локальные виртуальные машины VMware для подготовки к миграции в Azure. Ниже приведены функции Миграции Azure.

1. **Обнаружение:** Обнаружение локальных виртуальных машин VMware.
    - Служба "миграция Azure" поддерживает обнаружение с нескольких серверов vCenter (последовательно) и может выполнять операции обнаружения в отдельных проектах службы "миграция Azure".
    - Служба "миграция Azure" выполняет обнаружение с помощью виртуальной машины VMware, на которой выполняется Сборщик Миграции Azure. Один и тот же сборщик может обнаруживать виртуальные машины на разных серверах vCenter Server и отправлять данные в разные проекты.

2. **Оценка готовности:** Оцените, подходят ли локальные компьютеры для работы в Azure. Оценка включает в себя следующее.
    - **Рекомендации по размеру:** Получите рекомендации по размеру для виртуальных машин Azure на основе журнала производительности локальных виртуальных машин.
    - **Предполагаемые месячные затраты:** Получите оценочные затраты на выполнение локальных компьютеров в Azure.

3. **Выявление зависимостей:** Визуализируйте зависимости локальных компьютеров, чтобы создать оптимальные группы компьютеров для оценки и миграции.

![Служба "Миграция Azure"](./media/contoso-migration-scale/azure-migrate.png)

**Миграция в масштабе:**

Компании Contoso необходимо использовать Миграцию Azure в соответствии с масштабом миграции.

- Компания будет выполнять последовательную оценку приложений с помощью Миграции Azure. Это гарантирует, что Миграция Azure будет возвращать актуальные данные на портал Azure.
- Администраторы Contoso научитесь [развертывать миграцию Azure в масштабе](https://docs.microsoft.com/azure/migrate/scale-hyper-v-assessment).
- Компания Contoso отмечает ограничения Миграции Azure, кратко изложенные в следующей таблице.

| Действие | Ограничение |
| --- | --- |
| Создание проекта Миграции Azure | 10 000 виртуальных машин |
| Раскрытие | 10 000 виртуальных машин |
| Оценка | 10 000 виртуальных машин |

Компания Contoso будет использовать Миграцию Azure следующим образом.

- В среде vCenter компания упорядочит виртуальные машины по папкам. Это упростит акцентирование внимания, так как будут оцениваться виртуальные машины в определенной папке.
- Миграция Azure использует Сопоставление служб Azure для оценки зависимостей между компьютерами. Для этого требуется установить агенты на оцениваемые виртуальные машины.
  - Компания Contoso использует автоматизированные сценарии для установки необходимых агентов Windows или Linux.
  - С помощью сценариев можно выполнить установку на виртуальные машины в папке vCenter.

#### <a name="database-tools"></a>Инструменты базы данных

Помимо Миграции Azure компания Contoso уделит внимание инструментам оценки баз данных. Такие инструменты, как [Помощник по миграции данных](https://docs.microsoft.com/sql/dma/dma-overview?view=sql-server-2017), помогут оценить базы данных SQL Server для миграции.

Помощник по миграции данных (DMA) может помочь компании Contoso определить, совместимы ли локальные базы данных с различными решениями для баз данных Azure, такими как база данных SQL Azure, SQL Server, работающих на виртуальной машине Azure IaaS, и Управляемый экземпляр Azure SQL.

В дополнение к Database Migration Service Contoso имеет некоторые другие сценарии, используемые для обнаружения и документирования SQL Server баз данных. Они находятся в репозитории GitHub.

#### <a name="partner-assessment-tools"></a>Инструменты оценки от партнеров

Существует несколько других партнерских средств, которые могут помочь компании Contoso оценить локальную среду для миграции в Azure. Узнайте больше о [партнерах по миграции Azure](https://azure.microsoft.com/migration/partners).

## <a name="phase-2-migrate"></a>Этап 2. Миграция

С их оценкой полностью необходимо, чтобы в компании Contoso были определены средства для переноса приложений, данных и инфраструктуры в Azure.

### <a name="migration-strategies"></a>Стратегии миграции

Существуют четыре общие стратегии миграции, которые может рассмотреть компания Contoso.

| Стратегия | Сведения | Использование |
| --- | --- | --- |
| Повторное размещение | <li> Часто называется миграцией с переносом _и сдвигом_ . Этот вариант без кода предназначен для быстрого переноса существующих приложений в Azure. <li> Приложение переносится как есть, с преимуществами облака, без риска или затрат, связанных с изменениями кода. | <li> Компания Contoso может повторно разместить менее стратегические приложения, не запрашивая изменения кода. |
| Рефакторинг | <li> Эта стратегия также называется перепакетированием, поэтому требуется минимальный код приложения или изменения конфигурации, чтобы подключить приложение к Azure PaaS и воспользоваться преимуществами облачных возможностей. | <li> Компания Contoso может выполнить рефакторинг стратегических приложений, чтобы они сохраняли одну базовую функциональность, но переместить их на платформу Azure, например службу приложений Azure. <li> Для этого потребуется внести в код минимальные изменения. <li> С другой стороны, компании Contoso необходимо будет обслуживать платформу виртуальных машин, так как корпорация Майкрософт не будет ею управлять. |
| Перепроектирование | <li> Эта стратегия изменяет или расширяет базу кода приложения, чтобы оптимизировать архитектуру приложения для возможностей облака и масштабирования. <li> Он модернизирована приложение в устойчивую, очень масштабируемую, независимо развертываемую архитектуру. <li> Службы Azure могут ускорить процесс, масштабировать приложения с уверенностью и легко управлять приложениями. |
| Перестроение | <li> Этот подход перестраивает приложение с нуля с помощью технологий, собственных в облаке. <li> Платформа как услуга (PaaS) Azure обеспечивает полноценную среду разработки и развертывания в облаке. Она устраняет некоторые затраты и сложность лицензий на программное обеспечение и устраняет необходимость в базовой инфраструктуре приложений, по промежуточного слоя и других ресурсах. | <li> Компания Contoso может переписать критически важные приложения с нуля, чтобы воспользоваться преимуществами облачных технологий, например бессерверных вычислений или микрослужб. <li> Компания Contoso будет управлять разрабатываемыми приложениями и службами, а Azure управляет всем остальным. |

Данные также необходимо учитывать, в особенности объем баз данных компании Contoso. Стандартным подходом компании Contoso является использование служб PaaS, таких как База данных SQL Azure, позволяющих воспользоваться всеми преимуществами облачных функций. Перейдя на службы PaaS для баз данных, компании будет достаточно только обслуживать данные, предоставив заботу о базовой платформе корпорации Майкрософт.

### <a name="evaluate-migration-tools"></a>Оценка инструментов миграции

Contoso в первую очередь использует несколько служб и средств Azure для миграции:

- Служба **" [Миграция Azure](https://docs.microsoft.com/azure/migrate/migrate-services-overview)":** Служба для миграции локальных виртуальных машин и других ресурсов в Azure.
- ** [Azure Site Recovery](https://docs.microsoft.com/azure/site-recovery/site-recovery-overview):** Управляет аварийным восстановлением и переносит локальные виртуальные машины в Azure.
- ** [Azure Database Migration Service](https://docs.microsoft.com/azure/dms/dms-overview):** Миграция локальных баз данных, таких как SQL Server, MySQL и Oracle, в Azure.

<!-- markdownlint-disable MD024 -->

#### <a name="azure-migrate"></a>Служба "Миграция Azure"

Служба "миграция Azure" является основной службой Azure для координации миграции из Azure и с локальных сайтов в Azure.

1. Служба "миграция Azure" управляет репликацией из локальных расположений в Azure.
2. Если настроена и запущена репликация, можно выполнить отработку отказа локальных компьютеров в Azure, завершив миграцию.

Компания Contoso уже [выполнила подтверждение концепции](./contoso-migration-rehost-vm.md) , чтобы увидеть, как служба "миграция Azure" может помочь им перенестися в облако.

##### <a name="use-azure-migrate-at-scale"></a>Использование службы "миграция Azure" в масштабе

Компания Contoso планирует выполнить несколько миграций с прогнозированием и сдвигом. Чтобы убедиться в этом, служба "миграция Azure" будет реплицировать пакеты около 100 виртуальных машин за раз. Чтобы определить, как это будет работать, компания Contoso должна выполнить планирование ресурсов для предлагаемой миграции.

- Необходимо собрать сведения об объемах трафика компании. В частности:
  - Компании Contoso необходимо определить скорость изменения для виртуальных машин, которые нужно реплицировать.
  - Кроме того, необходимо учесть возможности сетевого подключения локального сайта к Azure.
- Учитывая требования к емкости и объему, компании Contoso необходимо выделить достаточную пропускную способность, соответствующую скорости ежедневного изменения данных для необходимых виртуальных машин, чтобы обеспечить соответствие целевой точке восстановления (RPO).
- Наконец, они должны определить, сколько серверов требуется для выполнения компонентов службы "миграция Azure", необходимых для развертывания.

###### <a name="gather-on-premises-information"></a>Сбор сведений о локальной инфраструктуре

Contoso может использовать службу "миграция Azure":

- С его помощью компания может удаленно профилировать виртуальные машины без влияния на рабочую среду. Это помогает уточнить требования к пропускной способности и хранилищу для репликации и отработки отказа.
- Компания может запустить этот инструмент, не устанавливая в локальной среде какие-либо компоненты Site Recovery.
- Инструмент собирает данные о виртуальных машинах (совместимых и несовместимых), дисках на каждой виртуальной машине и обновлениях данных на каждом диске. Он также проверяет соответствие требованиям к пропускной способности сети и инфраструктуре Azure для успешной репликации и отработки отказа.
- Contoso необходимо убедиться, что затем запустить средство планировщика на компьютере Windows Server, который соответствует минимальным требованиям к серверу конфигурации Site Recovery. Сервер конфигурации — это компьютер Site Recovery, требуемый для репликации локальных виртуальных машин VMware.

###### <a name="identify-site-recovery-requirements"></a>Определение требований Site Recovery

В дополнение к реплицируемым виртуальным машинам службе Site Recovery требуется несколько компонентов для миграции VMware.

| Компонент | Сведения |
| --- | --- |
| Сервер конфигурации | <li> Обычно это виртуальная машина VMware, настроенная с помощью шаблона OVF. <li> Компонент сервера конфигурации используется для координации обмена данными между локальным источником и Azure, а также для управления репликацией данных. |
| Сервер обработки | <li> По умолчанию устанавливается на сервере конфигурации. <li> Компонент сервера обработки получает данные репликации. оптимизирует его с помощью кэширования, сжатия и шифрования; и отправляет его в службу хранилища Azure. <li> Сервер обработки также устанавливает Azure Site Recovery службу Mobility Service на виртуальных машинах, которые необходимо реплицировать, и выполняет автоматическое обнаружение локальных компьютеров. <li> Для масштабируемых развертываний требуются дополнительные, изолированные серверы, обрабатывающие большие объемы трафика репликации. |
| Служба Mobility Service | <li> Агент службы Mobility Service устанавливается на каждой виртуальной машине VMware, которая будет перенесена с Azure Site Recovery. |

Компании Contoso необходимо выяснить, как развернуть эти компоненты с учетом емкости.

<br>

| Компонент | Требования к ресурсам |
| --- | --- |
| Максимальная скорость ежедневного изменения | <li> Один сервер обработки может поддерживать скорость ежедневного изменения до 2 ТБ. Так как виртуальная машина может использовать только один сервер обработки, максимальная частота ежедневного изменения данных, поддерживаемая для реплицируемой виртуальной машины, составляет 2 ТБ. |
| Максимальная пропускная способность | <li> Стандартная учетная запись хранения Azure может обрабатывать не более 20 000 запросов в секунду, а количество операций ввода-вывода в секунду для реплицируемой виртуальной машины должно быть в пределах этого предела. Например, если виртуальная машина содержит 5 дисков, с каждым из которых может выполняться 120 операций ввода-вывода в секунду (размером в 8 КБ), то этот показатель не будет превышать ограничение в 500 операций ввода-вывода в секунду на диск в Azure. <li> Необходимое количество учетных записей хранения равно общему числу операций ввода-вывода на компьютере, деленное на 20 000. Реплицированный компьютер может принадлежать только одной учетной записи хранения в Azure. |
| Сервер конфигурации | Исходя из того, как компания Contoso оценивает репликацию 100-200 виртуальных машин и [требования к размерам сервера конфигурации](https://docs.microsoft.com/azure/site-recovery/site-recovery-plan-capacity-vmware#size-recommendations-for-the-configuration-server-and-inbuilt-process-server), компания Contoso оценивает необходимость использования компьютера сервера конфигурации следующим образом. <li> ЦП: 16 виртуальных ЦП (2 сокета &#215; 8 ядер с частотой 2,5 ГГц) <li> Память: 32 ГБ. <li> Диск кэша: 1 ТБ. <li> Скорость изменения данных: 1–2 ТБ. <br> В дополнение к требованиям к размерам компания Contoso должна обеспечить оптимальное расположение сервера конфигурации в той же сети и в том же сегменте сети, что и виртуальные машины, подлежат миграции. |
| Сервер обработки | Компания Contoso развернет выделенный изолированный сервер обработки, способный реплицировать 100–200 виртуальных машин. <li> ЦП: 16 виртуальных ЦП (2 сокета &#215; 8 ядер с частотой 2,5 ГГц) <li> Память: 32 ГБ. <li> Диск кэша: 1 ТБ. <li> Скорость изменения данных: 1–2 ТБ. <br> Сервер обработки будет работать жестко, поэтому он расположен на узле ESXi, который может обрабатывать операции дискового ввода-вывода, сетевой трафик и ЦП, необходимые для репликации. Компания Contoso рассмотрит выделенный узел для этой цели. |
| Сеть | <li> Компания Contoso проверила текущую инфраструктуру VPN типа "сеть — сеть" и решила реализовать Azure ExpressRoute. Реализация является критической, так как она будет снижать задержку и повышать пропускную способность в основном регионе Azure () компании Contoso `East US 2` . <li> Компании Contoso необходимо будет внимательно отслеживать данные, поступающие с сервера обработки. Если данные перегружают пропускную способность сети, компания Contoso будет расдумать о [регулировании пропускной способности сервера обработки](https://docs.microsoft.com/azure/site-recovery/site-recovery-plan-capacity-vmware#control-network-bandwidth). |
| Служба хранилища Azure | <li> Для миграции компания Contoso должна указать правильный тип и число целевых учетных записей хранения Azure. Site Recovery реплицирует данные виртуальной машины в службу хранилища Azure. <li> Site Recovery можно реплицировать в учетные записи хранения SSD уровня "Стандартный" или "Премиум". <li> Чтобы решить о хранении, компания Contoso должна проанализировать [ограничения хранилища](https://docs.microsoft.com/azure/virtual-machines/windows/disks-types) и рассмотреть ожидаемый рост и дальнейшее использование. Учитывая скорость и приоритет миграции, компания Contoso решила использовать твердотельные накопители уровня "Премиум". <li> Компания Contoso решила использовать управляемые диски для всех виртуальных машин, развернутых в Azure. Необходимые операции ввода-вывода позволяют определить, будут ли диски иметь стандартный HDD, Стандартный SSD или SSD уровня "Премиум". |

#### <a name="azure-database-migration-service"></a>Azure Database Migration Service

Azure Database Migration Service — это полностью управляемая служба, которая обеспечивает бесперебойную миграцию из нескольких источников базы данных на платформы данных Azure с минимальным временем простоя.

- Database Migration Service интегрирует функциональные возможности существующих средств и служб. Он использует Помощник по миграции данных (DMA) для создания отчетов об оценке, определяющих рекомендации по совместимости базы данных и все необходимые изменения.
- В Database Migration Service используется простой процесс самостоятельной миграции с интеллектуальной оценкой, который помогает решать потенциальные проблемы перед миграцией.
- Database Migration Service может выполнять миграцию по шкале из нескольких источников в целевую базу данных Azure.
- Database Migration Service обеспечивает поддержку от SQL Server 2005 до SQL Server 2017.

Database Migration Service не является единственным средством миграции баз данных Майкрософт. Вы можете изучить [сравнение инструментов и служб](https://blogs.msdn.microsoft.com/datamigration/2017/10/13/differentiating-microsofts-database-migration-tools-and-services).

##### <a name="use-database-migration-service-at-scale"></a>Использование Database Migration Service в масштабе

Contoso будет использовать Database Migration Service при миграции с SQL Server.

- При подготовке Database Migration Service компании Contoso необходимо правильно задать размер и настроить ее для оптимизации производительности при миграции данных. Компания Contoso выберет параметр "Business-critical tier with 4 vCores" (Уровень критически важных для бизнеса ресурсов с 4 виртуальными ядрами), чтобы служба могла воспользоваться преимуществами нескольких ЦП для параллелизации и ускорения передачи данных.

    ![Масштабирование Database Migration Service](./media/contoso-migration-scale/dms.png)

- Еще одним способов масштабирования, который компания Contoso может использовать, является временное масштабирование базы данных SQL Azure или целевого экземпляра базы данных Azure для MySQL до ценовой категории "Премиум" во время переноса данных. Это позволяет уменьшить регулирование базы данных, которое может повлиять на действия передачи данных при использовании более низких уровней.

##### <a name="use-other-tools"></a>Использование других средств

В дополнение к Database Migration Service Contoso может использовать другие средства и службы для обнаружения информации о виртуальной машине.

- У нее имеются сценарии для упрощения миграции вручную. Они хранятся в репозитории GitHub.
- Для миграции может также использоваться ряд [инструментов от партнеров](https://azure.microsoft.com/migration/partners).

## <a name="ready-for-production"></a>Готово к производству

После того как компания Contoso переместит ресурсы в Azure, им нужно оптимизировать их для повышения производительности и повысить окупаемость средств управления затратами. Учитывая, что Azure — это служба с оплатой по мере использования, для компании Contoso крайне важно понять, как работают системы, и убедиться, что их размер выбран правильно.

### <a name="azure-cost-management-and-billing"></a>Управление затратами Azure и выставление счетов

Чтобы максимально эффективно использовать свои инвестиции в облако, компания Contoso будет использовать бесплатное средство управления затратами Azure и выставления счетов.

- Это решение позволяет компании Contoso управлять затратами на облако с прозрачностью и точностью. Оно предоставляет инструменты для мониторинга, распределения и сокращения затрат на облако.
- Служба "Управление затратами Azure" и выставление счетов предоставляют простые отчеты панели мониторинга, помогающие в распределении затрат, шовбаккс и гибких операциях.
- Служба "Управление затратами Azure" и выставление счетов могут оптимизировать расходы на облако, определив недостаточно загруженные ресурсы, которые компания Contoso может использовать для управления и настройки.
- Дополнительные сведения об [управлении затратами Azure и выставлении счетов](https://docs.microsoft.com/azure/cost-management-billing/cost-management-billing-overview).

![Управление затратами Azure](./media/contoso-migration-scale/cost-management.png)

### <a name="native-tools"></a>Собственные инструменты

Компания Contoso также будет использовать сценарии для поиска неиспользуемых ресурсов.

- При крупной миграции часто остаются фрагменты данных, например виртуальные жесткие диски (VHD), которые подлежат оплате, но уже не представляют ценности для компании. Используемые сценарии хранятся в репозитории GitHub.
- Компания Contoso будет использовать преимущества работы ИТ-отдела корпорации Майкрософт и реализовать набор средств оптимизации ресурсов Azure (АТО).
- Компания Contoso может развернуть учетную запись службы автоматизации Azure с предварительно настроенными модулями runbook и расписаниями в своей подписке, чтобы начать экономить средства. Оптимизация ресурсов Azure в подписке происходит автоматически после включения или создания расписания, включая оптимизацию новых ресурсов.
- Это обеспечивает возможности децентрализованной автоматизации для снижения затрат. Доступны следующие функции:
  - Автоотсрочка виртуальных машин Azure на основе низкой загрузки ЦП.
  - Планирование откладывания и возобновления обработки виртуальных машин Azure.
  - Планирование откладывания и возобновления обработки виртуальных машин Azure по возрастанию или убыванию с помощью тегов Azure.
  - Массовое удаление групп ресурсов по запросу.
- Приступая к работе с набором средств оптимизации ресурсов Azure (АТО) через этот [репозиторий GitHub](https://github.com/azure/azure-quickstart-templates/tree/master/azure-resource-optimization-toolkit).

### <a name="partner-optimization-tools"></a>Инструменты оптимизации запросов

Можно использовать такие инструменты от партнеров, как [Hanu](https://hanu.com/insight) и [Scalr]( https://www.scalr.com/cost-optimization).

## <a name="phase-4-secure-and-manage"></a>Этап 4. Защита и управление

На этом этапе компания Contoso использует ресурсы по безопасности и управлению Azure для управления, защиты и мониторинга облачных приложений в Azure. Эти ресурсы помогают работать с защищенной и хорошо управляемой средой, используя продукты, доступные на портале Azure. Компания Contoso начинает использовать эти инструменты во время миграции. Благодаря поддержке гибридного использования Azure большинство из этих решений обеспечивают согласованную работу с гибридным облаком.

### <a name="security"></a>Безопасность

Компания Contoso полагается на центр безопасности Azure для унифицированного управления безопасностью и Azure Advanced Threat Protection в гибридных облачных рабочих нагрузках.

- Центр безопасности обеспечивает полную видимость и контроль безопасности облачных приложений в Azure.
- Компания Contoso может быстро обнаруживать угрозы и реагировать на них, а также снижать уровень риска угроз, активировав адаптивную защиту.

[Узнайте больше](https://azure.microsoft.com/services/security-center) о центре безопасности Azure.

### <a name="monitoring"></a>Мониторинг

Компания Contoso должна оценить работоспособность и производительность вновь перенесенных приложений, инфраструктуры и данных, работающих в Azure. Компания воспользуется встроенными инструментами мониторинга облака Azure, такими как Azure Monitor, рабочая область Log Analytics и Application Insights.

- С помощью этих средств компания Contoso может легко получать данные из источников и получать подробные сведения. Например, компания Contoso может получать данные об использовании памяти, дисков и ЦП для виртуальных машин с помощью датчиков, просматривать зависимости приложений и сети для нескольких виртуальных машин, а также отслеживать производительность приложений.
- С помощью этих облачных инструментов мониторинга компания приступит к работе и выполнит интеграцию с решениями по управлению службами.
- Дополнительные сведения о [мониторинге Azure](https://docs.microsoft.com/azure/azure-monitor/overview).

### <a name="business-continuity-and-disaster-recovery"></a>Непрерывность бизнес-процессов и аварийное восстановление

Компании Contoso потребуется стратегия непрерывности бизнес-процессов и аварийного восстановления (BCDR) для ресурсов Azure.

- Azure предоставляет [встроенные функции BCDR](https://docs.microsoft.com/azure/architecture/resiliency/disaster-recovery-azure-applications) для защиты данных и обеспечения работы приложений и служб.
- Помимо использования встроенных функций, компании Contoso необходимо обеспечить восстановление после сбоев, избежать дорогостоящего прерывания работы, выполнить требования соответствия и защитить данные от программ-шантажистов и ошибок пользователей. Выполните указанные ниже действия.
  - Компания Contoso развернет экономичное решение Azure Backup для резервного копирования ресурсов Azure. Так как это встроенное приложение, компания Contoso может настроить облачные резервные копии за несколько простых шагов.
  - Компания Contoso настроит аварийное восстановление виртуальных машин Azure с помощью Azure Site Recovery. Это решение будет использоваться для репликации, отработки отказа и восстановления размещения между указанными регионами Azure. Это гарантирует, что приложения, работающие на виртуальных машинах Azure, будут доступны во вторичном регионе компании Contoso, если происходит сбой в основном регионе. [Подробнее](https://docs.microsoft.com/azure/site-recovery/azure-to-azure-quickstart).

## <a name="conclusion"></a>Заключение

В этой статье было описано планирование миграции в Azure в нужном масштабе, выполненное компанией Contoso. Процесс миграции был разделен на четыре этапа. Начав с оценки и миграции, после выполнения миграции компания перешла к оптимизации, защите и управлению. В основном важно спланировать проект миграции как весь процесс, но для миграции систем внутри организации, разбивая их на классификации и числа, имеющие смысл для бизнеса. Оценивая данные и применяя классификации, можно разделить проект на ряд небольших миграций, которые можно выполнить быстро и безопасно. Совокупность этих меньших миграций быстро превратится в большую успешную миграцию к Azure.
