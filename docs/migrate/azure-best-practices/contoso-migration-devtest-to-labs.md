---
title: Перенос среды разработки и тестирования в Azure DevTest Labs
description: Узнайте, как компания Contoso перемещает свои локальные DevTest в Azure с помощью Azure DevTest Labs.
author: deltadan
ms.author: abuck
ms.date: 07/1/2020
ms.topic: conceptual
ms.service: cloud-adoption-framework
ms.subservice: migrate
services: azure-migrate
ms.openlocfilehash: a65e509b2f48ce1dc9066bfc8e52501f555057b1
ms.sourcegitcommit: bcc73d194c6d00c16ae2e3c7fb2453ac7dbf2526
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/09/2020
ms.locfileid: "86198804"
---
<!-- cSpell:ignore vcenter -->

# <a name="migrate-a-devtest-environment-to-azure-devtest-labs"></a>Перенос среды разработки и тестирования в Azure DevTest Labs

В этой статье показано, как вымышленная компания Contoso переносит свою среду разработки и тестирования в Azure DevTest Labs.

## <a name="migration-options"></a>Варианты переноса

У компании Contoso есть несколько вариантов, доступных при переносе среды разработки и тестирования в Azure.

| Варианты переноса | Результат |
| --- | --- |
| [Миграция Azure](https://docs.microsoft.com/azure/migrate/migrate-services-overview) | [Оценка](https://docs.microsoft.com/azure/migrate/tutorial-assess-vmware) и [Миграция](https://docs.microsoft.com/azure/migrate/tutorial-migrate-vmware) локальных виртуальных машин <br><br> Запуск серверов для разработки и тестирования с помощью Azure IaaS <br><br> Управление виртуальными машинами с помощью [Azure Resource Manager](https://azure.microsoft.com/features/resource-manager/) |
| [DevTest Labs](https://docs.microsoft.com/azure/devtest-labs/devtest-lab-overview) | Быстрая инициализация сред разработки и тестирования <br><br> Сократите отходы с помощью квот и политик <br><br> Настройка автоматического завершения работы для снижения затрат <br><br> Создание сред Windows и Linux |

> [!NOTE]
> В этой статье рассматривается использование DevTest Labs для перемещения локальной среды разработки и тестирования в Azure. Узнайте, как компания Contoso переместила [разработку и тестирование в Azure IaaS с](./contoso-migration-devtest-to-iaas.md) помощью службы "миграция Azure".

## <a name="business-drivers"></a>Бизнес-факторы

Команда разработчиков лидера в области разработки определила, что они хотят достичь при миграции:

- Предоставьте разработчикам доступ к средствам DevOps и среде самообслуживания.
- Доступ к средствам DevOps для конвейеров CI/CD и собственных инструментов в облаке для разработки и тестирования, таких как AI, машинное обучение и бессерверные.
- Обеспечьте управление и соответствие в средах разработки и тестирования.
- Сократите затраты, переместив все среды разработки и тестирования из центра обработки данных и не приобретайте оборудование для разработки программного обеспечения.

> [!NOTE]
> Contoso будет использовать [предложение подписки разработка и тестирование с оплатой по мере использования](https://azure.microsoft.com/offers/ms-azr-0023p) для своих сред. Каждый активный подписчик Visual Studio в своей группе может использовать программное обеспечение Майкрософт, включенное в свою подписку на виртуальные машины Azure для разработки и тестирования без дополнительной платы. Компания Contoso будет платить ставку Linux для виртуальных машин, которые они используют, даже для виртуальных машин с SQL Server, сервером SharePoint или другим программным обеспечением, для которых обычно взимается плата с более высокой ставкой.

<!-- -->

> [!NOTE]
> Клиенты Azure с Соглашение Enterprise также могут воспользоваться преимуществами [подписки на разработку и тестирование Azure](https://azure.microsoft.com/offers/ms-azr-0148p). Дополнительные сведения см. в этом [видео](https://channel9.msdn.com/blogs/ea.azure.com/enabling-and-creating-ea-devtest-subscriptions-through-the-ea-portal) о создании подписки на разработку и тестирование Azure с помощью портала Соглашение Enterprise.

## <a name="migration-goals"></a>Цели миграции

Команда разработчиков Contoso заблокировала цели для этой миграции. Эти цели используются для определения оптимального метода миграции.

- Быстро подготавливайте среды разработки и тестирования. Создание инфраструктуры для написания или тестирования программного обеспечения занимает несколько минут, а не месяцев.
- После миграции среда разработки и тестирования Contoso в Azure должна иметь расширенные возможности по сравнению с текущей локальной системой.
- Модель операций будет перенесена из подготовленных виртуальных машин в DevOps с помощью самостоятельной подготовки.
- Contoso хочет быстро выйти из своих локальных сред разработки и тестирования.
- Все разработчики будут подключаться к средам разработки и тестирования удаленно и безопасно.

## <a name="solution-design"></a>Архитектура решения

После фиксации целей и требований компания Contoso проектирует и изучает решение для развертывания, включая службы Azure, которые они будут использовать для разработки и тестирования.

### <a name="current-architecture"></a>Текущая архитектура

- Виртуальные машины для разработки и тестирования для приложений Contoso выполняются в локальном центре обработки данных в VMware.
- Эти виртуальные машины используются для разработки и тестирования до того, как код будет выдвинут на рабочие виртуальные машины.
- Разработчики сохраняют свои рабочие станции, но для удаленного подключения к домашним офисам требуются новые решения.

### <a name="proposed-architecture"></a>Предлагаемая архитектура

- Contoso будет использовать [подписку на разработку и тестирование Azure](https://azure.microsoft.com/offers/ms-azr-0023p) , чтобы снизить затраты на ресурсы Azure. Эта подписка обеспечивает значительную экономию, включая виртуальные машины, для которых не взимается плата за лицензирование программного обеспечения Майкрософт.
- DevTest Labs будут использоваться для управления средами. Новые виртуальные машины будут созданы в DevTest Labs для поддержки перехода на новые средства для разработки и тестирования в облаке.
- Локальные виртуальные машины для разработки и тестирования в центре обработки данных Contoso будут списаны после завершения миграции.
- Разработчики и тестировщики получат доступ к виртуальному рабочему столу Windows для своих рабочих станций.

![Архитектура сценария ](./media/contoso-migration-devtest-to-labs/architecture.png)
 _рис. 1. Архитектура сценария._

### <a name="database-considerations"></a>Рекомендации по базе данных

Для поддержки текущей разработки компания Contoso решила продолжать использовать базы данных, работающие на виртуальных машинах, но текущие виртуальные машины будут заменены новыми, работающими в DevTest Labs. В будущем компания Contoso будет использовать службы PaaS, такие как [база данных SQL Azure](https://docs.microsoft.com/azure/azure-sql/database/sql-database-paas-overview) и [база данных Azure для MySQL](https://docs.microsoft.com/azure/mysql/overview).

Текущие виртуальные машины баз данных VMware будут списаны и заменены виртуальными машинами Azure в DevTest Labs. Существующие базы данных будут перенесены с помощью простых резервных копий и восстановления. Используя предложение по разработке и тестированию подписки Azure, экземпляры Windows Server и SQL Server не будут оплачивать лицензии и свести к минимуму затраты на вычисление.

### <a name="solution-review"></a>Проверка решения

Специалисты Contoso оценивают предлагаемый дизайн, составляя список плюсов и минусов.

| Рассматриваемый вопрос | Сведения |
| --- | --- |
| **Преимущества** | Все текущие виртуальные машины разработки (приложение и база данных) будут заменены новыми виртуальными машинами, работающими в DevTest Labs. Это означает, что они могут воспользоваться возможностями встроенной среды разработки в облаке. <br><br> Компания Contoso может воспользоваться преимуществами своих инвестиций в подписку на разработку и тестирование Azure, чтобы сэкономить на лицензировании. <br><br> Contoso будет хранить полный контроль над виртуальными машинами приложений в Azure. <br><br> Разработчики будут предоставлять права доступа к подписке, которые позволяют им создавать новые ресурсы, не дожидаясь реагирования на их запросы. |
| **Недостатки** | Миграция будет перемещена только в облако, но они не будут использовать службы PaaS в своей разработке, так как они все еще используют виртуальные машины. Это означает, что компании Contoso потребуется начать поддержку операций виртуальных машин, включая исправления системы безопасности. Это было сохранено в прошлом, и им потребуется найти решение для этой новой рабочей задачи. <br><br> Компании Contoso придется создавать новые виртуальные машины приложений и баз данных, автоматизируя процесс. Это означает, что они могут использовать преимущества создания виртуальных машин в облаке и средства, предоставляемые DevTest Labs, поэтому это положительный результат даже при использовании Con в списке. |

### <a name="migration-process"></a>Процесс миграции

Компания Contoso перенесет свои виртуальные машины приложений и баз данных разработки на новые виртуальные машины Azure с помощью DevTest Labs.

- У них уже есть [инфраструктура Azure](./contoso-migration-infrastructure.md) , включая виртуальную сеть разработки.
- Когда все подготовлено, Contoso подготавливает и настраивает DevTest Labs.
- Они будут настраивать виртуальную сеть разработки, назначать группу ресурсов и устанавливать политики.
- Contoso создаст виртуальные рабочие столы Windows, чтобы разработчики использовали удаленные расположения.
- Создание виртуальных машин в DevTest Labs для разработки и миграции баз данных.

![Процесс миграции ](./media/contoso-migration-devtest-to-labs/migration-process-devtest-labs.png)
 _рис. 2. процесс миграции._

## <a name="prerequisites"></a>Предварительные требования

Ниже показано, что необходимо сделать специалистам компании Contoso, чтобы реализовать этот сценарий.

| Требования | Сведения |
| --- | --- |
| **Подписка на разработку и тестирование Azure** | Contoso создает [подписку на разработку и тестирование Azure](https://azure.microsoft.com/offers/ms-azr-0023p) , чтобы сократить затраты до 80%. <br><br> Если у вас еще нет подписки Azure, создайте [бесплатную учетную запись](https://azure.microsoft.com/free). <br><br> Если вы создаете бесплатную учетную запись, вы являетесь администратором подписки и можете выполнять все действия. <br><br> Если вы используете существующую подписку и вы не являетесь администратором, вам нужно обратиться к администратору, чтобы назначить вам разрешения владельца или участника. <br><br> Если вам требуются более детализированные разрешения, ознакомьтесь с [этой статьей](https://docs.microsoft.com/azure/site-recovery/site-recovery-role-based-linked-access-control). |
| **Инфраструктура Azure** | [Узнайте, как](./contoso-migration-infrastructure.md) компания Contoso настраивает инфраструктуру Azure. |

## <a name="scenario-steps"></a>Шаги выполнения сценария

Ниже рассказывается, как администраторы компании Contoso выполняют миграцию.

> [!div class="checklist"]
>
> - **Шаг 1. подготавливает новую подписку на разработку и тестирование Azure и создайте экземпляр DevTest Labs.**
> - **Шаг 2. Настройка виртуальной сети разработки, назначение группы ресурсов и Задание политик.**
> - **Шаг 3. Создание многосеансовых виртуальных рабочих столов Windows 10 Enterprise для использования разработчиками из удаленных расположений.**
> - **Шаг 4. Создание формул и виртуальных машин в DevTest Labs для разработки и миграции баз данных.**

## <a name="step-1-provision-a-new-azure-devtest-subscription-and-create-a-devtest-labs-instance"></a>Шаг 1. предоставление новой подписки Azure для разработки и тестирования и создание экземпляра DevTest Labs

Сначала Contoso необходимо предоставить новую подписку с помощью предложения по разработке и тестированию Azure, а затем создать экземпляр DevTest Labs.

Специалисты компании Contoso настроили их указанным ниже образом.

Компания Contoso использует ссылку на [подписку Azure для разработки и тестирования](https://azure.microsoft.com/offers/ms-azr-0023p) и подготавливает новую подписку, сохраняя до 80% на своих системах. Это предложение позволяет компании Contoso запускать образы Windows 10 в Azure для разработки и тестирования. Они получат доступ к [виртуальному рабочему столу Windows](https://docs.microsoft.com/azure/virtual-desktop/overview) , чтобы упростить управление удаленными разработчиками.

![Предложение DevTest ](./media/contoso-migration-devtest-to-labs/devtest-subscription.png)
 _. рис. 3. предложение подписки Azure для разработки и тестирования._

После подготовки новой подписки Contoso использует портал Azure для создания нового экземпляра DevTest Labs. Новая лаборатория создается в `ContosoDevRG` группе ресурсов.

![Создание DevTest Labs с помощью портала ](./media/contoso-migration-devtest-to-labs/new-lab.png)
 _рис. 4. Создание нового экземпляра DevTest Labs._

## <a name="step-2-configure-the-development-virtual-network-assign-a-resource-group-and-set-policies"></a>Шаг 2. Настройка виртуальной сети разработки, назначение группы ресурсов и Задание политик

После создания DevTest Labs компания Contoso будет выполнять конфигурации в следующих шагах:

- Настройка виртуальной сети
- Назначение группы ресурсов
- Настройка политик лаборатории

Специалисты компании Contoso настроили их указанным ниже образом.

1. Настройте виртуальную сеть.

    - На портале Contoso открывает экземпляр DevTest Labs и выбирает **конфигурацию и политики.**

      ![Конфигурация и политики ](./media/contoso-migration-devtest-to-labs/configure-lab.png)
       _рис. 5. экземпляр DevTest Labs: Конфигурация и политики._

    - Contoso выбирает **виртуальные сети**  >  **+ добавить**, выбирает `vnet-dev-eus2` , а затем **сохраняет**. Это позволяет использовать виртуальную сеть разработки для развертываний виртуальных машин. Кроме того, существует виртуальная сеть, созданная во время развертывания экземпляра DevTest Labs.

      ![Виртуальные сети ](./media/contoso-migration-devtest-to-labs/vnets.png)
       _рис. 6. виртуальные сети._

2. Назначить группу ресурсов:

    - Чтобы обеспечить развертывание ресурсов в `ContosoDevRG` группе ресурсов, Contoso настраивает их в параметрах лаборатории. Они также назначают разработчикам `Contributor` роль.

      ![Назначение группы ресурсов ](./media/contoso-migration-devtest-to-labs/assign-resource-group.png)
       _рис. 7. Назначение группы ресурсов._

    > [!NOTE]
    > Роль участника является ролью уровня администратора со всеми правами, за исключением того, что может предоставлять доступ другим пользователям. Узнайте больше о [элементах управления RBAC в Azure](https://docs.microsoft.com/azure/role-based-access-control/overview).

3. Задать политики лаборатории:

    - Компания Contoso должна убедиться, что их разработчики используют DevTest Labs в соответствии с политиками своей команды. Они настраивают DevTest Labs с помощью этих политик.

    - Автоматическое завершение работы включено с местным временем 7:00:00 pm и правильным часовым поясом.

      ![Автоматическое завершение работы ](./media/contoso-migration-devtest-to-labs/autoshutdown.png)
       _рис. 8. Автоматическое завершение работы._

    - Автоматический запуск включен, чтобы виртуальные машины работали и работали, когда разработчики начнут работать в сети. Они настроены на локальный часовой пояс и дни недели, когда они работают.

      ![Автозапуск ](./media/contoso-migration-devtest-to-labs/autostart.png)
       _рис. 9. Автоматический запуск._

    - Разрешенные размеры виртуальных машин настроены, обеспечивая возможность запуска больших и дорогостоящих виртуальных машин.

      ![Разрешенные размеры виртуальных машин ](./media/contoso-migration-devtest-to-labs/vm-sizes.png)
       _рис. 10. разрешенные размеры виртуальных машин._

    - Сообщение о поддержке настроено.

      ![Сообщение поддержки ](./media/contoso-migration-devtest-to-labs/support.png)
       _. рис. 11. сообщение о поддержке._

## <a name="step-3-create-windows-10-enterprise-multi-session-virtual-desktops-for-developers-to-use-from-remote-locations"></a>Шаг 3. Создание многосеансовых виртуальных рабочих столов Windows 10 Enterprise для использования разработчиками из удаленных расположений

Contoso необходимо создать виртуальный рабочий стол Windows для удаленных разработчиков.

Contoso создает виртуальную машину с несколькими сеансами Windows 10 Enterprise из базы.

- Contoso выбирает **все виртуальные машины** >  **+ добавить** и выбирает `Windows 10 enterprise multi-session` базу.

  ![Windows 10 Base ](./media/contoso-migration-devtest-to-labs/windows-10-vm-base.png)
   _рис. 12. многосеансовая база Windows 10 Корпоративная._

- Затем размер виртуальной машины настраивается вместе с артефактами, которые необходимо установить. В этом случае у разработчиков есть доступ к общим средствам разработки, таким как Visual Studio Code, Git и шоколад.

  ![Артефакты ](./media/contoso-migration-devtest-to-labs/artifacts.png)
   _рис. 13. артефакты._

- Конфигурация виртуальной машины проверяется на точность.

  ![Создание виртуальной машины на основе базового ](./media/contoso-migration-devtest-to-labs/vm-from-base.png)
   _рис. 14. Создание виртуальной машины из базы._

- После создания виртуальной машины удаленные разработчики компании Contoso смогут подключаться и использовать эту рабочую станцию разработки для работы. Выбранные артефакты устанавливаются при сохранении разработчиками времени для настройки рабочей станции.

  ![Виртуальная машина Ремотедевс ](./media/contoso-migration-devtest-to-labs/remote-vm.png)
   _рис. 15. Виртуальная машина для удаленного разработчика._

## <a name="step-4-create-formulas-and-vms-within-devtest-labs-for-development-and-migrate-databases"></a>Шаг 4. Создание формул и виртуальных машин в DevTest Labs для разработки и миграции баз данных

После настройки DevTest Labs и удаленной рабочей станции разработчиков компания Contoso фокусируется на создании виртуальных машин для разработки. Чтобы приступить к работе, компания Contoso выполняет следующие действия:

Создайте формулы (многократно используемые базы данных) для приложений и виртуальных машин и подготавливает виртуальные машины приложений и баз данных с помощью формул.

Создание формул для виртуальных машин приложений и баз данных.

- Contoso выбирает **формулы**  >  **+ добавить**, а затем `Windows 2012 R2 Datacenter` базу.

  ![Windows 2012 R2 Base ](./media/contoso-migration-devtest-to-labs/windows-2012-base.png)
   _рис. 16. Базовая папка Windows 2012 R2._

- Затем размер виртуальной машины настраивается вместе с артефактами, которые необходимо установить. В этом случае у разработчиков будет доступ к общим средствам разработки, таким как Visual Studio Code, Git и шоколад.

  ![Базовая конфигурация Windows 2012 R2 ](./media/contoso-migration-devtest-to-labs/windows-2012-base-configuration.png)
   _рис. 17. Базовая конфигурация Windows 2012 R2._

- Чтобы создать формулу виртуальной машины базы данных, компания Contoso выполняет те же основные действия, что и при выборе образа SQL Server 2012 для базы.

  ![SQL 2012 R2 Base ](./media/contoso-migration-devtest-to-labs/sql-2012-base.png)
   _рис. 18. изображение SQL Server 2012._

- В формуле настраивается размер и артефакты, в том числе SQL Server Management Studio, которые необходимы для этой формулы виртуальной машины разработки базы данных.

  ![Базовая конфигурация SQL 2012 R2 ](./media/contoso-migration-devtest-to-labs/sql-2012-base-configuration.png)
   _рис. 19. Базовая конфигурация sql Server 2020 R2._

Дополнительные сведения об использовании [формул](https://docs.microsoft.com/azure/lab-services/devtest-lab-manage-formulas) с DevTest Labs.

- Компания Contoso создала базовые формулы Windows для разработчиков, которые будут использоваться для своих приложений и баз данных.

  ![Настроенная виртуальная машина базы данных ](./media/contoso-migration-devtest-to-labs/contoso-formulas.png)
   _рис. 20: формулы базовой системы Windows._

Подготавливайте виртуальные машины приложений и баз данных с помощью формул:

- После создания формул Contoso Next выберет **все виртуальные машины** , а затем `Windows2012AppDevVmBase` формулу в соответствии с конфигурацией текущих виртуальных машин разработки приложений.

  ![Виртуальная машина приложения ](./media/contoso-migration-devtest-to-labs/app-vm.png)
   _рис. 21. Виртуальная машина разработки приложений._

- Для ВИРТУАЛЬНОЙ машины настраивается размер и артефакты, необходимые для этой виртуальной машины приложения.

  ![Настроенная виртуальная машина приложения ](./media/contoso-migration-devtest-to-labs/app-vm-configuration.png)
   _рис. 22. Конфигурация размера и артефактов для виртуальной машины._

- Затем виртуальная машина базы данных подготавливается с помощью формулы **склдбдеввмбасе** в соответствии с конфигурацией текущих виртуальных машин разработки базы данных.

  ![Виртуальная машина базы данных ](./media/contoso-migration-devtest-to-labs/database-vm.png)
   _рис. 23. Виртуальная машина базы данных._

- Для виртуальной машины настраивается требуемый размер и артефакты.

  ![Конфигурация виртуальной машины базы данных ](./media/contoso-migration-devtest-to-labs/database-vm-config.png)
   _рис. 24. конфигурации базы данных для виртуальной машины._

- С помощью своих первых виртуальных машин, созданных вместе с рабочей станцией удаленного разработчика, разработчики Contoso готовы начать писать код в Azure.

  ![Виртуальные машины Contoso ](./media/contoso-migration-devtest-to-labs/contoso-vms.png)
   _рис. 25. виртуальные машины Contoso._

- Теперь компания Contoso может восстановить свои базы данных разработки из резервных копий или с помощью какого бы то ни было определенного типа процесса создания кода для создания схемы на виртуальных машинах. Если SQL Server Management Studio уже установлен с помощью артефактов, это простые задачи, для которых не требуется установка каких бы то ни было средств.

## <a name="clean-up-after-migration"></a>Очистка после миграции

Компания Contoso продолжит использовать эти шаги для переноса виртуальных машин в Azure с помощью DevTest Labs. После каждой миграции все виртуальные машины разработки теперь работают в DevTest Labs.

Теперь специалистам компании Contoso необходимо выполнить указанные ниже действия по очистке.

- Удалите виртуальные машины из каталога vCenter.
- Удалите все виртуальные машины из локальных заданий резервного копирования.
- Обновите внутреннюю документацию, чтобы отобразить новое расположение и IP-адреса для виртуальных машин.
- Проверить все ресурсы, взаимодействующие с виртуальными машинами, и обновить все соответствующие параметры или документы согласно новой конфигурации.

### <a name="security"></a>Безопасность

Группа безопасности Contoso рассматривает виртуальные машины Azure, чтобы определить проблемы безопасности. Чтобы можно было управлять доступом, команда проверяет группы безопасности сети (NSG) для виртуальных машин. Группы безопасности сети используются, чтобы обеспечить доступ к нему только для трафика, разрешенного приложению. Группа также рассматривает защиту данных на диске с помощью шифрования дисков Azure и Azure Key Vault. Дополнительные сведения см. в статье рекомендации [по обеспечению безопасности для рабочих нагрузок IaaS в Azure](https://docs.microsoft.com/azure/security/fundamentals/iaas).

### <a name="licensing-and-cost-optimization"></a>Лицензирование и оптимизация затрат

- Компания Contoso обеспечит создание ресурсов Azure для разработки с помощью этой подписки для разработки и тестирования, чтобы воспользоваться преимуществами экономии 80%.
- Бюджеты будут рассмотрены для всех DevTest Labs и политик для типа виртуальных машин, которые будут использоваться для обеспечения затрат и перенаполнения, не происходит по ошибке.
- Компания Contoso включит службу [управления затратами Azure и выставления счетов](https://docs.microsoft.com/azure/cost-management-billing/cost-management-billing-overview) для помощи в мониторинге ресурсов Azure и управлении ими.

## <a name="conclusion"></a>Заключение

В этой статье компания Contoso переместила свои среды разработки в DevTest Labs. Они также реализовали виртуальный рабочий стол Windows как платформу для удаленных и контрактных разработчиков.

**Требуется дополнительная помощь?**

[Создайте экземпляр DevTest Labs](https://docs.microsoft.com/azure/lab-services/devtest-lab-create-lab) в своей подписке и Узнайте, как использовать [DevTest Labs для разработчиков](https://docs.microsoft.com/azure/lab-services/devtest-lab-developer-lab).
