---
title: Рекомендации по издержек и размеру рабочих нагрузок, перенесенных в Azure
description: Используйте платформу внедрения облаков для Azure, чтобы получить рекомендации по изучению затрат и изменению размера рабочих нагрузок, перенесенных в Azure.
author: BrianBlanchard
ms.author: brblanch
ms.date: 07/01/2020
ms.topic: conceptual
ms.service: cloud-adoption-framework
ms.subservice: migrate
ms.openlocfilehash: 1335b01581dc62e115072a20ff46f5c9ffdf1609
ms.sourcegitcommit: 84d7bfd11329eb4c151c4c32be5bab6c91f376ed
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/10/2020
ms.locfileid: "86233398"
---
<!-- docsTest:ignore ARO -->

# <a name="best-practices-to-cost-and-size-workloads-migrated-to-azure"></a>Рекомендации по издержек и размеру рабочих нагрузок, перенесенных в Azure

Для успеха переноса в Azure в долгосрочной перспективе при планировании и проектировании миграции следует сосредоточиться на оценке затрат. На протяжении проекта миграции очень важно, чтобы все команды (финансовый отдел, руководство и команды по разработке приложений) понимали связанные с ним расходы.

- Оценка ваших затрат на ее осуществление с базовыми показателями месячного, квартального и годового бюджета перед миграцией имеет решающее значение для успеха.
- После миграции необходимо оптимизировать затраты, постоянно отслеживать рабочие нагрузки и планировать будущие структуры потребления. Сначала перенесенные ресурсы могут представлять собой один тип рабочей нагрузки, но со временем (в зависимости от использования, затрат и изменения бизнес-требований) тип может меняться.

В этой статье содержатся рекомендации по оценке затрат и изменению размеров до и после миграции.

> [!IMPORTANT]
> Рекомендации и мнения, описанные в этой статье, основываются на возможностях платформы Azure и служб, доступных на момент написания этого материала. Функции и возможности со временем меняются. Для вашего сценария развертывания могут применяться не все рекомендации, поэтому выберите подходящие.

## <a name="before-migration"></a>Перед миграцией

Прежде чем перенести рабочие нагрузки в облако, оцените ежемесячную стоимость их выполнения в Azure. Оперативное управление облачными расходами поможет оставаться в рамках бюджета операционных расходов. Если бюджет ограничен, примите это во внимание перед миграцией. Чтобы сократить расходы, рассмотрите возможность преобразования рабочих нагрузок в бессерверные технологии Azure там, где это уместно.

Рекомендации в этом разделе помогут вам оценить затраты, выполнить требуемый размер для виртуальных машин и хранилища, использовать Преимущество гибридного использования Azure, использовать Azure Reserved VM Instances и оценить затраты на облако в рамках подписок.

## <a name="best-practice-estimate-monthly-workload-costs"></a>Рекомендации: Оценка месячных затрат на рабочую нагрузку

Чтобы спрогнозировать ваш ежемесячный счет за перенесенные рабочие нагрузки, можно использовать ряд инструментов.

<!-- TODO: Change "input costs" -->

- **Калькулятор цен Azure:** Выберите продукты, которые требуется оценить, например виртуальные машины и хранилище, а затем введите затраты в калькулятор для создания оценки.

 ![Калькулятор цен Azure в расчете ](./media/migrate-best-practices-costs/pricing.png) _цен Azure._

- Служба **"миграция Azure":** Чтобы оценить затраты, необходимо проверить и учитывать все ресурсы, необходимые для выполнения рабочих нагрузок в Azure. Чтобы получить эти данные, необходимо провести инвентаризацию ресурсов, включая серверы, виртуальные машины, базы данных и хранилище. Для сбора этой информации можно использовать службу "Миграция Azure".

- Служба "Миграция Azure" обнаруживает и оценивает вашу локальную среду для составления инвентарного перечня.
- Она может сопоставлять и отображать зависимости между виртуальными машинами, чтобы предоставить вам полную картину.
- Оценка службы "Миграция Azure" содержит предполагаемые расходы.
  - **Затраты на вычисление:** При создании оценки рекомендуется использовать размер виртуальной машины Azure. Служба "миграция Azure" использует API-интерфейсы выставления счетов Azure для вычисления оценочных ежемесячных затрат на виртуальные машины. В ходе оценки учитывается операционная система, Software Assurance, Azure Reserved Virtual Machine Instances, время работы виртуальной машины, расположение и параметры валюты. Служба суммирует затраты на все виртуальные машины, которые оцениваются, чтобы рассчитать общие ежемесячные затраты на вычислительные ресурсы.
  - **Стоимость хранилища:** Служба "миграция Azure" вычисляет общие ежемесячные затраты на хранение, суммируя затраты на хранение всех виртуальных машин в ходе оценки. Вы можете вычислить ежемесячные затраты на хранилище определенного компьютера путем суммирования ежемесячных затрат на все подключенные к нему диски.

    ![Azure выполняет миграцию ](./media/migrate-best-practices-costs/assess.png)
     _оценки миграции Azure._

**Подробнее:**

- Используйте [Калькулятор цен Azure](https://azure.microsoft.com/pricing/calculator).
- Ознакомьтесь с [обзором службы "миграция Azure](https://docs.microsoft.com/azure/migrate/migrate-services-overview)".
- Узнайте об [оценках службы "Миграция Azure"](https://docs.microsoft.com/azure/migrate/concepts-assessment-calculation).
- Дополнительные сведения о [Azure Database Migration Service](https://docs.microsoft.com/azure/dms/dms-overview).

## <a name="best-practice-right-size-vms"></a>Рекомендации: подходящие размеры виртуальных машин

При развертывании виртуальных машин Azure для поддержки рабочих нагрузок можно выбрать несколько вариантов. Каждый тип виртуальной машины имеет свои особые возможности и различные комбинации ЦП, памяти и дисков. Виртуальные машины сгруппированы следующим образом.

| Тип | Сведения | Использование |
| --- | --- | --- |
| **Общего назначения** | Сбалансированное соотношение ресурсов ЦП и памяти. | Подходит для тестирования и разработки, небольших и средних баз данных, веб-серверов с низким и средним объемом трафика. |
| **Оптимизированные по вычислительным ресурсам** | Высокое соотношение ресурсов ЦП и памяти. | Подходит для веб-сервера с объемом трафика, сетевых устройств, процессов пакетной обработки, серверов приложений. |
| **Оптимизированные для памяти** | Высокое соотношение ресурсов памяти и ЦП. | Хорошее решение для реляционных баз данных, кэша среднего и большого объема и выполняющейся в памяти аналитики. |
| **Оптимизированные для операций в хранилище** | Высокая пропускная способность диска и операции ввода-вывода. | Подходит для работы с большими данными, а также с базами данных SQL и NoSQL. |
| **Оптимизированные для GPU** | Специализированные виртуальные машины. Один или несколько GPU. | Большие объемы графики и редактирование видео. |
| **Высокопроизводительные** | Самый быстрый и мощный ЦП. Виртуальные машины, для которых можно настроить сетевые интерфейсы с высокой пропускной способностью (RDMA) | Критические высокопроизводительные приложения. |

- Важно понимать разницу в ценах на эти виртуальные машины, а также долгосрочные последствия для бюджета.
- Каждый тип включает в себя несколько серий виртуальных машин.
- Кроме того, когда вы выбираете в серии виртуальную машину, то можете масштабировать ее только в пределах этой серии. Например, `DS2_v2` экземпляр может масштабироваться до `DS4_v2` , но не может быть изменен на экземпляр другого ряда, например `F2s_v2` экземпляр.

**Подробнее:**

- Узнайте больше о [типах виртуальных машин,](https://docs.microsoft.com/azure/virtual-machines/windows/sizes) размерах и размерах карт для типов.
- [Размеры планов для экземпляров виртуальных машин](https://docs.microsoft.com/azure/cloud-services/cloud-services-sizes-specs).
- Ознакомьтесь с [примерной оценкой для вымышленной компании Contoso](https://docs.microsoft.com/azure/migrate/contoso-migration-assessment).

## <a name="best-practice-select-the-right-storage"></a>Рекомендации. Выберите нужное хранилище.

Настройка и обслуживание локального хранилища (SAN или NAS), а также сетей для его поддержки могут быть дорогостоящими и занимать много времени. Чтобы уменьшить операционные и управленческие проблемы, файловые данные (данные хранилища) обычно переносятся в облако. Корпорация Майкрософт предоставляет несколько вариантов перемещения данных в Azure, так что вам необходимо решить, какой из них использовать. Выбор правильного типа хранилища данных может экономить вашей организации несколько тысяч долларов ежемесячно. Ниже приведены некоторые рекомендации.

- Данные, к которым не обращаются много и не являются критически важными для бизнеса, не нужно размещать в наиболее дорогостоящем хранилище.
- И наоборот, критически важные для бизнеса данные должны располагаться в хранилищах более высокого уровня.
- Во время планирования миграции проведите инвентаризацию данных и классифицируйте их по важности, чтобы сопоставить их с наиболее подходящим хранилищем. Учитывайте бюджет и стоимость, а также производительность. Стоимость не обязательно должна быть основным фактором при принятии решений. Выбор наименее дорогого варианта может подвергнуть рабочую нагрузку риску с точки зрения производительности и доступности.

### <a name="storage-data-types"></a>Типы данных хранилища

Azure предоставляет различные типы данных хранилища.

| Тип данных | Сведения | Использование |
| --- | --- | --- |
| **BLOB-объекты** | Оптимизировано для хранения больших объемов неструктурированных объектов, таких как текстовые или двоичные данные. <br><br> | Доступ к данным отовсюду через HTTP/HTTPS. <br><br> Используется для сценариев потоковой передачи и произвольного доступа. Например, для передачи изображений и документов непосредственно в браузер, потокового видео и аудио, а также для хранения данных резервного копирования и аварийного восстановления. |
| **Файлы** | Управляемые общие файловые ресурсы, доступ к которым осуществляется через SMB 3,0. | Используется при миграции локальных общих файловых ресурсов и для обеспечения множественного доступа или подключений к данным файла. |
| **диски;** | На основе страничных BLOB-объектах. <br><br> Тип диска: Стандартный (HDD или SSD) или Premium (SSD). <br><br> Управление дисками. неуправляемый (Управление параметрами дисков и хранением) или управление ими (выберите тип диска, и Azure управляет диском). | Используйте диски уровня "Премиум" для виртуальных машин. Для простого управления и масштабирования используются управляемые диски. |
| **очередей;** | Хранение и получение большого количества сообщений, доступ к которым осуществлялся через вызовы с проверкой подлинности (HTTP или HTTPS). | Подключение компонентов приложения с помощью асинхронной очереди сообщений. |
| **Таблицы** | Хранение таблиц. | Теперь входит в состав API таблиц Azure Cosmos DB. |

### <a name="access-tiers"></a>Уровни доступа

Служба хранилища Azure предоставляет различные возможности для доступа к данным блочного BLOB-объекта. Выбор правильного уровня доступа позволит хранить данные блочных BLOB-объектов наиболее экономичным способом.

| Уровень доступа | Сведения | Использование |
| --- | --- | --- |
| **Горячий уровень хранилища** | Более высокие затраты на хранение, чем здорово. Снижение расходов на доступ, чем у замечательных. <br><br> Это уровень по умолчанию. | Используйте для активно используемых данных, к которым часто обращаются. |
| **Классно** | Меньше затрат на хранение, чем на горячий. Более высокие расходы на доступ, чем горячий. <br><br> Хранение не менее чем 30 дней. | Краткосрочное хранение, данные доступны, но к ним редко обращаются. |
| **Упражнени** | Используется для отдельных блочных BLOB-объектов. <br><br> Наиболее экономный способ хранения. Доступ к данным дороже, чем для горячего и холодного уровней хранилищ. | Используйте для данных, которые могут допускать несколько часов задержки при извлечении и останутся на уровне не менее 180 дней. |

### <a name="storage-account-types"></a>Типы учетных записей хранения

Azure предоставляет различные типы учетных записей хранения и уровней производительности.

| Тип учетной записи | Сведения | Использование |
| --- | --- | --- |
| **Универсальный стандарт общего назначения версии 2** | Поддерживает BLOB-объекты (блок, страница, добавление), файлы, диски, очереди и таблицы. <br><br> Поддерживает горячий, стильный и архивный уровни доступа. Поддерживается ZRS. | Используется для большинства сценариев и типов данных. Учетные записи хранения уровня "Стандартный" могут быть основаны на жестких дисках или SSD. |
| **Универсальное назначение версии 2 Premium** | Поддерживает данные хранилища BLOB-объектов (страничные BLOB-объекты). Поддерживает горячий, стильный и архивный уровни доступа. Поддерживается ZRS. <br><br> Хранение на SSD. | Майкрософт рекомендует использовать для всех виртуальных машин. |
| **Общего назначения версии 1** | Распределение по уровням доступа не поддерживается. Не поддерживает ZRS. | Используйте, если приложениям требуется классическая модель развертывания Azure. |
| **Большой двоичный объект** | Специализированная учетная запись хранения для хранения неструктурированных объектов. Предоставляет блочные и добавочные BLOB-объекты (без файлов, очередей, таблиц или дисковых служб хранения). Обеспечивает ту же устойчивость, доступность, масштабируемость и производительность, что и общая цель версии 2. | Вы не можете хранить страничные BLOB-объекты в этих учетных записях, поэтому они не могут хранить файлы VHD. Можно установить уровень доступа "горячий" или "холодное". |

### <a name="storage-redundancy-options"></a>Параметры избыточности хранилища

Учетные записи хранения могут использовать различные виды избыточности для обеспечения устойчивости и высокого уровня доступности.

| Тип | Сведения | Использование |
| --- | --- | --- |
| **Локально избыточное хранилище (LRS)** | Защищает от локальных сбоев, реплицируя одну единицу хранения в отдельный домен сбоя и домен обновления. Сохраняет несколько копий данных в одном центре обработки данных. Предоставляет по крайней мере 99,999999999% (одиннадцать 9) устойчивости объектов в течение заданного года. | Рассмотрите возможность хранения данных в приложении, которые можно легко воссоздать. |
| **Хранилище, избыточное между зонами (ZRS)** | Предоставляет защиту от сбоя центр обработки данных, реплицируя все три кластера хранилища в одном регионе. Каждый кластер хранилища физически отделен и находится в собственной зоне доступности. Предоставляет по крайней мере уровне 99,9999999999% (двенадцать 9) устойчивость объектов в течение определенного года, сохраняя несколько копий данных в нескольких центрах обработки или регионах. | Рекомендуется, если требуется согласованность, устойчивость и высокий уровень доступности. Не может защитить данные от региональной аварии, при которой полностью выходят из строя несколько зон. |
| **Геоизбыточное хранилище (GRS)** | Обеспечивает защиту от сбоя всего региона, реплицируя данные в дополнительный регион, который удален от основного. Предоставляет минимум 99,99999999999999 процента (16) устойчивость объектов в течение заданного года. | Данные реплики будут недоступны, пока корпорация Майкрософт не инициирует отработку отказа в дополнительном регионе. При отработке отказа чтение и запись доступны. |
| **Геоизбыточное хранилище с доступом для чтения (RA-GRS)** | Как и GRS. Предоставляет минимум 99,99999999999999 процента (16) устойчивость объектов в течение заданного года. | Обеспечивает доступность и 99,99 процентов доступной для чтения из второго региона, используемого для GRS. |

**Подробнее:**

- Ознакомьтесь с [ценами на хранилище Azure](https://azure.microsoft.com/pricing/details/storage).
- Сведения об [импорте и экспорте Azure для переноса больших объемов данных в большие двоичные объекты и файлы Azure](https://docs.microsoft.com/azure/storage/common/storage-import-export-service).
- Сравните [большие двоичные объекты, файлы и типы данных дискового хранилища](https://docs.microsoft.com/azure/storage/common/storage-decide-blobs-files-disks).
- Дополнительные сведения о [уровнях доступа](https://docs.microsoft.com/azure/storage/blobs/storage-blob-storage-tiers).
- Проверьте [различные типы учетных записей хранения](https://docs.microsoft.com/azure/storage/common/storage-account-overview).
- Сведения о [избыточности службы хранилища Azure](https://docs.microsoft.com/azure/storage/common/storage-redundancy), включая LRS, ZRS, GRS и GRS доступа для чтения.
- Дополнительные сведения о [службе файлов Azure](https://docs.microsoft.com/azure/storage/files/storage-files-introduction).

## <a name="best-practice-take-advantage-of-azure-hybrid-benefit"></a>Рекомендации. Воспользуйтесь преимуществами Преимущество гибридного использования Azure

Благодаря годам инвестиций в разработку программного обеспечение для таких систем, как Windows Server и SQL Server, корпорация Майкрософт обладает уникальной возможностью предложить клиентам ценные возможности в облаке со значительными скидками, которые далеко не всегда могут предоставить другие поставщики облачных служб.

Интегрированный портфель локальных продуктов корпорации Майкрософт и продуктов Azure создает конкурентные и ценовые преимущества. Если у вас есть операционная система или другое лицензирование программного обеспечения в рамках программы Software Assurance (SA), вы можете использовать эти лицензии в облаке с Преимущество гибридного использования Azure.

**Подробнее:**

- [Взгляните](https://azure.microsoft.com/pricing/hybrid-benefit) на калькулятор преимущество гибридного использования Azure экономии.
- Дополнительные сведения о [преимущество гибридного использования Azure для Windows Server](https://azure.microsoft.com/pricing/hybrid-benefit).
- Ознакомьтесь с [руководством по ценам для SQL Server виртуальных машин Azure](https://docs.microsoft.com/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-server-pricing-guidance).

## <a name="best-practice-use-reserved-vm-instances"></a>Рекомендации. использование зарезервированных экземпляров виртуальных машин

Большинство облачных платформ настраиваются с оплатой по мере использования. У данной модели есть недостатки, поскольку вам не всегда известно, какими будут динамические рабочие нагрузки. Выражая четкие намерения в отношении рабочей нагрузки, вы принимаете участие в планировании инфраструктуры.

Используя Azure Reserved VM Instances, вы представите предоплату за один или три года для экземпляров виртуальных машин.

- Предварительная оплата обеспечивает скидку на используемые ресурсы.
- Вы можете значительно сократить затраты на виртуальные машины, вычисление базы данных SQL, Azure Cosmos DB или другие ресурсы до 72% по ценам оплаты по мере использования.
- Резервирования обеспечивают скидку при выставлении счетов и не влияют на состояние среды выполнения ваших ресурсов.
- Зарезервированные экземпляры можно отменить.

![Зарезервированные экземпляры виртуальных машин Azure ](./media/migrate-best-practices-costs/reserve.png)
 _Azure reserved VM Instances._

**Подробнее:**

- Дополнительные сведения о [резервировании Azure](https://docs.microsoft.com/azure/cost-management-billing/reservations/save-compute-costs-reservations).
- Прочитайте [Azure reserved VM Instances часто задаваемые вопросы](https://azure.microsoft.com/pricing/reserved-vm-instances/#faq).
- Ознакомьтесь с [руководством по ценам для SQL Server виртуальных машин Azure](https://docs.microsoft.com/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-server-pricing-guidance).

## <a name="best-practice-aggregate-cloud-spend-across-subscriptions"></a>Рекомендация: агрегирование облачных затрат по подпискам

Со временем у вас неизбежно будет несколько подписок Azure. Например, возможно, вам понадобится дополнительная подписка для разделения границ среды разработки и рабочей среды, или у вас появится платформа, которая потребует отдельную подписку для каждого клиента. Ценной функцией является возможность выполнять статистические вычисления для отчетов данных по всем подпискам в одной платформе.

Для этого можно использовать службу "Управление затратами Azure" и API-интерфейсы выставления счетов. Затем после агрегирования данных в единый источник, например Azure SQL, для получения статистических данных можно использовать такие инструменты, как Power BI. Вы можете создавать статистические отчеты по подписке, а также детализированные отчеты. Например, для пользователей, которым требуется упреждающее представление об управлении затратами, можно создать конкретные представления затрат на основе отдела, группы ресурсов или другой информации. При этом нет необходимости предоставлять полный доступ к данным по выставлению счетов в Azure.

**Подробнее:**

- Ознакомьтесь с [обзором интерфейсов API потребления Azure](https://docs.microsoft.com/azure/billing/billing-consumption-api-overview).
- Узнайте, как [подключиться к Azure consumption Insights в Power BI Desktop](https://docs.microsoft.com/power-bi/desktop-connect-azure-consumption-insights).
- Узнайте, как [управлять доступом к сведениям о выставлении счетов для Azure с помощью управления доступом на основе ролей (RBAC)](https://docs.microsoft.com/azure/billing/billing-manage-access).

## <a name="after-migration"></a>После переноса

После успешной миграции рабочих нагрузок и несколько недель сбора данных о потреблении вы получите четкое представление о затратах на ресурсы.

- При анализе данных можно приступить к созданию базового плана бюджета для ресурсов и групп ресурсов Azure.
- Затем, понимая структуру затрат в бюджете облака, можно проанализировать возможности для дополнительного сокращения затрат.

Рекомендации в этом разделе включают использование службы "Управление затратами Azure" и выставления счетов за бюджетирование и анализ затрат, мониторинг ресурсов и внедрение бюджетов групп ресурсов и оптимизацию мониторинга, хранения и виртуальных машин.

## <a name="best-practice-use-azure-cost-management-and-billing"></a>Рекомендации. Использование службы управления затратами Azure и выставления счетов

Корпорация Майкрософт предоставляет службы управления затратами Azure и выставления счетов для помощи в отслеживании расходов:

- Помогает отслеживать и контролировать расходы в Azure и оптимизировать использование ресурсов.
- Проверяет все подписки и ресурсы и предоставляет рекомендации.
- Предоставляет полнофункциональный API для интеграции внешних инструментов и финансовых систем для создания отчетов.
- Отслеживает использование ресурсов и управление затратами на облако с помощью единого представления.
- Предоставляет подробные операционные и финансово-аналитические сведения, чтобы помочь вам принять обоснованные решения.

С помощью управления затратами и выставления счетов вы можете:

- **Создайте бюджет:** Создайте бюджет для финансовой отчетности.
  - Вы можете учесть службы, которые вы используете или на которые вы подписаны, за определенный период (месяц, квартал или год), а также область (подписки или группы ресурсов). Например, можно создать бюджет подписки Azure на месячный, квартальный или годовой период.
    - Анализ затрат отображается после создания бюджета. Просмотр бюджета по текущим расходам – один из первых шагов, которые необходимо выполнить при анализе затрат и расходов.
  - При достижении порога бюджета могут отправляться уведомления по электронной почте.
  - Вы можете экспортировать данные управления затратами в службу хранилища Azure для анализа.

  ![Управление затратами бюджет ](./media/migrate-best-practices-costs/budget.png)
   _управления затратами Azure и бюджетом выставления счетов._

- **Анализ затрат:** Получите анализ затрат для изучения и анализа затрат на организацию, чтобы понять, как начисляются затраты, и выявление тенденций расходов.
  - Анализ затрат доступный пользователям EA.
  - Вы можете просмотреть данные анализа затрат для нескольких областей, в том числе для отдела, учетной записи, подписки или группы ресурсов.
  - Можно получить анализ затрат, который показывает общие затраты за текущий месяц и накопленные ежедневные затраты.

  ![Анализ управления затратами Azure. ](./media/migrate-best-practices-costs/analysis.png)
   _Схема: Управление затратами Azure и анализ выставления счетов._

- **Получить рекомендации:** Получите рекомендации помощника, которые покажут, как можно оптимизировать и повысить эффективность.

**Подробнее:**

- Ознакомьтесь с [обзором службы управления затратами Azure и выставления счетов](https://docs.microsoft.com/azure/cost-management-billing/cost-management-billing-overview).
- Узнайте, как [оптимизировать инвестиции в облако с помощью службы "Управление затратами Azure" и выставления счетов](https://docs.microsoft.com/azure/cost-management-billing/costs/cost-mgt-best-practices).
- Сведения об [управлении затратами Azure и отчетах о выставлении счетов](https://docs.microsoft.com/azure/cost-management/use-reports).
- Ознакомьтесь с [руководством по оптимизации затрат из рекомендаций](https://docs.microsoft.com/azure/cost-management-billing/costs/tutorial-acm-opt-recommendations).
- Ознакомьтесь с [API-интерфейсами использования Azure](https://docs.microsoft.com/rest/api/consumption/budgets).

## <a name="best-practice-monitor-resource-utilization"></a>Рекомендации: мониторинг использования ресурсов

В Azure вы платите по мере использования, когда потребляете ресурсы, и не платите, если ими не пользуетесь. Для виртуальных машин выставление счетов происходит, когда виртуальная машина выделена, а когда ее выделение отменяется, плата не взимается. Учитывая это, следует контролировать использование виртуальных машин и проверять изменение их размеров.

- Постоянно оценивайте рабочие нагрузки виртуальной машины, чтобы определить базовые показатели.
- Например, если рабочая нагрузка интенсивно используется с понедельника по пятницу с 8:00 до 18:00, но вне этого времени используется редко, вне этого периода можно переходить на использование менее дорогой версии виртуальной машины. Это может приводить к изменению размеров виртуальной машины или потребовать использования масштабируемого набора виртуальных машин для автоматического масштабирования виртуальных машин.
- Некоторые компании "откладывают" виртуальные машины, обозначая в календаре дату и время их доступности.
- Помимо мониторинга виртуальной машины следует отслеживать другие сетевые ресурсы, среди которых ExpressRoute и шлюзы виртуальных сетей для избыточного и недостаточного использования.
- Вы можете отслеживать использование виртуальных машин с помощью таких средств Майкрософт, как управление затратами Azure и выставление счетов, Azure Monitor и помощник по Azure. Доступны также сторонние средства.

**Подробнее:**

- Ознакомьтесь с обзором [Azure Monitor](https://docs.microsoft.com/azure/azure-monitor/overview) и [помощника по Azure](https://docs.microsoft.com/azure/advisor/advisor-overview).
- [Получите рекомендации по стоимости помощника по Azure](https://docs.microsoft.com/azure/advisor/advisor-cost-recommendations).
- Узнайте, как [оптимизировать расходы от рекомендаций](https://docs.microsoft.com/azure/cost-management-billing/costs/tutorial-acm-opt-recommendations)и [предотвратить непредвиденные расходы](https://docs.microsoft.com/azure/billing/billing-getting-started).
- Узнайте о [наборе средств оптимизации ресурсов Azure (АТО)](https://github.com/azure/azure-quickstart-templates/tree/master/azure-resource-optimization-toolkit).

## <a name="best-practice-implement-resource-group-budgets"></a>Рекомендации. Реализация бюджетов групп ресурсов

Группы ресурсов часто используются для представления границ затрат. Вместе с шаблоном потребления команда Azure продолжает развивать новые и улучшенные способы отслеживания и анализа расходов на ресурсы на различных уровнях, включая возможность создания бюджетов для отдельных ресурсов и их групп.

- Бюджет группы ресурсов помогает отслеживать затраты, связанные с группой ресурсов.
- Как только будет исчерпан или превышен бюджет, можно активировать оповещения и запустить различные сборники схем.

**Подробнее:**

- Узнайте, как [управлять затратами с помощью бюджетов Azure](https://docs.microsoft.com/azure/billing/billing-cost-management-budget-scenario).
- Ознакомьтесь с руководством по [созданию бюджета Azure и управлению им](https://docs.microsoft.com/azure/cost-management-billing/costs/tutorial-acm-create-budgets).

## <a name="best-practice-optimize-azure-monitor-retention"></a>Рекомендации: Оптимизация хранения Azure Monitor

Перемещая ресурсы в Azure и включая журнал ведения диагностики для них, можно создавать большое число данных журнала. Обычно эти данные журнала отправляются в учетную запись хранения, сопоставленную с рабочей областью Log Analytics.

- Чем дольше период хранения данных журнала, тем больше данных вы получите.
- Не все данные журнала одинаковые, некоторые ресурсы будут создавать больше данных журнала, чем другие.
- Из-за законодательных норм и требований к соответствию для одних ресурсов журнал данных, возможно, понадобится хранить дольше, чем для других.
- Следует провести четкую грань между оптимизацией затрат на хранение журналов и сохранением необходимых данных журнала.
- Мы рекомендуем оценивать и настраивать ведения журнала сразу же после завершения миграции, чтобы не тратить деньги на хранение ненужных журналов.

**Подробнее:**

- Узнайте [, как отслеживать использование и оценивать затраты](https://docs.microsoft.com/azure/azure-monitor/platform/usage-estimated-costs).

## <a name="best-practice-optimize-storage"></a>Рекомендации. Оптимизация хранилища

Если вы привыкли к выбору хранилища перед переносом, вы, скорее всего, будете использовать некоторые преимущества. Но, возможно, есть дополнительные затраты на хранение, которые по-прежнему можно оптимизировать. Со временем большие двоичные объекты и файлы устаревают. Данные могут больше не использоваться, но их приходится хранить в течение определенного периода из-за нормативных требований. Тем не менее нет необходимости хранить их в высокопроизводительном хранилище, которое использовалось для начальной миграции.

Определение и перемещение устаревших данных в дешевые области хранения значительно влияет на ежемесячный бюджет для хранилища и обеспечивает экономию средств. В Azure предусмотрено множество способов для выявления и последующего хранения этих устаревших данных.

- Воспользуйтесь преимуществами уровней доступа для хранилища общего назначения версии 2, перемещая менее важные данные с горячего на холодное и архивированный уровни.
- С помощью StorSimple устаревшие данные можно перемещать на основе настраиваемых политик.

**Подробнее:**

- Дополнительные сведения о [уровнях доступа](https://docs.microsoft.com/azure/storage/blobs/storage-blob-storage-tiers).
- Ознакомьтесь с [обзором StorSimple](https://docs.microsoft.com/azure/azure-monitor/overview).
- Ознакомьтесь с [ценами на StorSimple](https://azure.microsoft.com/pricing/details/storsimple).

## <a name="best-practice-automate-vm-optimization"></a>Рекомендации: Автоматизация оптимизации виртуальной машины

Конечной целью запуска виртуальной машины в облаке является развертывание ЦП, памяти и используемого диска. Обнаружив неоптимизированные или часто простаивающие виртуальные машины, необходимо завершить их работу или уменьшить их масштаб с помощью масштабируемых наборов виртуальных машин.

Виртуальную машину можно оптимизировать с помощью службы автоматизации Azure, масштабируемых наборов виртуальных машин, автоматического завершения работы и стороннего решения или решения на основе сценариев.

**Подробнее:**

- Дополнительные сведения об [автомасштабировании по вертикали](https://docs.microsoft.com/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-vertical-scale-reprovision).
- [Запланируйте автозапуск виртуальной машины](https://azure.microsoft.com/updates/azure-devtest-labs-schedule-vm-auto-start).
- Узнайте, как [запускать или прекращать работу виртуальных машин в службе автоматизации Azure](https://docs.microsoft.com/azure/automation/automation-solution-vm-management).
- Получите дополнительные сведения о [помощнике по Azure](https://docs.microsoft.com/azure/advisor/advisor-overview)и [средстве оптимизации ресурсов Azure (АТО)](https://github.com/azure/azure-quickstart-templates/tree/master/azure-resource-optimization-toolkit).

## <a name="best-practices-use-logic-apps-and-runbooks-with-budgets-api"></a>Рекомендации: использование Logic Apps и модулей Runbook с API бюджетов

Azure предоставляет REST API с доступом к данным для выставления счетов клиента.

- API бюджетов можно использовать для интеграции внешних систем и рабочих процессов, которые активируются метриками, созданными на основе данных API.
- Вы можете извлекать данные об использовании и ресурсах в предпочтительные средства анализа данных.
- API использования ресурсов и RateCard в Azure позволяют точно прогнозировать расходы и управлять ими.
- API-интерфейсы реализуются как поставщик ресурсов и включены в интерфейсы API, предоставляемые Azure Resource Manager.
- API бюджетов можно интегрировать с Azure Logic Apps и модулями Runbook.

**Подробнее:**

- Ознакомьтесь с [API бюджетов Azure](https://docs.microsoft.com/rest/api/consumption/budgets).
- Получите ценные сведения об использовании с [API-интерфейсы выставления счетов Azure](https://docs.microsoft.com/azure/billing/billing-usage-rate-card-overview).

## <a name="best-practice-implement-serverless-technologies"></a>Рекомендации. Реализация бессерверных технологий

Чтобы избежать простоев, рабочие нагрузки виртуальных машин иногда переносят "как есть". Часто на виртуальных машинах могут размещаться прерывистые задачи с коротким или, напротив, многочасовым периодом запуска. Например, виртуальные машины, на которых запускаются запланированные задачи, в том числе скрипты Планировщика задач Windows или PowerShell. Не смотря на то, что эти задачи не выполняются, вы тратите средства на виртуальную машину и хранилище диска.

Возможно, после миграции и тщательной проверки этих типов задач стоит перенести их в среду бессерверных технологий, например в задания службы "Функции Azure" или пакетной службы Microsoft Azure. Благодаря этому решению вам больше не нужно будет управлять виртуальными машинами и обслуживать их, что позволит дополнительно сэкономить средства.

**Подробнее:**

- Узнайте о службе [Функциях Azure](https://azure.microsoft.com/services/functions).
- Узнайте о [пакетной службе Azure](https://azure.microsoft.com/services/batch).

## <a name="next-steps"></a>Дальнейшие действия

Просмотрите другие рекомендации:

- [Рекомендации по обеспечению безопасности рабочих нагрузок, перенесенных в Azure, и управлению ими](./migrate-best-practices-security-management.md).
- [Рекомендации по настройке сетей для рабочих нагрузок, перенесенных в Azure](./migrate-best-practices-networking.md).
