---
title: Рекомендации по издержек и размеру рабочих нагрузок, перенесенных в Azure
description: Используйте платформу внедрения облаков для Azure, чтобы получить рекомендации по изучению затрат и изменению размера рабочих нагрузок, перенесенных в Azure.
author: BrianBlanchard
ms.author: brblanch
ms.date: 07/01/2020
ms.topic: conceptual
ms.service: cloud-adoption-framework
ms.subservice: migrate
ms.openlocfilehash: 65bc254466009e0e5efbb458c6e4426fdad8a96b
ms.sourcegitcommit: 011525720bd9e2d9bcf03a76f371c4fc68092c45
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/18/2020
ms.locfileid: "88574709"
---
<!-- docsTest:ignore ARO -->

# <a name="best-practices-to-cost-and-size-workloads-migrated-to-azure"></a>Рекомендации по издержек и размеру рабочих нагрузок, перенесенных в Azure

Для успеха переноса в Azure в долгосрочной перспективе при планировании и проектировании миграции следует сосредоточиться на оценке затрат. На протяжении проекта миграции очень важно, чтобы все команды (финансовый отдел, руководство и команды по разработке приложений) понимали связанные с ним расходы.

- Перед миграцией важно иметь базовые показатели для месячных, ежеквартальных и ежегодных бюджетных целей, чтобы оценить сумму, потраченную на миграцию, и убедиться в ее успешности.
- После миграции необходимо оптимизировать затраты, постоянно отслеживать рабочие нагрузки и планировать будущие структуры потребления. Сначала перенесенные ресурсы могут представлять собой один тип рабочей нагрузки, но со временем (в зависимости от использования, затрат и изменения бизнес-требований) тип может меняться.

В этой статье описываются рекомендации по подготовке и управлению затратами и размером как до, так и после миграции.

> [!IMPORTANT]
> Рекомендации и мнения, описанные в этой статье, основываются на возможностях платформы Azure и служб, доступных на момент написания этого материала. Функции и возможности со временем меняются. Для вашего сценария развертывания могут применяться не все рекомендации, поэтому выберите подходящие.

## <a name="before-migration"></a>Перед миграцией

Прежде чем перенести рабочие нагрузки в облако, оцените ежемесячную стоимость их выполнения в Azure. Оперативное управление облачными расходами поможет оставаться в рамках бюджета операционных расходов. Если бюджет ограничен, примите это во внимание перед миграцией. Чтобы сократить расходы, рассмотрите возможность преобразования рабочих нагрузок в бессерверные технологии Azure там, где это уместно.

Рекомендации в этом разделе помогут вам:

- Оцените затраты.
- Выполняйте подходящее изменение размера виртуальных машин и хранилища.
- Используйте Преимущество гибридного использования Azure.
- Использование зарезервированных экземпляров виртуальных машин Azure.
- Оцените затраты на облако в рамках подписок.

## <a name="best-practice-estimate-monthly-workload-costs"></a>Рекомендации: Оценка месячных затрат на рабочую нагрузку

Чтобы спрогнозировать ваш ежемесячный счет за перенесенные рабочие нагрузки, можно использовать ряд инструментов.

<!-- TODO: Change "input costs" -->

- **Калькулятор цен Azure:** Выберите продукты, которые требуется оценить, например виртуальные машины и хранилище. Затем введите затраты в калькулятор для создания оценки.

  ![Снимок экрана калькулятора цен Azure.](./media/migrate-best-practices-costs/pricing.png)
    _Рис. 1. Калькулятор цен Azure._

- Служба **"миграция Azure":** Чтобы оценить затраты, необходимо проверить и учитывать все ресурсы, необходимые для выполнения рабочих нагрузок в Azure. Чтобы получить эти данные, необходимо провести инвентаризацию ресурсов, включая серверы, виртуальные машины, базы данных и хранилище. Для сбора этой информации можно использовать службу "Миграция Azure".

  - Служба "Миграция Azure" обнаруживает и оценивает вашу локальную среду для составления инвентарного перечня.
  - Служба "миграция Azure" может сопоставлять и отображать зависимости между виртуальными машинами, чтобы получить полную картину.
  - Оценка службы "Миграция Azure" содержит предполагаемые расходы.
    - **Затраты на вычисление:** При создании оценки рекомендуется использовать размер виртуальной машины Azure. Служба "миграция Azure" использует API-интерфейсы выставления счетов Azure для вычисления оценочных ежемесячных затрат на виртуальные машины. В ходе оценки учитывается операционная система, Software Assurance, Azure Reserved Virtual Machine Instances, время работы виртуальной машины, расположение и параметры валюты. Служба суммирует затраты на все виртуальные машины, которые оцениваются, чтобы рассчитать общие ежемесячные затраты на вычислительные ресурсы.
    - **Стоимость хранилища:** Служба "миграция Azure" вычисляет общие ежемесячные затраты на хранение, суммируя затраты на хранение всех виртуальных машин в ходе оценки. Вы можете вычислить ежемесячные затраты на хранилище определенного компьютера путем суммирования ежемесячных затрат на все подключенные к нему диски.

    ![Снимок экрана службы "миграция Azure ](./media/migrate-best-practices-costs/assess.png)
     _" рис. 2. Оценка службы "миграция Azure"._

**Дополнительные сведения:**

- Используйте [Калькулятор цен Azure](https://azure.microsoft.com/pricing/calculator).
- Ознакомьтесь с [обзором службы "миграция Azure](/azure/migrate/migrate-services-overview)".
- Узнайте об [оценках службы "Миграция Azure"](/azure/migrate/concepts-assessment-calculation).
- Дополнительные сведения о [Azure Database Migration Service](/azure/dms/dms-overview).

## <a name="best-practice-right-size-vms"></a>Рекомендации: подходящие размеры виртуальных машин

При развертывании виртуальных машин Azure для поддержки рабочих нагрузок можно выбрать несколько вариантов. Каждый тип виртуальной машины имеет свои особые возможности и различные комбинации ЦП, памяти и дисков. Виртуальные машины группируются, как показано в следующей таблице.

| Тип | Сведения | Использование |
| --- | --- | --- |
| **Общего назначения** | Сбалансированное соотношение ресурсов ЦП и памяти. | Подходит для тестирования и разработки, небольших и средних баз данных и веб-серверов с низким и средним объемом трафика. |
| **Оптимизированные по вычислительным ресурсам** | Высокое соотношение ресурсов ЦП и памяти. | Подходит для веб-сервера с объемом трафика, сетевых устройств, процессов пакетной службы и серверов приложений. |
| **Оптимизированные для памяти** | Высокое соотношение ресурсов памяти и ЦП. | Хорошо подходит для реляционных баз данных, средних и больших кэшей, а в памяти — аналитики. |
| **Оптимизированные для хранилища** | Высокая пропускная способность диска и операции ввода-вывода. | Подходит для больших данных, баз данных SQL и NoSQL. |
| **Оптимизированные для GPU** | Специализированные виртуальные машины. Один или несколько GPU. | Большие объемы графики и редактирование видео. |
| **Высокопроизводительные** | Самый быстрый и мощный ЦП. Виртуальные машины с необязательными сетевыми интерфейсами с высокой пропускной способностью (RDMA). | Критические высокопроизводительные приложения. |

- Важно понимать разницу в ценах на эти виртуальные машины, а также долгосрочные последствия для бюджета.
- Каждый тип включает в себя несколько серий виртуальных машин.
- Кроме того, когда вы выбираете в серии виртуальную машину, то можете масштабировать ее только в пределах этой серии. Например, `DS2_v2` экземпляр может масштабироваться до `DS4_v2` , но не может быть изменен на экземпляр другого ряда, например `F2s_v2` экземпляр.

**Дополнительные сведения:**

- Узнайте больше о [типах виртуальных машин и их размерах](/azure/virtual-machines/windows/sizes), а затем сопоставьте размеры с типами.
- [Размеры планов для экземпляров виртуальных машин](/azure/cloud-services/cloud-services-sizes-specs).
- Ознакомьтесь с [примерной оценкой для вымышленной компании Contoso](/azure/migrate/contoso-migration-assessment).

## <a name="best-practice-select-the-right-storage"></a>Рекомендации. Выберите нужное хранилище.

Настройка и обслуживание локального хранилища (SAN или NAS), а также сетей для его поддержки могут быть дорогостоящими и занимать много времени. Чтобы уменьшить операционные и управленческие проблемы, файловые данные (данные хранилища) обычно переносятся в облако. Корпорация Майкрософт предоставляет несколько вариантов перемещения данных в Azure, так что вам необходимо решить, какой из них использовать. Выбор правильного типа хранилища данных может экономить вашей организации несколько тысяч долларов ежемесячно. Ниже приведены некоторые рекомендации.

- Данные, к которым не обращаются много и не являются критически важными для бизнеса, не нужно размещать в наиболее дорогостоящем хранилище.
- И наоборот, критически важные для бизнеса данные должны располагаться в хранилищах более высокого уровня.
- Во время планирования миграции проведите инвентаризацию данных и классифицируйте их по важности, чтобы сопоставить их с наиболее подходящим хранилищем. Учитывайте бюджет и стоимость, а также производительность. Стоимость не обязательно должна быть основным фактором. Выбор наиболее дорогостоящего варианта может привести к снижению производительности и доступности рабочей нагрузки.

### <a name="storage-data-types"></a>Типы данных хранилища

Azure предоставляет различные типы данных хранилища.

| Тип данных | Сведения | Использование |
| --- | --- | --- |
| **BLOB-объекты** | Оптимизировано для хранения больших объемов неструктурированных объектов, таких как текстовые или двоичные данные. <br><br> | Доступ к данным отовсюду через HTTP/HTTPS. <br><br> Используется для сценариев потоковой передачи и произвольного доступа. Например, для передачи изображений и документов непосредственно в браузер, потокового видео и аудио, а также для хранения данных резервного копирования и аварийного восстановления. |
| **Файлы** | Управляемые общие файловые ресурсы, доступ к которым осуществляется через SMB 3,0. | Используется при миграции локальных общих файловых ресурсов и для обеспечения множественного доступа или подключений к данным файла. |
| **диски;** | На основе страничных BLOB-объектах. <br><br> Тип диска: Стандартный (HDD или SSD) или Premium (SSD). <br><br> Управление дисками. неуправляемый (Управление параметрами дисков и хранением) или управление ими (выберите тип диска, и Azure управляет диском). | Используйте диски уровня "Премиум" для виртуальных машин. Для простого управления и масштабирования используются управляемые диски. |
| **Очереди** | Хранение и получение большого количества сообщений, доступ к которым осуществлялся через вызовы с проверкой подлинности (HTTP или HTTPS). | Подключение компонентов приложения с помощью асинхронной очереди сообщений. |
| **Таблицы** | Хранение таблиц. | Этот тип данных является частью Azure Cosmos DB API таблиц. |

### <a name="access-tiers"></a>Уровни доступа

Служба хранилища Azure предоставляет различные возможности для доступа к данным блочного BLOB-объекта. Выбор правильного уровня доступа позволит хранить данные блочных BLOB-объектов наиболее экономичным способом.

| Уровень доступа | Сведения | Использование |
| --- | --- | --- |
| **Горячий уровень хранилища** | Более высокие затраты на хранение, чем здорово. Снижение расходов на доступ, чем у замечательных. <br><br> Это уровень по умолчанию. | Используйте для доступа к данным в активном режиме, который часто используется. |
| **Классно** | Меньше затрат на хранение, чем на горячий. Более высокие расходы на доступ, чем горячий. <br><br> Хранение не менее чем 30 дней. | Хранение краткосрочных. Данные доступны, но доступны редко. |
| **Архив** | Используется для отдельных блочных BLOB-объектов. <br><br> Наиболее экономный способ хранения. Доступ к данным дороже, чем для горячего и холодного уровней хранилищ. | Используйте для данных, которые могут допускать несколько часов задержки при получении, и останутся на уровне не менее 180 дней. |

### <a name="storage-account-types"></a>Типы учетных записей хранения

Azure предоставляет различные типы учетных записей хранения и уровней производительности.

| Тип учетной записи | Сведения | Использование |
| --- | --- | --- |
| **Универсальный стандарт общего назначения версии 2** | Поддерживает большие двоичные объекты (блокировка, страница и добавление), файлы, диски, очереди и таблицы. <br><br> Поддерживает горячий, стильный и архивный уровни доступа. Поддерживается хранилище, избыточное в виде зоны (ZRS). | Используется для большинства сценариев и типов данных. Учетные записи хранения уровня "Стандартный" могут быть основаны на жестком диске или на SSD. |
| **Универсальное назначение версии 2 Premium** | Поддерживает данные хранилища BLOB-объектов (страничные BLOB-объекты). Поддерживает горячий, стильный и архивный уровни доступа. Поддерживается ZRS. <br><br> Хранение на SSD. | Майкрософт рекомендует использовать для всех виртуальных машин. |
| **Общего назначения версии 1** | Распределение по уровням доступа не поддерживается. Не поддерживает ZRS. | Используйте, если приложениям требуется классическая модель развертывания Azure. |
| **Большой двоичный объект** | Специализированная учетная запись хранения для хранения неструктурированных объектов. Предоставляет блочные и добавочные BLOB-объекты (без служб файлов, очередей, таблиц или дисковых хранилищ). Обеспечивает ту же устойчивость, доступность, масштабируемость и производительность, что и общая цель версии 2. | Вы не можете хранить страничные BLOB-объекты в этих учетных записях, поэтому они не могут хранить файлы VHD. Можно установить уровень доступа "горячий" или "холодное". |

### <a name="storage-redundancy-options"></a>Параметры избыточности хранилища

Учетные записи хранения могут использовать различные виды избыточности для обеспечения устойчивости и высокого уровня доступности.

| Тип | Сведения | Использование |
| --- | --- | --- |
| **Локально избыточное хранилище (LRS)** | Защищает от локальных сбоев, реплицируя одну единицу хранения в отдельный домен сбоя и домен обновления. Сохраняет несколько копий данных в одном центре обработки данных. Обеспечивает устойчивость объектов не менее 99,999999999% (одиннадцать девяти) в течение определенного года. | Рассмотрите возможность хранения данных в приложении, которые можно легко воссоздать. |
| **хранилище, избыточное между зонами (ZRS);** | Предоставляет защиту от сбоя центр обработки данных, реплицируя все три кластера хранилища в одном регионе. Каждый кластер хранилища физически отделен и размещен в собственной зоне доступности. Предоставляет по меньшей мере уровне 99,9999999999% (двенадцать девяти) объектов за определенный год, сохраняя несколько копий данных в нескольких центрах обработки или регионах. | Рекомендуется, если требуется согласованность, устойчивость и высокий уровень доступности. Может не обеспечивать защиту от региональной аварии, если несколько зон постоянно затрагиваются. |
| **Геоизбыточное хранилище (GRS)** | Обеспечивает защиту от сбоя всего региона за счет репликации данных в дополнительный регион, который находится в сотнях километров от основного. Предоставляет по крайней мере 99,99999999999999% (шестнадцать девяти) устойчивости объектов за определенный год. | Данные реплики будут недоступны, пока корпорация Майкрософт не инициирует отработку отказа в дополнительном регионе. При отработке отказа чтение и запись доступны. |
| **геоизбыточное хранилище с доступом на чтение (RA-GRS).** | Как и GRS. Предоставляет по крайней мере 99,99999999999999% (шестнадцать девяти) устойчивости объектов за определенный год. | Предоставляет 99,99 процентов доступности для чтения, разрешая доступ для чтения из второго региона, используемого для GRS. |

**Дополнительные сведения:**

- Ознакомьтесь с [ценами на хранилище Azure](https://azure.microsoft.com/pricing/details/storage).
- Сведения об [импорте и экспорте Azure](/azure/storage/common/storage-import-export-service).
- Сравните [большие двоичные объекты, файлы и типы данных дискового хранилища](/azure/storage/common/storage-decide-blobs-files-disks).
- Дополнительные сведения о [уровнях доступа](/azure/storage/blobs/storage-blob-storage-tiers).
- Проверьте [различные типы учетных записей хранения](/azure/storage/common/storage-account-overview).
- Сведения о [избыточности службы хранилища Azure](/azure/storage/common/storage-redundancy), включая LRS, ZRS, GRS и GRS доступа для чтения.
- Дополнительные сведения о [службе файлов Azure](/azure/storage/files/storage-files-introduction).

## <a name="best-practice-take-advantage-of-azure-hybrid-benefit"></a>Рекомендации. Воспользуйтесь преимуществами Преимущество гибридного использования Azure

Портфель, который интегрирует локальное программное обеспечение Майкрософт с Azure, может предоставить вам конкурентные и экономичные преимущества. Если у вас есть операционная система или другое лицензирование программного обеспечения в рамках программы Software Assurance, вы можете использовать эти лицензии в облаке с Преимущество гибридного использования Azure.

**Дополнительные сведения:**

- [Взгляните](https://azure.microsoft.com/pricing/hybrid-benefit) на калькулятор преимущество гибридного использования Azure экономии.
- Дополнительные сведения о [преимущество гибридного использования Azure для Windows Server](https://azure.microsoft.com/pricing/hybrid-benefit).
- Ознакомьтесь с [руководством по ценам для SQL Server виртуальных машин Azure](/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-server-pricing-guidance).

## <a name="best-practice-use-reserved-vm-instances"></a>Рекомендации. использование зарезервированных экземпляров виртуальных машин

Большинство облачных платформ используют модель оплаты с оплатой по мере использования. Эта модель представляет недостатки, так как вам не обязательно ясно, как будут использоваться динамические рабочие нагрузки. Выражая четкие намерения в отношении рабочей нагрузки, вы принимаете участие в планировании инфраструктуры.

При использовании Azure Reserved VM Instances вы представите предоплату за один или три года для экземпляров виртуальных машин.

- Предварительная оплата обеспечивает скидку на используемые ресурсы.
- Вы можете значительно сократить затраты на виртуальные машины, вычисление базы данных SQL Azure, Azure Cosmos DB или другие ресурсы, которые сравниваются с ценами оплаты по мере использования.
- Резервирования обеспечивают скидку при выставлении счетов и не влияют на состояние среды выполнения ваших ресурсов.
- Зарезервированные экземпляры можно отменить.

![Снимок экрана сравнения с оплатой по мере использования и Преимущество гибридного использования Azure с зарезервированными экземплярами. ](./media/migrate-best-practices-costs/reserve.png)
 _Рис. 3. Azure reserved VM Instances._

**Дополнительные сведения:**

- Дополнительные сведения о [резервировании Azure](/azure/cost-management-billing/reservations/save-compute-costs-reservations).
- Прочитайте [Azure reserved VM Instances часто задаваемые вопросы](https://azure.microsoft.com/pricing/reserved-vm-instances/#faq).
- Ознакомьтесь [с руководством по ценам SQL Server на виртуальных машинах Azure](/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-server-pricing-guidance).

## <a name="best-practice-aggregate-cloud-spending-across-subscriptions"></a>Рекомендация: агрегирование облачных затрат по подпискам

В итоге, скорее всего, у вас будет несколько подписок Azure. Например, возможно, вам понадобится дополнительная подписка для разделения границ среды разработки и рабочей среды, или у вас появится платформа, которая потребует отдельную подписку для каждого клиента. Ценной функцией является возможность выполнять статистические вычисления для отчетов данных по всем подпискам в одной платформе.

Для этого можно использовать службу "Управление затратами Azure" и API-интерфейсы выставления счетов. После агрегирования данных в один источник, например Azure SQL, можно использовать такие средства, как Power BI, для отображения агрегированных данных. Вы можете создавать статистические отчеты по подписке, а также детализированные отчеты. Например, для пользователей, которым требуется упреждающее представление об управлении затратами, можно создать конкретные представления затрат на основе отдела, группы ресурсов или другой информации. При этом нет необходимости предоставлять полный доступ к данным по выставлению счетов в Azure.

**Дополнительные сведения:**

- Ознакомьтесь с [обзором интерфейсов API потребления Azure](/azure/billing/billing-consumption-api-overview).
- Узнайте, как [подключиться к Azure consumption Insights в Power BI Desktop](/power-bi/desktop-connect-azure-consumption-insights).
- Узнайте, как [управлять доступом к сведениям о выставлении счетов для Azure с помощью управления доступом на основе ролей (RBAC)](/azure/billing/billing-manage-access).

## <a name="after-migration"></a>После переноса

После успешной миграции рабочих нагрузок и нескольких недель по сбору данных о потреблении вы получите четкое представление о затратах ресурсов. При анализе данных можно приступить к созданию базового плана бюджета для ресурсов и групп ресурсов Azure. Затем, понимая структуру затрат в бюджете облака, можно проанализировать возможности для дополнительного сокращения затрат.

## <a name="best-practice-use-azure-cost-management-and-billing"></a>Рекомендации. Использование службы управления затратами Azure и выставления счетов

Корпорация Майкрософт предоставляет средства управления затратами Azure и выставления счетов, помогающие отвести расходы. Эта служба отвечает за следующие задачи:

- Помогает отслеживать и контролировать расходы в Azure и оптимизировать использование ресурсов.
- Проверяет все подписки и ресурсы и предоставляет рекомендации.
- Предоставляет полный API для интеграции внешних средств и финансовых систем для создания отчетов.
- Отслеживает использование ресурсов и помогает управлять стоимостью облака с помощью единого унифицированного представления.
- Предоставляет подробные операционные и финансово-аналитические сведения, чтобы помочь вам принять обоснованные решения.

С помощью службы "Управление затратами Azure" и выставления счетов вы можете:

- Создайте бюджет для финансовой отчетности.
  - Вы можете учитывать используемые службы или подписываться на определенный период (ежемесячно, ежеквартально или ежегодно), а также область (подписки или группы ресурсов). Например, можно создать бюджет подписки Azure на месячный, квартальный или годовой период.
    - После создания бюджета он отображается в анализе затрат. Просмотр бюджета по текущим расходам важен при анализе затрат и расходов.
  - Вы можете настроить отправку уведомлений по электронной почте при достижении пороговых значений бюджета.
  - Вы можете экспортировать данные управления затратами в службу хранилища Azure для анализа.

  ![Снимок экрана с бюджетом управления затратами. ](./media/migrate-best-practices-costs/budget.png)
   _Рис. 4. Управление затратами Azure и бюджетом выставления счетов._

- Анализ затрат для изучения и анализа затрат на организацию, помогает понять, как начисляются затраты, и выявление тенденций расходов.
  - Анализ затрат доступен для Соглашение Enterprise пользователей.
  - Вы можете просматривать данные анализа затрат для различных областей, включая отдел, учетную запись, подписку или группу ресурсов.
  - Можно получить анализ затрат, который показывает общие затраты за текущий месяц и накопленные ежедневные затраты.

  ![Снимок экрана: анализ управления затратами Azure ](./media/migrate-best-practices-costs/analysis.png)
   _рис. 5. Управление затратами Azure и анализ выставления счетов._

- Получите рекомендации Помощника, которые показывают, как можно оптимизировать и повысить эффективность.

**Дополнительные сведения:**

- Ознакомьтесь с [обзором службы управления затратами Azure и выставления счетов](/azure/cost-management-billing/cost-management-billing-overview).
- Узнайте, как [оптимизировать инвестиции в облако с помощью службы "Управление затратами Azure" и выставления счетов](/azure/cost-management-billing/costs/cost-mgt-best-practices).
- Сведения об [управлении затратами Azure и отчетах о выставлении счетов](/azure/cost-management/use-reports).
- Ознакомьтесь с [руководством по оптимизации затрат из рекомендаций](/azure/cost-management-billing/costs/tutorial-acm-opt-recommendations).
- Ознакомьтесь с [API-интерфейсами использования Azure](/rest/api/consumption/budgets).

## <a name="best-practice-monitor-resource-utilization"></a>Рекомендации: мониторинг использования ресурсов

В Azure вы платите по мере использования, когда потребляете ресурсы, и не платите, если ими не пользуетесь. Для виртуальных машин выставление счетов происходит, когда виртуальная машина выделена, а когда ее выделение отменяется, плата не взимается. Учитывая это, следует отслеживать используемые виртуальные машины и проверять размер виртуальной машины.

Постоянно оценивайте рабочие нагрузки виртуальной машины, чтобы определить базовые показатели. Например, если Рабочая нагрузка интенсивно используется с понедельника по пятницу, с 8 до 6 РМ, но вряд ли использовались за пределами этих часов, можно понизить нагрузку на виртуальные машины за пределами пикового времени. Это может приводить к изменению размеров виртуальной машины или потребовать использования масштабируемого набора виртуальных машин для автоматического масштабирования виртуальных машин. Некоторые компании отменяют виртуальные машины, помещая их в календарь, указывающий, когда они должны быть доступны, и когда они не нужны.

Вы можете отслеживать использование виртуальной машины с помощью средств Майкрософт, таких как управление затратами Azure и выставление счетов, Azure Monitor и помощник по Azure. Доступны также сторонние средства.

> [!NOTE]
> Помимо мониторинга виртуальных машин, вы должны отслеживать другие сетевые ресурсы, такие как Azure ExpressRoute и шлюзы виртуальной сети, для ундерусе и чрезмерного использования.

**Дополнительные сведения:**

- Ознакомьтесь с обзором [Azure Monitor](/azure/azure-monitor/overview) и [помощника по Azure](/azure/advisor/advisor-overview).
- [Получите рекомендации по стоимости помощника по Azure](/azure/advisor/advisor-cost-recommendations).
- Узнайте, как [оптимизировать расходы от рекомендаций](/azure/cost-management-billing/costs/tutorial-acm-opt-recommendations)и [предотвратить непредвиденные расходы](/azure/billing/billing-getting-started).
- Узнайте о [наборе средств оптимизации ресурсов Azure (АТО)](https://github.com/azure/azure-quickstart-templates/tree/master/azure-resource-optimization-toolkit).

## <a name="best-practice-implement-resource-group-budgets"></a>Рекомендации. Реализация бюджетов групп ресурсов

Часто может оказаться полезным представить границы затрат с группами ресурсов. Бюджет группы ресурсов помогает отслеживать затраты, связанные с группой ресурсов. Вы можете активировать предупреждения и запускать разнообразные модули playbookы при достижении или превышении бюджета.

**Дополнительные сведения:**

- Узнайте, как [управлять затратами с помощью бюджетов Azure](/azure/billing/billing-cost-management-budget-scenario).
- Ознакомьтесь с руководством по [созданию бюджета Azure и управлению им](/azure/cost-management-billing/costs/tutorial-acm-create-budgets).

## <a name="best-practice-optimize-azure-monitor-retention"></a>Рекомендации: Оптимизация хранения Azure Monitor

Перемещая ресурсы в Azure и включая журнал ведения диагностики для них, можно создавать большое число данных журнала. Обычно эти данные журнала отправляются в учетную запись хранения, сопоставленную с рабочей областью Log Analytics. Ниже приведены некоторые советы по оптимизации хранения Azure Monitor.

- Чем дольше период хранения данных журнала, тем больше данных вы получите.
- Не все данные журнала одинаковые, некоторые ресурсы будут создавать больше данных журнала, чем другие.
- Из-за нормативных требований и соответствия, скорее всего, потребуется хранить данные журнала для некоторых ресурсов дольше, чем для других.
- Следует провести четкую грань между оптимизацией затрат на хранение журналов и сохранением необходимых данных журнала.
- Рекомендуется оценить и настроить ведение журнала сразу же после завершения миграции, чтобы не тратить деньги на сохранность журналов без важности.

**Дополнительные сведения:**

- Узнайте [, как отслеживать использование и оценивать затраты](/azure/azure-monitor/platform/usage-estimated-costs).

## <a name="best-practice-optimize-storage"></a>Рекомендации. Оптимизация хранилища

Если вы привыкли к выбору хранилища перед переносом, вы, скорее всего, будете использовать некоторые преимущества. Но могут быть дополнительные затраты на хранение, которые по-прежнему можно оптимизировать. Со временем большие двоичные объекты и файлы устаревают. Данные могут больше не использоваться, но их приходится хранить в течение определенного периода из-за нормативных требований. Тем не менее нет необходимости хранить их в высокопроизводительном хранилище, которое использовалось для начальной миграции.

Определение и перемещение устаревших данных в дешевые области хранения значительно влияет на ежемесячный бюджет для хранилища и обеспечивает экономию средств. В Azure предусмотрено множество способов для выявления и последующего хранения этих устаревших данных.

- Воспользуйтесь преимуществами уровней доступа для хранилища общего назначения версии 2, перемещая менее важные данные с горячего на холодное и архивированный уровни.
- Используйте StorSimple для перемещения устаревших данных на основе настраиваемых политик.

**Дополнительные сведения:**

- Дополнительные сведения о [уровнях доступа](/azure/storage/blobs/storage-blob-storage-tiers).
- Ознакомьтесь с [обзором StorSimple](/azure/azure-monitor/overview).
- Ознакомьтесь с [ценами на StorSimple](https://azure.microsoft.com/pricing/details/storsimple).

## <a name="best-practice-automate-vm-optimization"></a>Рекомендации: Автоматизация оптимизации виртуальной машины

Конечной целью запуска виртуальной машины в облаке является развертывание ЦП, памяти и используемого диска. При обнаружении виртуальных машин, которые не оптимизированы или имеют частые периоды, если виртуальные машины не используются, имеет смысл завершить их работу или довнскале их с помощью масштабируемых наборов виртуальных машин.

Виртуальную машину можно оптимизировать с помощью службы автоматизации Azure, масштабируемых наборов виртуальных машин, автоматического завершения работы и стороннего решения или решения на основе сценариев.

**Дополнительные сведения:**

- Дополнительные сведения об [автомасштабировании по вертикали](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-vertical-scale-reprovision).
- [Запланируйте автозапуск виртуальной машины](https://azure.microsoft.com/updates/azure-devtest-labs-schedule-vm-auto-start).
- Узнайте, как [запускать или прекращать работу виртуальных машин в службе автоматизации Azure](/azure/automation/automation-solution-vm-management).
- Получите дополнительные сведения о [помощнике по Azure](/azure/advisor/advisor-overview)и [средстве оптимизации ресурсов Azure (АТО)](https://github.com/azure/azure-quickstart-templates/tree/master/azure-resource-optimization-toolkit).

## <a name="best-practices-use-azure-logic-apps-and-runbooks-with-budgets-api"></a>Рекомендации: использование Azure Logic Apps и модулей Runbook с API бюджетов

Azure предоставляет REST API с доступом к данным для выставления счетов клиента. API бюджетов можно использовать для интеграции внешних систем и рабочих процессов, которые активируются метриками, созданными на основе данных API. Вы можете извлекать данные об использовании и ресурсах в предпочтительные средства анализа данных. Вы можете интегрировать API бюджетов с Azure Logic Apps и модулями Runbook.

API использования ресурсов и RateCard в Azure позволяют точно прогнозировать расходы и управлять ими. API-интерфейсы реализуются как поставщик ресурсов и включены в интерфейсы API, предоставляемые Azure Resource Manager.

**Дополнительные сведения:**

- Ознакомьтесь с [API бюджетов Azure](/rest/api/consumption/budgets).
- Получите ценные сведения об использовании с [API-интерфейсы выставления счетов Azure](/azure/billing/billing-usage-rate-card-overview).

## <a name="best-practice-implement-serverless-technologies"></a>Рекомендации. Реализация бессерверных технологий

Рабочие нагрузки виртуальных машин часто переносятся "как есть", чтобы избежать простоев. Часто виртуальные машины могут размещать задачи, которые являются временными, запускаться в течение короткого периода времени или занимать много часов. К примерам относятся виртуальные машины, на которых выполняются запланированные задачи, такие как планировщик заданий Windows или сценарии PowerShell. Не смотря на то, что эти задачи не выполняются, вы тратите средства на виртуальную машину и хранилище диска.

После переноса и тщательного рассмотрения этих типов задач можно рассмотреть возможность переноса их на бессерверные технологии, такие как функции Azure или пакетные задания. Эти решения могут сократить расходы, и вам больше не нужно управлять виртуальными машинами и обслуживать их.

**Дополнительные сведения:**

- Узнайте о службе [Функциях Azure](https://azure.microsoft.com/services/functions).
- Узнайте о [пакетной службе Azure](https://azure.microsoft.com/services/batch).

## <a name="next-steps"></a>Дальнейшие действия

Просмотрите другие рекомендации:

- [Рекомендации по обеспечению безопасности рабочих нагрузок, перенесенных в Azure, и управлению ими](./migrate-best-practices-security-management.md).
- [Рекомендации по настройке сетей для рабочих нагрузок, перенесенных в Azure](./migrate-best-practices-networking.md).
