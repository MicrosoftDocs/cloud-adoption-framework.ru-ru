---
title: Повторное размещение локального приложения путем перехода на виртуальные машины Azure и Azure SQL Управляемый экземпляр
description: Узнайте, как Contoso перемещает локальное приложение на виртуальных машинах Azure с помощью Управляемый экземпляр Azure SQL.
author: givenscj
ms.author: abuck
ms.date: 07/01/2020
ms.topic: conceptual
ms.service: cloud-adoption-framework
ms.subservice: migrate
ms.custom: think-tank
ms.openlocfilehash: 5dfb82b25f4e864ee3126ac70eb5c7c23dd36065
ms.sourcegitcommit: b6f2b4f8db6c3b1157299ece1f044cff56895919
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2020
ms.locfileid: "97014323"
---
<!-- cSpell:ignore WEBVM SQLVM OSTICKETWEB OSTICKETMYSQL contosohost vcenter contosodc NSGs agentless SQLMI iisreset -->

# <a name="rehost-an-on-premises-application-by-migrating-to-azure-vms-and-azure-sql-managed-instance"></a>Повторное размещение локального приложения путем перехода на виртуальные машины Azure и Azure SQL Управляемый экземпляр

В этой статье показано, как вымышленная компания Contoso переносит двухуровневый клиентское приложение Windows .NET, работающее на виртуальных машинах VMware, на виртуальную машину Azure с помощью службы "миграция Azure". В нем также показано, как Contoso переносит базу данных приложения в Управляемый экземпляр Azure SQL.

Приложение SmartHotel360, используемое в этом примере, предоставляется в виде открытого кода. Если вы хотите использовать его в своих целях тестирования, скачайте его с сайта [GitHub](https://github.com/Microsoft/SmartHotel360).

## <a name="business-drivers"></a>Бизнес-факторы

Группа специалистов по ИТ-лидерам компании Contoso тесно работала с деловыми партнерами Организации, чтобы понять, что именно необходимо достичь в этой миграции. Они хотят:

- **Устраните бизнес-рост.** Компания Contoso растет. В результате увеличилось давление на внутренние системы и инфраструктуру компании.
- **Повышение эффективности.** Компании Contoso необходимо удалить ненужные процедуры и оптимизировать процессы для разработчиков и пользователей. Бизнесу требуется, чтобы она была быстрой и не тратой времени или денег, чтобы компания была быстрее доставляться по требованиям клиентов.
- **Повышение гибкости.** ИТ-отдел компании Contoso должен проявлять большую гибкость в отношении потребностей бизнеса. Он должен реагировать быстрее, чем изменения, происходящие в Marketplace, чтобы компания была успешной в глобальной экономике. ИТ-отдел в компании Contoso не должен мешать или становиться помехой для бизнеса.
- **Измените.** По мере роста бизнеса компании ИТ-отдел компании Contoso должен предоставлять системы, которые могут расти с той же скоростью.

## <a name="migration-goals"></a>Цели миграции

Группа, работающая над облачной инфраструктурой компании Contoso, определила цели этой миграции. Компания использует цели миграции, чтобы определить наилучший способ миграции.

- После миграции приложение в Azure должно иметь те же возможности производительности, что и приложение в локальной среде VMware для contoso. Переход в облако не означает, что производительность приложения менее важна.
- Компания Contoso не хочет вкладывать приложения в приложение. Приложение является важнейшим и важным для бизнеса, но Contoso просто хочет переместить приложение в своей текущей форме в облако.
- Задачи администрирования базы данных должны быть сведены к минимальному объему после переноса приложения.
- Contoso не хочет использовать базу данных SQL Azure для этого приложения. Она ищет альтернативные варианты.

## <a name="solution-design"></a>Архитектура решения

После фиксации целей и требований компании Contoso проектирует и изучает решение для развертывания и определяет процесс миграции. Также идентифицируются службы Azure, которые будут использоваться для миграции.

### <a name="current-architecture"></a>Текущая архитектура

- Contoso имеет один основной центр обработки данных ( `contoso-datacenter` ). Центр обработки данных находится в городе Нью-Йорк в Восточном США.
- У компании есть еще три местных филиала в других уголках США.
- Главный центр обработки данных подключен к Интернету с волоконно-оптическим подключением Metro Ethernet (500 мегабит в секунду).
- Каждый филиал подключен локально к Интернету с помощью соединений бизнес-класса и применяет VPN-туннели IPSec для передачи данных в основной центр обработки данных. Эта настройка позволяет компании Contoso обеспечивать постоянство подключения всей сети и оптимизацию подключения к Интернету.
- Основной центр обработки данных полностью виртуализирован на базе решений VMware. Компания использует два узла виртуализации ESXi 6.5 под управлением vCenter Server 6.5.
- Компания Contoso использует управление удостоверениями в Active Directory. Компания Contoso использует DNS-серверы внутренней сети.
- Contoso имеет локальный контроллер домена ( `contosodc1` ).
- Контроллеры домена работают на виртуальных машинах VMware. Контроллеры домена в местных филиалах размещены на физических серверах.
- Приложение SmartHotel360 распределяется между двумя виртуальными машинами ( `WEBVM` и `SQLVM` ), расположенными на узле VMware ESXi версии 6,5 ( `contosohost1.contoso.com` ).
- Управление средой VMware осуществляется с vCenter Server 6,5 ( `vcenter.contoso.com` ), работающей на виртуальной машине.

![Схема текущей архитектуры contoso.](./media/contoso-migration-rehost-vm-sql-managed-instance/contoso-architecture.png)

### <a name="proposed-architecture"></a>Предлагаемая архитектура

В этом сценарии компания Contoso хочет перенести свое локальное приложение командировок следующим образом:

- Перенос базы данных приложения ( `SmartHotelDB` ) в управляемый экземпляр SQL.
- Перенос внешнего интерфейса `WEBVM` в виртуальную машину Azure.
- После завершения миграции локальные виртуальные машины в центре обработки данных Contoso будут выведены из эксплуатации.

![Схема архитектуры сценария.](./media/contoso-migration-rehost-vm-sql-managed-instance/architecture.png)

### <a name="database-considerations"></a>Рекомендации по базе данных

В рамках процесса разработки решения компания Contoso выполнила сравнение функций между базой данных SQL Azure и Управляемый экземпляр SQL. Следующие соображения помогли решить, что компания решила использовать SQL Управляемый экземпляр.

- SQL Управляемый экземпляр предназначен для обеспечения совместимости почти 100% с последней локальной SQL Serverной версией. Рекомендуется использовать SQL Управляемый экземпляр для клиентов, работающих SQL Server локально или на виртуальных машинах IaaS (инфраструктура как услуга) и хотят перенести свои приложения в полностью управляемую службу с минимальными изменениями структуры.
- Компания Contoso планирует перенести большое количество приложений из локальной среды в IaaS. Многие из этих приложений предоставляются независимым поставщиком программного обеспечения. Компания Contoso осознает, что использование SQL Управляемый экземпляр обеспечит совместимость базы данных для этих приложений, вместо использования базы данных SQL, которая может не поддерживаться.
- Компания Contoso может выполнить миграцию с применением точности и сдвига в SQL Управляемый экземпляр с помощью полностью автоматизированных Azure Database Migration Service. Подготовив эту службу, Contoso сможет использовать ее при миграции баз данных в будущем.
- SQL Управляемый экземпляр поддерживает агент SQL Server, важный компонент приложения SmartHotel360. Компании Contoso требуется такая совместимость. В противном случае потребуется переконструировать планы обслуживания, необходимые для приложения.
- С помощью программы Software Assurance компания Contoso может обмениваться существующими лицензиями в соответствии со скидками на управляемый экземпляр SQL Server с использованием Преимущество гибридного использования Azure для SQL Server. По этой причине компания Contoso может сэкономить до 30% на Управляемый экземпляр SQL.
- SQL Управляемый экземпляр полностью содержится в виртуальной сети, поэтому обеспечивает более высокий уровень изоляции и безопасности данных Contoso. Компания Contoso может получить преимущества общедоступного облака, сохранив изолированную среду от общедоступной сети Интернет.
- SQL Управляемый экземпляр поддерживает множество функций безопасности. К ним относятся Always Encrypted, динамическое Маскирование данных, безопасность на уровне строк и обнаружение угроз.

### <a name="solution-review"></a>Проверка решения

Компания Contoso оценивает предлагаемую конструкцию, помещая вместе со списком достоинств и недостатков.

| Оценка | Подробнее |
| --- | --- |
| **Преимущества** | `WEBVM` будет перемещен в Azure без изменений, что делает миграцию простой. <br><br> Управляемый экземпляр SQL соответствует техническим требованиям и целям компании Contoso. <br><br> SQL Управляемый экземпляр обеспечит совместимость с текущим развертыванием Contoso в 100% при переносе компании из SQL Server 2008 R2. <br><br> Компания Contoso может воспользоваться преимуществами инвестиций в Software Assurance и использовать Преимущество гибридного использования Azure для SQL Server и Windows Server. <br><br> Contoso может повторно использовать Azure Database Migration Service для дальнейших миграций. <br><br> SQL Управляемый экземпляр имеет встроенную отказоустойчивость, которую Contoso не требуется настраивать. Эта функция гарантирует, что уровень данных больше не является единой точкой отказа. |
| **Недостатки** | `WEBVM` работает под Windows Server 2008 R2. Хотя эта операционная система поддерживается в Azure, она больше не является поддерживаемой платформой. Дополнительные сведения см. в разделе [Политика поддержки для продуктов Microsoft SQL Server](https://support.microsoft.com/help/956893). <br><br> Веб-уровень остается единственной точкой отработки отказа, `WEBVM` предоставляя только службы. <br><br> Contoso потребуется продолжить поддержку веб-уровня приложения в качестве виртуальной машины, а не переходить в управляемую службу, например службу приложений Azure. <br><br> Для уровня данных SQL Управляемый экземпляр может быть не лучшим решением, если Contoso хочет настроить операционную систему или сервер базы данных или если компании требуется запускать сторонние приложения вместе с SQL Server. Использование SQL Server на виртуальной машине IaaS может обеспечить такую гибкость. |

### <a name="migration-process"></a>Процесс миграции

Contoso перенесет веб-уровень и уровни данных своего приложения SmartHotel360 в Azure, выполнив следующие действия:

1. У компании уже есть инфраструктура Azure, поэтому ей необходимо добавить всего пару специальных компонентов Azure в свой сценарий.
1. Уровень данных будет перенесен с помощью Azure Database Migration Service. Эта служба подключается к локальной виртуальной машине SQL Server через VPN-подключение типа "сеть — сеть", установленное между центром обработки данных Contoso и Azure. Затем служба перенесет базу данных.
1. Веб-уровень будет перенесен с помощью миграции с миграцией с миграцией с помощью Azure Migration. Этот процесс подготовит локальную среду VMware, настроит и включит репликацию, а также осуществит миграцию виртуальных машин в Azure.

     ![Схема архитектуры миграции.](./media/contoso-migration-rehost-vm-sql-managed-instance/migration-architecture.png)

### <a name="azure-services"></a>Службы Azure

| Служба | Описание | Стоимость |
| --- | --- | --- |
| [Azure Database Migration Service](/azure/dms/dms-overview) | Azure Database Migration Service обеспечивает простой перенос из нескольких источников базы данных в платформы данных Azure с минимальным временем простоя. | Узнайте о [поддерживаемых регионах](/azure/dms/dms-overview#regional-availability) и [ценах на Azure Database Migration Service](https://azure.microsoft.com/pricing/details/database-migration). |
| [Управляемый экземпляр SQL Azure](/azure/sql-database/sql-database-managed-instance) | SQL Управляемый экземпляр — это управляемая служба базы данных, которая представляет собой полностью управляемый экземпляр SQL Server в облаке Azure. Он использует тот же код, что и последняя версия SQL Server ядро СУБД и содержит новейшие функции, улучшения производительности и исправления безопасности. | При использовании управляемого экземпляра SQL, работающего в Azure, взимается плата в зависимости от емкости. Дополнительные сведения о [ценах на SQL управляемый экземпляр](https://azure.microsoft.com/pricing/details/sql-database/managed). |
| [Миграция Azure](/azure/migrate/migrate-services-overview) | Contoso использует службу "миграция Azure" для оценки виртуальных машин VMware. Служба "Миграция Azure" оценивает миграционную пригодность компьютеров. Она обеспечивает оценку размера и стоимости для работы в Azure. | За использование службы "Миграция Azure" не нужно дополнительно платить. На них могут взиматься платежи в зависимости от средств (от поставщика первого или независимого программного обеспечения), которые они решили использовать для оценки и миграции. Дополнительные сведения о [ценах на миграцию Azure](https://azure.microsoft.com/pricing/details/azure-migrate). |

## <a name="prerequisites"></a>Предварительные требования

Contoso и другие пользователи должны соответствовать следующим предварительным требованиям для этого сценария.

| Требования | Сведения |
| --- | --- |
| **Подписка Azure.** | Компания Contoso уже создала подписку в первой статье этой серии. Если у вас еще нет подписки Azure, создайте [бесплатную учетную запись Azure](https://azure.microsoft.com/free). <br><br> Если вы создаете бесплатную учетную запись, вы являетесь администратором своей подписки и можете выполнять любые действия. <br><br> Если вы используете существующую подписку и вы не являетесь администратором подписки, обратитесь к администратору, чтобы назначить вам разрешения владельца или участника для необходимых групп ресурсов и ресурсов. |
| **Инфраструктура Azure** | Компания Contoso настроила свою инфраструктуру Azure, как описано в разделе [инфраструктура Azure для миграции](./contoso-migration-infrastructure.md). |
| **Локальные серверы** | Локальная vCenter Server должна работать под управлением версии 5,5, 6,0 или 6,5. <br><br> Узел ESXi должен работать под управлением версии 5,5, 6,0 или 6,5. <br><br> Одна или несколько виртуальных машин VMware должны работать на узле ESXi. |
| **Локальные виртуальные машины** | [Ознакомьтесь со списком виртуальных машин Linux](/azure/virtual-machines/linux/endorsed-distros), которые рекомендованы к использованию в Azure. |
| **Database Migration Service** | Для Azure Database Migration Service требуется [совместимое локальное VPN-устройство](/azure/vpn-gateway/vpn-gateway-about-vpn-devices). <br><br> Необходимо настроить локальное VPN-устройство. Оно должно иметь внешний общедоступный IPv4-адрес. Этот адрес не может быть за устройством преобразования сетевых адресов (NAT). <br><br> Убедитесь, что у вас есть доступ к локальной базе данных SQL Server. <br><br> Брандмауэр Windows должен иметь доступ к ядру исходной СУБД. Узнайте, как [настроить брандмауэр Windows для доступа к ядру СУБД](/sql/database-engine/configure-windows/configure-a-windows-firewall-for-database-engine-access). <br><br> Если перед вашим компьютером базы данных есть брандмауэр, добавьте правила, разрешающие доступ к базе данных и файлам через SMB-порт 445. <br><br> Учетные данные, используемые для подключения к исходному экземпляру SQL Server и целевому Управляемый экземпляр SQL, должны быть членами роли сервера sysadmin. <br><br> Вам потребуется сетевая папка в локальной базе данных, которую Azure Database Migration Service может использовать для резервного копирования базы данных-источника. <br><br> Убедитесь, что учетная запись службы, от имени которой выполняется исходный экземпляр SQL Server, имеет разрешения на запись для этой сетевой папки. <br><br> Запишите имя пользователя и пароль учетной записи Windows, которой предоставлены полные права доступа к этой сетевой папке. Azure Database Migration Service олицетворяет эти учетные данные пользователя для отправки файлов резервных копий в контейнер службы хранилища Azure. <br><br> В процессе установки SQL Server Express для протокола TCP/IP устанавливается **отключенное состояние** по умолчанию. Убедитесь, что он включен. |

## <a name="scenario-steps"></a>Шаги выполнения сценария

Настройку развертывания компания Contoso планирует осуществлять следующим образом.

> [!div class="checklist"]
>
> - **Шаг 1. Подготовка управляемого экземпляра SQL.** Компании Contoso необходим существующий управляемый экземпляр, в который будет перенесена локальная база данных SQL Server.
> - **Шаг 2. Подготовка Azure Database Migration Service.** Компании Contoso необходимо зарегистрировать поставщик миграции базы данных, создать экземпляр, а затем создать проект Database Migration Service. Contoso также должен настроить универсальный код ресурса (URI) подписанного URL-идентификатора (SAS) для экземпляра Database Migration Service. URI SAS предоставляет делегированный доступ к ресурсам в учетной записи хранения Contoso, чтобы компания Contoso могла предоставлять ограниченные разрешения для объектов хранилища. Компания Contoso настраивает универсальный код ресурса (URI) SAS, чтобы Azure Database Migration Service мог получить доступ к контейнеру учетной записи хранения, в который служба отправляет SQL Server файлы резервных копий.
> - **Шаг 3. Подготовка Azure для миграции на серверную миграцию Azure.** Contoso добавляет средство миграции сервера в проект службы "миграция Azure".
> - **Шаг 4. Подготовка локальной среды VMware для миграции в Azure: миграция сервера.** Contoso готовит учетные записи для обнаружения виртуальных машин и готовится к подключению к виртуальным машинам Azure после миграции.
> - **Шаг 5. репликация локальных виртуальных машин.** Компания Contoso настраивает репликацию и начинает репликацию виртуальных машин в службу хранилища Azure.
> - **Шаг 6. Перенос базы данных с помощью Azure Database Migration Service.** Contoso проводит миграцию базы данных.
> - **Шаг 7. Миграция виртуальных машин с помощью службы "миграция Azure": миграция сервера.** Компания Contoso выполняет тестовую миграцию, чтобы убедиться, что все работает, а затем выполняет полную миграцию, чтобы переместить виртуальную машину в Azure.

## <a name="step-1-prepare-a-sql-managed-instance"></a>Шаг 1. Подготовка управляемого экземпляра SQL

Чтобы настроить управляемый экземпляр SQL, Contoso требуется подсеть, которая соответствует следующим требованиям:

- Подсеть должна быть выделенной. Оно должно быть пустым. Она не может содержать другие облачные службы. Подсеть не должна быть подсетью шлюза.
- После создания управляемого экземпляра компания Contoso не должна добавлять ресурсы в подсеть.
- С подсетью не должна быть связана группа безопасности сети.
- Подсеть должна иметь определяемую пользователем таблицу маршрутов. Единственный назначенный маршрут должен быть `0.0.0.0/0` Интернетом следующего прыжка.
- Если для виртуальной сети указан необязательный настраиваемый DNS-сервер, виртуальный IP-адрес `168.63.129.16` для рекурсивных арбитров конфликтов в Azure должен быть добавлен в список. Узнайте, как [настроить пользовательский DNS для управляемого экземпляра SQL](/azure/sql-database/sql-database-managed-instance-custom-dns).
- С подсетью не должна быть связана конечная точка службы (служба хранилища или база данных SQL). Конечные точки службы должны быть отключены в виртуальной сети.
- Для подсети необходимо как минимум 16 IP-адресов. Узнайте, как [изменить размер подсети управляемого экземпляра](/azure/sql-database/sql-database-managed-instance-vnet-configuration).
- В гибридной среде Contoso требуются пользовательские параметры DNS. Компания Contoso настроит параметры DNS для использования одного или нескольких серверов DNS Azure компании. Дополнительные сведения о [настройке DNS](/azure/sql-database/sql-database-managed-instance-custom-dns).

### <a name="set-up-a-virtual-network-for-the-managed-instance"></a>Настройка виртуальной сети в управляемом экземпляре

Чтобы настроить виртуальную сеть, администраторы Contoso:

1. Создайте новую виртуальную сеть ( `VNET-SQLMI-EU2` ) в основном регионе ( `East US 2` ). Она добавляет виртуальную сеть в `ContosoNetworkingRG` группу ресурсов.
1. Назначьте адресное пространство `10.235.0.0/24` . Они гарантируют, что диапазон не пересекается с другими сетями в организации.
1. Добавьте две подсети в сеть:
    - `SQLMI-DS-EUS2` (`10.235.0.0/25`).
    - `SQLMI-SAW-EUS2` (`10.235.0.128/29`). Эта подсеть используется для присоединения каталога к управляемому экземпляру.

      ![Снимок экрана, на котором показан управляемый экземпляр SQL: панель "Создание виртуальной сети".](./media/contoso-migration-rehost-vm-sql-managed-instance/mi-vnet.png)

1. После развертывания виртуальной сети и подсетей они назначают сетям ранги следующим образом:

    - Пиринг `VNET-SQLMI-EUS2` с `VNET-HUB-EUS2` (виртуальная сеть концентратора в `East US 2` ).
    - Одноранговые узлы `VNET-SQLMI-EUS2` `VNET-PROD-EUS2` (Рабочая сеть).

      ![Снимок экрана, на котором показан пиринг сети.](./media/contoso-migration-rehost-vm-sql-managed-instance/mi-peering.png)

1. Задайте пользовательские параметры DNS. Служба доменных имен (DNS) сначала указывает на контроллеры домена Azure компании Contoso. Azure DNS является вторичной. Контроллеры домена Contoso Azure находятся в следующих расположениях.

    - Находится в `PROD-DC-EUS2` подсети в `East US 2` рабочей сети ( `VNET-PROD-EUS2` ).
    - `CONTOSODC3` Адрес: `10.245.42.4` .
    - `CONTOSODC4` Адрес: `10.245.42.5` .
    - Сопоставитель Azure DNS: `168.63.129.16` .

      ![Снимок экрана, на котором показаны DNS-серверы сети.](./media/contoso-migration-rehost-vm-sql-managed-instance/mi-dns.png)

**Требуется дополнительная помощь?**

- Ознакомьтесь с [обзором управляемый экземпляр SQL](/azure/sql-database/sql-database-managed-instance).
- Узнайте, как [создать виртуальную сеть для управляемого экземпляра SQL](/azure/sql-database/sql-database-managed-instance-vnet-configuration).
- См. раздел [Создание, изменение и удаление пиринга в виртуальной сети](/azure/virtual-network/virtual-network-manage-peering).
- См. раздел [Включение доменных служб Azure Active Directory](/azure/active-directory-domain-services/tutorial-create-instance).

### <a name="set-up-routing"></a>Настройка маршрутизации

Управляемый экземпляр помещается в закрытую виртуальную сеть. Компании Contoso требуется таблица маршрутов для связи между виртуальной сетью и службой управления Azure. Если виртуальная сеть не может связаться со службой, которая ею управляет, виртуальная сеть становится недоступной.

Компания Contoso принимает во внимание следующие факторы.

- Таблица маршрутов содержит набор правил (маршрутов), указывающих, как пакеты, отправляемые из управляемого экземпляра, должны маршрутизироваться в виртуальной сети.
- Таблица маршрутов связана с подсетями, в которых развернуты управляемые экземпляры. Каждый пакет, который оставляет подсеть, обрабатывается на основе связанной таблицы маршрутизации.
- Подсеть может быть связана только с одной таблицей маршрутизации.
- Никаких дополнительных затрат при создании таблицы маршрутизации в Microsoft Azure не требуется.

 Чтобы настроить маршрутизацию, администраторы Contoso выполняют следующие действия:

1. Создайте определяемую пользователем таблицу маршрутов в `ContosoNetworkingRG` группе ресурсов.

    ![Снимок экрана, на котором показана таблица маршрутов.](./media/contoso-migration-rehost-vm-sql-managed-instance/mi-route-table.png)

1. Чтобы обеспечить соответствие требованиям SQL Управляемый экземпляр, после развертывания таблицы маршрутов ( `MIRouteTable` ) они добавляют маршрут с префиксом адреса `0.0.0.0/0` . Параметр **Тип следующего прыжка** установлен как **Интернет**.

    ![Снимок экрана, на котором показан префикс таблицы маршрутов.](./media/contoso-migration-rehost-vm-sql-managed-instance/mi-route-table-prefix.png)

1. Свяжите таблицу маршрутов с `SQLMI-DB-EUS2` подсетью (в `VNET-SQLMI-EUS2` сети).

    ![Снимок экрана, на котором показана подсеть таблицы маршрутов.](./media/contoso-migration-rehost-vm-sql-managed-instance/mi-route-table-subnet.png)

**Требуется дополнительная помощь?**

Узнайте, как [настроить маршруты для управляемого экземпляра](/azure/sql-database/sql-database-managed-instance-get-started).

### <a name="create-a-managed-instance"></a>Создание управляемого экземпляра

Теперь администраторы Contoso могут подготавливать управляемый экземпляр SQL:

1. Поскольку управляемый экземпляр обслуживает бизнес-приложение, он развертывает управляемый экземпляр в основном регионе компании ( `East US 2` ). Они добавляют управляемый экземпляр в `ContosoRG` группу ресурсов.
1. Они выбирают ценовую категорию и размер вычислений и хранилище для экземпляра. Дополнительные сведения о [ценах на SQL управляемый экземпляр](https://azure.microsoft.com/pricing/details/sql-database/managed).

    ![Снимок экрана, на котором показана область SQL Управляемый экземпляр.](./media/contoso-migration-rehost-vm-sql-managed-instance/mi-create.png)

1. После развертывания управляемого экземпляра в группе ресурсов появятся два новых ресурса `ContosoRG` :

    - Новый управляемый экземпляр SQL.
    - Виртуальный кластер в случае, если Contoso имеет несколько управляемых экземпляров.

      ![Снимок экрана, на котором показаны два новых ресурса.](./media/contoso-migration-rehost-vm-sql-managed-instance/mi-resources.png)

**Требуется дополнительная помощь?**

Узнайте, как [подготавливать управляемый экземпляр](/azure/sql-database/sql-database-managed-instance-get-started).

## <a name="step-2-prepare-azure-database-migration-service"></a>Шаг 2. Подготовка Azure Database Migration Service

Чтобы подготовить Azure Database Migration Service, администраторы Contoso должны выполнить несколько действий:

- Зарегистрировать поставщик Database Migration Service в Azure.
- Предоставьте разрешение Database Migration Service доступ к службе хранилища Azure для отправки файлов резервных копий, которые используются для миграции базы данных. Чтобы предоставить доступ к службе хранилища Azure, создайте контейнер хранилища BLOB-объектов Azure. Создайте URI SAS для контейнера хранилища BLOB-объектов.
- Администраторы создают проект Azure Database Migration Service.

Выполните следующие действия.

1. Зарегистрируйте поставщик миграции базы данных в своей подписке. ![Снимок экрана, на котором показана регистрация Database Migration Service.](./media/contoso-migration-rehost-vm-sql-managed-instance/dms-subscription.png)

1. Создайте контейнер хранилища BLOB-объектов Azure. Contoso создает URI SAS, чтобы Azure Database Migration Service мог получить к нему доступ.

    ![Снимок экрана, показывающий создание URI SAS.](./media/contoso-migration-rehost-vm-sql-managed-instance/dms-sas.png)

1. Создание экземпляра Azure Database Migration Service

    ![Снимок экрана, показывающий создание экземпляра.](./media/contoso-migration-rehost-vm-sql-managed-instance/dms-instance.png)

1. Поместите Database Migration Service экземпляр в `PROD-DC-EUS2` подсеть `VNET-PROD-DC-EUS2` виртуальной сети.
    - Экземпляр размещается здесь, так как служба должна находиться в виртуальной сети, которая может обращаться к локальной SQL Server виртуальной машине через VPN-шлюз.
    - `VNET-PROD-EUS2` является одноранговым `VNET-HUB-EUS2` и может использовать удаленные шлюзы. Параметр **использовать удаленные шлюзы** гарантирует, что экземпляр может взаимодействовать должным образом.

        ![Снимок экрана, показывающий настройку сети.](./media/contoso-migration-rehost-vm-sql-managed-instance/dms-network.png)

**Требуется дополнительная помощь?**

- Узнайте, как [настроить Azure Database Migration Service](/azure/dms/quickstart-create-data-migration-service-portal).
- Узнайте, как [создать и использовать подписанный URL-адрес](/azure/storage/blobs/storage-dotnet-shared-access-signature-part-2).

## <a name="step-3-prepare-azure-for-the-azure-migrate-server-migration-tool"></a>Шаг 3. Подготовка Azure к работе с миграцией Azure: средство миграции сервера

Ниже перечислены компоненты Azure, которые необходимы для миграции виртуальных машин компании Contoso в Azure.

- Виртуальная сеть, в которой будут находиться виртуальные машины Azure при их создании во время миграции.
- Средство миграции Azure: подготовка к переходу на сервер.

Администраторы Contoso настроили эти компоненты:

1. Настройте сеть. Компания Contoso уже настроила сеть, которую можно использовать для миграции Azure: миграция сервера при [развертывании инфраструктуры Azure](./contoso-migration-infrastructure.md).

    - Приложение SmartHotel360 — это рабочее приложение, и виртуальные машины будут перенесены в рабочую сеть Azure ( `VNET-PROD-EUS2` ) в основном регионе ( `East US 2` ).
    - Обе виртуальные машины будут помещены в `ContosoRG` группу ресурсов, которая будет использоваться для рабочих ресурсов.
    - Клиентская виртуальная машина приложения ( `WEBVM` ) будет перенесена в интерфейсную подсеть ( `PROD-FE-EUS2` ) рабочей сети.
    - Виртуальная машина базы данных приложений ( `SQLVM` ) будет перенесена в подсеть базы данных ( `PROD-DB-EUS2` ) рабочей сети.

## <a name="step-4-prepare-on-premises-vmware-for-azure-migrate-server-migration"></a>Шаг 4. Подготовка локальной среды VMware для миграции в Azure: миграция сервера

Ниже перечислены компоненты Azure, которые необходимы для миграции виртуальных машин компании Contoso в Azure.

- Виртуальная сеть, в которой будут находиться виртуальные машины Azure при их создании во время миграции.
- Устройство для миграции Azure, подготовленное и настроенное.

Администраторы Contoso настроили эти компоненты, выполнив следующие действия.

1. Настройте сеть. Компания Contoso уже настроила сеть, которую можно использовать для миграции Azure: миграция сервера при [развертывании инфраструктуры Azure](./contoso-migration-infrastructure.md).

    - Приложение SmartHotel360 — это рабочее приложение, и виртуальные машины будут перенесены в рабочую сеть Azure ( `VNET-PROD-EUS2` ) в основном регионе ( `East US 2` ).
    - Обе виртуальные машины будут помещены в `ContosoRG` группу ресурсов, которая будет использоваться для рабочих ресурсов.
    - Клиентская виртуальная машина приложения ( `WEBVM` ) будет перенесена в интерфейсную подсеть ( `PROD-FE-EUS2` ) в рабочей сети.
    - Виртуальная машина базы данных приложений ( `SQLVM` ) будет перенесена в подсеть базы данных ( `PROD-DB-EUS2` ) в рабочей сети.

1. Подготавливает устройство для миграции Azure.

    1. В службе "миграция Azure" Скачайте образ OVA и импортируйте его в VMware.

        ![Снимок экрана, на котором показана загрузка файла OVA.](./media/contoso-migration-rehost-vm/migration-download-ova.png)

    1. Запустите импортированное изображение и настройте средство, выполнив следующие действия.

       1. Настройте необходимые компоненты.

          ![Снимок экрана, на котором показана настройка предварительных требований.](./media/contoso-migration-rehost-vm/migration-setup-prerequisites.png)

       1. Наведите указатель на инструмент на подписку Azure.

          ![Снимок экрана, на котором показано, как выбрать подписку](./media/contoso-migration-rehost-vm/migration-register-azure.png)

       1. Задайте учетные данные VMware vCenter.

          ![Снимок экрана, на котором показана настройка учетных данных VMware vCenter.](./media/contoso-migration-rehost-vm/migration-vcenter-server.png)

       1. Добавьте учетные данные для обнаружения на основе Linux или Windows.

          ![Снимок экрана, на котором показана настройка учетных данных Linux и Windows.](./media/contoso-migration-rehost-vm/migration-credentials.png)

1. После настройки необходимо некоторое время, чтобы средство перечислило все виртуальные машины. После завершения процесса администраторы Contoso смогут увидеть виртуальные машины, заполненные в средстве миграции Azure в Azure.

**Требуется дополнительная помощь?**

Узнайте, как настроить [устройство для миграции Azure](/azure/migrate/migrate-services-overview#azure-migrate-server-migration-tool).

### <a name="prepare-on-premises-vms"></a>Подготовка локальных виртуальных машин

После миграции компания Contoso хочет подключиться к виртуальным машинам Azure и разрешить Azure управлять виртуальными машинами. Перед миграцией администраторы Contoso должны выполнить следующие действия.

1. Для доступа через Интернет они делают следующее.

    - Включите RDP или SSH на локальной виртуальной машине перед миграцией.
    - Проверяют, добавлены ли правила TCP и UDP для профиля **Общедоступный**.
    - Убедитесь, что протокол RDP или SSH разрешен в брандмауэре операционной системы.

1. Для доступа через межсайтовый VPN они делают указанное ниже.

    - Включите RDP или SSH на локальной виртуальной машине перед миграцией.
    - Убедитесь, что протокол RDP или SSH разрешен в брандмауэре операционной системы.
    - Для Windows задайте для политики SAN операционной системы на локальной виртуальной машине значение **OnlineAll**.

1. Они устанавливают агент Azure:

    - [Агент Linux для Azure](/azure/virtual-machines/extensions/agent-linux)
    - [Агент Azure для Windows](/azure/virtual-machines/extensions/agent-windows)

1. Дополнительные рекомендации

   - Для Windows на виртуальной машине не должно быть ожидающих обновлений Windows при активации миграции. В этом случае они не смогут войти в виртуальную машину до завершения обновления.
   - После миграции они могут проверить **диагностику загрузки** , чтобы просмотреть снимок экрана виртуальной машины. Если это не поможет, убедитесь, что виртуальная машина запущена, и ознакомьтесь с [рекомендациями по устранению неполадок](https://social.technet.microsoft.com/wiki/contents/articles/31666.troubleshooting-remote-desktop-connection-after-failover-using-asr.aspx).

**Требуется дополнительная помощь?**

Узнайте, как [подготовить виртуальные машины для миграции](/azure/migrate/prepare-for-migration).

## <a name="step-5-replicate-the-on-premises-vms"></a>Шаг 5. репликация локальных виртуальных машин

Прежде чем администраторы Contoso смогут выполнить миграцию в Azure, необходимо настроить и включить репликацию.

После завершения обнаружения они могут начать репликацию виртуальных машин VMware в Azure.

1. В проекте службы "миграция Azure" они переходят на **серверы**  >  **Миграция Azure: миграция сервера**. Затем они выбирают **репликацию**.

    ![Снимок экрана, на котором показан параметр репликации.](./media/contoso-migration-rehost-vm/select-replicate.png)

1. В разделе  >  "Параметры репликации **исходных файлов**  >  "**— виртуальные машины?** они выбирают **"Да" с VMware vSphere**.

1. В **локальном устройстве** они выбирают имя настроенного устройства для миграции Azure, а затем нажмите кнопку **ОК**.

    ![Снимок экрана, на котором показана вкладка "Параметры источника".](./media/contoso-migration-rehost-vm/source-settings.png)

1. На **виртуальных машинах** они выбирают компьютеры, которые требуется реплицировать:
    - Если они выполняют оценку виртуальных машин, они могут применять рекомендации по выбору размера виртуальной машины и типа диска (Premium/Standard) в результатах оценки. В разделе **Импорт параметров миграции из оценки миграции Azure** выберите параметр **Да** .
    - Если они не выполняли оценку или не хотят использовать параметры оценки, они выбирают параметр **нет** .
    - Если выбрано использование оценки, они выбирают группу виртуальных машин и имя оценки.

    ![Снимок экрана, показывающий выбор оценок.](./media/contoso-migration-rehost-vm/select-assessment.png)

1. На **виртуальных машинах** они выполняют поиск виртуальных машин по мере необходимости и проверяют каждую ВИРТУАЛЬную машину, которую требуется перенести. Затем выберите пункт **Далее: целевые параметры**.

1. В **параметрах целевого объекта** выбираются подписка и целевой регион, в которые они будут перенесены. Они также указывают группу ресурсов, в которой будут размещаться виртуальные машины Azure после миграции. В **виртуальной сети** они выбирают виртуальную сеть или подсеть Azure, к которой будут присоединены виртуальные машины Azure после миграции.

1. В **преимущество гибридного использования Azure** они:

    - Выберите **нет** , если они не нужно применять преимущество гибридного использования Azure. Затем нажмите кнопку **Далее**.
    - Выберите **Да** , если у них есть компьютеры Windows Server, на которых включены активные программы Software Assurance или подписки Windows Server, и они хотят применить преимущества к компьютерам, которые они переносят. Затем нажмите кнопку **Далее**.

1. В области **вычислений** они просматривают имя виртуальной машины, размер, тип диска ОС и группу доступности. Виртуальные машины должны соответствовать [требованиям Azure](/azure/migrate/migrate-support-matrix-vmware#vmware-requirements).

    - **Размер виртуальной машины:** Если они используют рекомендации по оценке, раскрывающийся список размер виртуальной машины содержит рекомендуемый размер. В противном случае служба "миграция Azure" выбирает размер на основе ближайшей соответствия в подписке Azure. Кроме того, они могут выбрать размер вручную в **виртуальной машине Azure.**
    - **Диск ОС:** Они указывают диск операционной системы (загрузочный) для виртуальной машины. Диск ОС — это диск с загрузчиком операционной системы и установщиком.
    - **Группа доступности:** Если после миграции виртуальная машина должна находиться в группе доступности Azure, укажите набор. Набор должен находиться в Целевой группе ресурсов, указанной для миграции.

1. На **дисках** они указывают, следует ли реплицировать диски виртуальной машины в Azure. Затем они выбирают тип диска (стандартный SSD/HDD или управляемые диски уровня "Премиум") в Azure и нажмите кнопку **Далее**.
    - Они могут исключать диски из репликации.
    - Если диски исключены, они не будут присутствовать на виртуальной машине Azure после миграции.

1. На странице **Проверка и запуск репликации** проверьте параметры. Затем они выбирают **репликацию** , чтобы запустить начальную репликацию для серверов.

> [!NOTE]
> Параметры репликации можно обновить в любое время, прежде чем репликация начнется в **управлении**  >  **реплицируемыми компьютерами**. Настройки невозможно изменить после начала репликации.

## <a name="step-6-migrate-the-database-via-azure-database-migration-service"></a>Шаг 6. Перенос базы данных с помощью Azure Database Migration Service

Администраторам Contoso необходимо создать Database Migration Service проект, а затем перенести базу данных.

### <a name="create-an-azure-database-migration-service-project"></a>Создание проекта Azure Database Migration Service

1. Администраторы создают проект Database Migration Service. В качестве целевого объекта выбираются тип сервера источника **SQL Server** и **управляемый экземпляр SQL Azure** .

     ![Снимок экрана, на котором показана панель "новый проект миграции".](./media/contoso-migration-rehost-vm-sql-managed-instance/dms-project.png)

1. Откроется мастер миграции.

### <a name="migrate-the-database"></a>Миграция базы данных

1. В мастере миграции они указывают исходную виртуальную машину, на которой находится локальная база данных. Они вводят учетные данные для доступа к базе данных.

    ![Снимок экрана, на котором показана область сведений об источнике.](./media/contoso-migration-rehost-vm-sql-managed-instance/dms-wizard-source.png)

1. Они выбирают базу данных для миграции ( `SmartHotel.Registration` ).

    ![Снимок экрана, на котором показана панель «Выбор баз данных источника».](./media/contoso-migration-rehost-vm-sql-managed-instance/dms-wizard-source-db.png)

1. Для целевого объекта они вводят имя управляемого экземпляра в Azure и учетные данные доступа.

    ![Снимок экрана, на котором показана Целевая область сведений.](./media/contoso-migration-rehost-vm-sql-managed-instance/dms-target-details.png)

1. В **новом действии**  >  **запустить миграцию** укажите параметры для запуска миграции:
    - Источник и цель учетных данных.
    - База данных для переноса.
    - Сетевая папка, созданная на локальной виртуальной машине. Azure Database Migration Service выполняет резервное копирование исходного кода в эту общую папку.
        - Учетная запись службы, которая выполняет исходный экземпляр SQL Server, должна иметь права записи для этой общей папки.
        - Должен использоваться полный путь FQDN к общей папке.
    - URI SAS, предоставляющий Azure Database Migration Service с доступом к контейнеру учетной записи хранения, в который служба отправляет файлы резервных копий для миграции.

        ![Снимок экрана, на котором показан экран настройки параметров миграции.](./media/contoso-migration-rehost-vm-sql-managed-instance/dms-migration-settings.png)

1. Они сохраняют параметры миграции, а затем выполняют миграцию.
1. В разделе **Обзор** они отслеживают состояние миграции.

    ![Снимок экрана, на котором отображается состояние.](./media/contoso-migration-rehost-vm-sql-managed-instance/dms-monitor1.png)

1. По завершении миграции они проверяют, существуют ли целевые базы данных в управляемом экземпляре.

    ![Снимок экрана, на котором показана проверка миграции базы данных.](./media/contoso-migration-rehost-vm-sql-managed-instance/dms-monitor2.png)

## <a name="step-7-migrate-the-vms-with-azure-migrate-server-migration"></a>Шаг 7. Миграция виртуальных машин с помощью службы "миграция Azure": миграция сервера

Администраторы Contoso выполняют быструю тестовую миграцию и проверяют, что виртуальная машина работает правильно. Затем они переносят виртуальную машину.

### <a name="run-a-test-migration"></a>Выполнение тестовой миграции

1. На **серверах цели миграции**  >    >  **Миграция Azure: миграция сервера**, пользователи выбирают **тестовые перенесенные серверы**.

     ![Снимок экрана, на котором показан элемент "тестирование перенесенных серверов".](./media/contoso-migration-rehost-linux-vm/test-migrated-servers.png)

1. Выберите и удерживайте (или щелкните правой кнопкой мыши) виртуальную машину для тестирования, а затем выберите пункт **Тестовая миграция**.

    ![Снимок экрана, на котором показан элемент "Тестовая миграция".](./media/contoso-migration-rehost-linux-vm/test-migrate.png)

1. В **тестовой миграции** они выбирают виртуальную сеть Azure, в которой будет расположена виртуальная машина Azure после миграции. Рекомендуется использовать виртуальную сеть непроизводства.
1. Запустится задание **Тестовая миграция**. Они отслеживают задание в уведомлениях на портале.
1. После завершения миграции они будут просматривать перенесенную виртуальную машину Azure на **виртуальных машинах** в портал Azure. Имя машины содержит суффикс **-Test**.
1. После завершения теста он выбирает и удерживает (или правой кнопкой мыши) виртуальную машину Azure в области **репликации компьютеров** , а затем выбирает команду **очистить тестовую миграцию**.

    ![Снимок экрана, на котором показан элемент "Очистка тестовой миграции".](./media/contoso-migration-rehost-linux-vm/clean-up.png)

### <a name="migrate-the-vm"></a>Миграция виртуальной машины

Теперь администраторы Contoso выполняют полную миграцию для завершения перемещения.

1. В проекте службы "миграция Azure" они переходят в раздел **серверы**  >  **Миграция Azure: миграция сервера** и выбор **репликации серверов**.

    ![Снимок экрана, на котором показан элемент "реплицируемые серверы".](./media/contoso-migration-rehost-linux-vm/replicating-servers.png)

1. При **репликации компьютеров** они выбирают и сохраняют (или щелкают правой кнопкой мыши) виртуальную машину, а затем выбирают команду **перенести**.
1. В окне **Миграция**  >  **и завершение работы виртуальных машин и выполнение запланированной миграции без потери данных** выберите **Да**  >  **ОК**.
    - По умолчанию служба "миграция Azure" завершает работу локальной виртуальной машины и выполняет репликацию по требованию для синхронизации любых изменений виртуальной машины, произошедших с момента последней репликации. Это действие гарантирует отсутствие потери данных.
    - Если вы не хотите завершать работу виртуальной машины, выберите **нет**.
1. Запустится задание миграции виртуальной машины. Они отправляют задание в уведомлениях Azure.
1. После завершения задания они смогут просматривать виртуальную машину и управлять ею со страницы **виртуальные машины** .
1. Наконец, они обновляют записи DNS для `WEBVM` на одном из контроллеров домена contoso.

### <a name="update-the-connection-string"></a>Обновление строки подключения

На последнем этапе процесса миграции администраторы Contoso обновляют строку подключения приложения, чтобы она указывала на перенесенную базу данных, которая выполняется на управляемом экземпляре Contoso SQL.

1. В портал Azure они находят строку подключения, выбрав **Параметры**  >  **строки подключения**.

    ![Снимок экрана, показывающий параметр "строки подключения".](./media/contoso-migration-rehost-vm-sql-managed-instance/failover4.png)

1. Они обновляют строку именем пользователя и паролем управляемого экземпляра SQL.
1. После настройки строки они заменяют текущую строку подключения в `web.config` файле приложения.
1. После обновления файла и его сохранения перезапустите IIS в `WEBVM` , запустив `iisreset /restart` в окне командной строки.
1. После перезапуска IIS приложение использует базу данных, которая выполняется на управляемом экземпляре SQL.
1. На этом этапе они могут завершить работу локального компьютера SQLVM. Миграция завершена.

**Требуется дополнительная помощь?**

- Узнайте, как [выполнить тестовую отработку отказа](/azure/site-recovery/tutorial-dr-drill-azure).
- Узнайте, как [создать план восстановления](/azure/site-recovery/site-recovery-create-recovery-plans).
- См. в разделе [Отработка отказа в Site Recovery](/azure/site-recovery/site-recovery-failover).

## <a name="clean-up-after-migration"></a>Очистка после миграции

После завершения миграции приложение SmartHotel360 выполняется на виртуальной машине Azure, а база данных SmartHotel360 доступна в управляемом экземпляре SQL Azure.

Теперь компания Contoso должна выполнить следующие задачи очистки:

- Удалите `WEBVM` компьютер из vCenter Server инвентаризации.
- Удалите `SQLVM` компьютер из vCenter Server инвентаризации.
- Удаление `WEBVM` и `SQLVM` из локальных заданий резервного копирования.
- Обновите внутреннюю документацию, чтобы отобразить новое расположение и IP-адрес для `WEBVM` .
- Удалить `SQLVM` из внутренней документации. Кроме того, Contoso может изменить документацию, чтобы `SQLVM` она отображалась как удаленная и больше не направляться в инвентаризации виртуальных машин.
- Просмотреть все ресурсы, которые взаимодействуют с выведенными из эксплуатации виртуальными машинами. Обновить все соответствующие параметры или документы согласно новой конфигурации.

## <a name="review-the-deployment"></a>Проверка развертывания

Теперь, когда выполняется миграция ресурсов в Azure, компании Contoso необходимо полностью ввести в эксплуатацию и защитить свою новую инфраструктуру.

### <a name="security"></a>Безопасность

Группа безопасности Contoso рассматривает виртуальные машины Azure и управляемый экземпляр SQL, чтобы проверить наличие проблем безопасности, связанных с его реализацией:

- Участники команды проверяют группы безопасности сети, которые используются для управления доступом к виртуальной машине. Группы безопасности сети позволяют обеспечить передачу только трафика, разрешенного для приложения.
- Команда безопасности Contoso также анализирует возможность защиты данных на диске с помощью шифрования дисков Azure и Key Vault Azure.
- Группа включает обнаружение угроз на управляемом экземпляре. Обнаружение угроз передает оповещения в службу безопасности или службу поддержки Contoso для открытия билета, если обнаружена угроза. Дополнительные сведения об [обнаружении угроз для SQL управляемый экземпляр](/azure/sql-database/sql-database-managed-instance-threat-detection).

     ![Снимок экрана, на котором показан экран "безопасность SQL Управляемый экземпляр: обнаружение угроз".](./media/contoso-migration-rehost-vm-sql-managed-instance/mi-security.png)

Дополнительные сведения см. в разделе [Рекомендации по безопасности для рабочих нагрузок IaaS в Azure](/azure/security/fundamentals/iaas).

### <a name="business-continuity-and-disaster-recovery"></a>Непрерывность бизнес-процессов и аварийное восстановление

Чтобы обеспечить непрерывность бизнес-процессов и аварийное восстановление, специалисты компании Contoso выполняют указанные ниже действия.

- **Обеспечьте безопасность данных.** Contoso создает резервные копии данных на виртуальных машинах с помощью службы Azure Backup. Дополнительные сведения см. [в обзоре резервного копирования виртуальных машин Azure](/azure/backup/backup-azure-vms-introduction).
- **Обеспечьте работоспособность приложений.** Contoso реплицирует виртуальные машины приложений в Azure в дополнительный регион с помощью Site Recovery. Дополнительные сведения см. в статье [Настройка аварийного восстановления в дополнительном регионе Azure для виртуальной машины Azure](/azure/site-recovery/azure-to-azure-quickstart).
- **Подробнее.** Компания Contoso изучает дополнительные сведения об управлении Управляемый экземпляр SQL, включая [резервные копии баз данных](/azure/sql-database/sql-database-automated-backups).

### <a name="licensing-and-cost-optimization"></a>Лицензирование и оптимизация затрат

- Компания Contoso имеет существующую лицензию на WEBVM. Чтобы воспользоваться преимуществами цен предложения "Преимущества гибридного использования Azure", компания Contoso преобразует существующую виртуальную машину Azure.
- Contoso будет использовать службу [управления затратами Azure и выставления счетов](/azure/cost-management-billing/cost-management-billing-overview) , чтобы гарантировать, что компания останется в бюджете, установленном ИТ – лидером.

## <a name="conclusion"></a>Заключение

В этой статье компания Contoso повторно размещает приложение SmartHotel360 в Azure, переключая клиентскую виртуальную машину приложения в Azure с помощью службы "миграция Azure". Contoso переносит локальную базу данных в управляемый экземпляр SQL с помощью Azure Database Migration Service.
