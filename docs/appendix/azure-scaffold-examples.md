---
title: Сценарии и примеры использования системы управления подписками
titleSuffix: Microsoft Cloud Adoption Framework for Azure
description: Содержит примеры реализации управления подписками Azure для распространенных сценариев.
author: rdendtler
ms.author: rodend
ms.date: 01/03/2017
ms.topic: guide
ms.service: cloud-adoption-framework
ms.subservice: reference
ms.openlocfilehash: 92320fe24974d7e79d63751dd9afb96787e8c76d
ms.sourcegitcommit: 5846ed4d0bf1b6440f5e87bc34ef31ec8b40b338
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/11/2019
ms.locfileid: "70906122"
---
# <a name="examples-of-implementing-azure-enterprise-scaffold"></a>Примеры реализации корпоративного каркаса Azure

> [!NOTE]
> Формирование шаблонов Azure Enterprise интегрировано в платформу внедрения Microsoft Cloud. Содержимое этой статьи теперь представлено в разделе [готовности](../ready/index.md) новой платформы. Эта статья будет признана устаревшей в начале 2020. Чтобы приступить к использованию нового процесса, ознакомьтесь [с обзором готовности](../ready/index.md), [созданием первой целевой зоны](../ready/azure-readiness-guide/migration-landing-zone.md) и/или [сведениями о целевой зоне](../ready/considerations/index.md).

В этой статье приведены примеры того, как предприятие может реализовать рекомендации по созданию [корпоративного каркаса Azure](azure-scaffold.md). В нем на примере вымышленной компании Contoso приводятся рекомендации для распространенных сценариев.

## <a name="background"></a>Фоновый

Contoso — транснациональная компания, которая предоставляет клиентам решения для управления логистическими цепочками. Эти решения предоставляются на основе различных моделей (от "программы как услуги" до пакета, развертываемого локально). Эта компания разрабатывает программное обеспечение по всему миру в крупных центрах разработки, расположенных в Индии, США и Канаде.

Часть компании, занимающаяся независимыми поставщиками программного обеспечения, состоит из нескольких независимых подразделений, которые управляют продуктами в крупных компаниях. Во всех подразделениях имеются собственные разработчики, менеджеры по продуктам и архитекторы.

Бизнес-подразделение "корпоративные технологии" (ETS) обеспечивает централизованную ИНФОРМАЦИОНную способность и управляет несколькими центрами обработки данных, в которых бизнес-подразделения размещают свои приложения. Наряду с управлением центрами обработки данных ETS организация предоставляет и управляет централизованной совместной работой (например, электронной почтой и веб-сайтами), а также службами сети и телефонии. Кроме того, организация ETS управляет рабочими нагрузками клиентов в небольших подразделениях, не имеющих эксплуатационного персонала.

В этой статье используются имена, перечисленные ниже.

- Дэйв является администратором ETS Azure.
- Элис — директор по разработке в подразделении Contoso, отвечающем за логистические цепочки.

Contoso необходимо создать бизнес-приложение и приложение для клиентов. Было решено запустить приложения в Azure. Дейв считывает статью [руководства по управлению подпиской](azure-scaffold.md) и готова к реализации рекомендаций.

## <a name="scenario-1-line-of-business-application"></a>Сценарий 1. Бизнес-приложение

Contoso создает систему управления исходным кодом (BitBucket), предназначенную для разработчиков по всему миру. Приложение использует инфраструктуру как услугу (IaaS) для размещения и состоит из веб-серверов и сервера базы данных. Разработчики обращаются к серверам в своих средах разработки, но им не нужен доступ к серверам в Azure. Подразделение ETS компании Contoso хочет разрешить владельцу приложения и использующей его команде управлять приложением. Приложение доступно только в корпоративной сети Contoso. Дейву необходимо настроить подписку для этого приложения. В будущем подписка будет содержать и другое программное обеспечение, предназначенное для разработчиков.

### <a name="naming-standards-and-resource-groups"></a>Стандарты именования и группы ресурсов

Дейв создает подписку для поддержки типовых инструментов разработки, которые используются во всех подразделениях. Ему нужно создать содержательные имена для подписки и групп ресурсов (для приложения и сетей). Он создает следующие группы ресурсов и подписку.

| Элемент | Название | Описание |
| --- | --- | --- |
| Подписка |Contoso ETS DeveloperTools Production |Поддерживает типовые инструменты разработки. |
| Группа ресурсов |bitbucket-prod-rg |Содержит веб-сервер и сервер базы данных приложения. |
| Группа ресурсов |corenetworks-prod-rg |Содержит виртуальные сети и подключение шлюза типа "сеть — сеть". |

### <a name="role-based-access-control"></a>Управление доступом на основе ролей

После создания своей подписки Дэйв хочет убедиться, что у соответствующих команд и владельцев приложений имеется доступ к их ресурсам. Дейв понимает, что у всех команд разные требования. Он использует группы, которые были синхронизированы из локальной Active Directory Contoso к Azure Active Directory и предоставляет правильный уровень доступа к группам.

Дейв назначает следующие роли для подписки.

| Role | Назначено | Описание |
| --- | --- | --- |
| [Владелец](/azure/role-based-access-control/built-in-roles#owner) |Управляемый идентификатор из локальной Active Directory contoso |Этот идентификатор управляется с помощью JIT-доступа с помощью средства управления удостоверениями Contoso и обеспечивает полный аудит доступа владельца подписки. |
| [Читатель сведений о безопасности](/azure/role-based-access-control/built-in-roles#security-reader) |Отдел безопасности и управления рисками |Пользователи с этой ролью могут просматривать страницу центра безопасности Azure и состояние ресурсов. |
| [Участник сети](/azure/role-based-access-control/built-in-roles#network-contributor) |Сетевая группа |Эта роль позволяет сетевой группе компании Contoso управлять VPN-подключениями типа "сеть — сеть" и виртуальными сетями. |
| *Настраиваемая роль* |Владелец приложения |Дейв создает роль, которая дает возможность изменять ресурсы в группе ресурсов. Дополнительные сведения см. [в статье пользовательские роли в Azure RBAC](/azure/role-based-access-control/custom-roles) . |

### <a name="policies"></a>Политики

Ниже перечислены требования Дейва к управлению ресурсами в подписке.

- Так как инструменты разработки поддерживают работу разработчиков по всему миру, он не хочет лишать пользователей возможности создавать ресурсы в любом регионе. Тем не менее ему нужно знать, где создаются ресурсы.
- Дейва заботят затраты. Следовательно, он хочет предотвратить создание владельцами приложений неоправданно дорогих виртуальных машин.
- Так как это приложение обслуживает разработчиков в нескольких подразделениях, Дейв хочет добавить к каждому ресурсу теги подразделения и владельца приложения. Используя эти теги, подразделение ETS сможет выставлять счета соответствующим командам.

Он создает следующие политики с помощью [политики Azure](/azure/azure-policy/azure-policy-introduction):

| Поле | Эффект | Описание |
| --- | --- | --- |
| расположение |audit |Аудит создания ресурсов в любом регионе. |
| type |отклонить |Запрет создания виртуальных машин серии G. |
| теги |отклонить |Требование наличия тега владельца приложения. |
| теги |отклонить |Требование наличия тега места возникновения затрат. |
| теги |append |Добавление имени тега **BusinessUnit** и значения тега **ETS** ко всем ресурсам. |

### <a name="resource-tags"></a>Теги ресурсов

Дейв понимает, что ему нужны специальные сведения о счете, чтобы определить место возникновения затрат для реализации BitBucket. Кроме того, Дэйв хочет знать, какими ресурсами владеет подразделение ETS.

Он добавляет приведенные ниже [теги](/azure/azure-resource-manager/resource-group-using-tags) для групп ресурсов и ресурсов.

| Имя тега | Значение тега |
| --- | --- |
| ApplicationOwner |Имя пользователя, который управляет этим приложением. |
| Центр затрат |Расположение, связанное с возникающими затратами группы, оплачивающей потребление ресурсов Azure. |
| BusinessUnit |Подразделение **ETS** (связанное с подпиской). |

### <a name="core-network"></a>Основная сеть

Команда безопасности и управления рисками подразделения ETS Contoso проверяет предлагаемый Дейвом план перемещения приложения в Azure. Они хотят убедиться, что приложение не будет доступно через Интернет. У Дейва также есть приложения для разработчиков, которые в дальнейшем будут перенесены в Azure. Этим приложениям требуются общедоступные интерфейсы. Для соблюдения этих требований Дейв предоставляет внутренние и внешние виртуальные сети, а также группу безопасности сети для ограничения доступа.

Он создает перечисленные ниже ресурсы.

| Тип ресурса | Имя | Описание |
| --- | --- | --- |
| Виртуальная сеть |internal-vnet |Используется для приложения BitBucket и подключается к корпоративной сети Contoso через канал ExpressRoute. Подсеть (`bitbucket`) предоставляет приложению определенное пространство IP-адресов. |
| Виртуальная сеть |external-vnet |Доступна для будущих приложений, которым понадобятся общедоступные конечные точки. |
| Группа безопасности сети |bitbucket-nsg |Гарантирует, что виды атак для этой рабочей нагрузки сведены к минимуму, разрешая подключения только через порт 443 для подсети, в которой расположены приложения (`bitbucket`). |

### <a name="resource-locks"></a>Блокировки ресурсов

Дейв понимает, что подключение между корпоративной сеть Contoso и внутренней виртуальной сетью требуется защитить от любых непредсказуемых сценариев или случайного удаления.

Он создает приведенную ниже [блокировку ресурса](/azure/azure-resource-manager/resource-group-lock-resources).

| Тип блокировки | Resource | Описание |
| --- | --- | --- |
| **CanNotDelete** |internal-vnet |Запрещает пользователям удалять виртуальную сеть или подсети, но разрешает добавлять новые подсети. |

### <a name="azure-automation"></a>Служба автоматизации Azure

Дэйв не собирается что-либо автоматизировать для этого приложения. Несмотря на то, что он создал учетную запись службы автоматизации Azure, Дейв не будет сразу ее использовать.

### <a name="azure-security-center"></a>Центр безопасности Azure

ИТ-специалистам по управлению службами Contoso необходимо быстро выявлять угрозы и устранять их. Кроме того, им нужно понимать, какие проблемы могут возникнуть.

Для удовлетворения этих требований Дейв включает [Центр безопасности Azure](/azure/security-center/security-center-intro) и предоставляет доступ к роли "читатель безопасности".

## <a name="scenario-2-customer-facing-app"></a>Сценарий 2. Приложение для клиентов

Бизнес-руководство в подразделении, отвечающем за логистические цепочки, выявило различные возможности для расширения сотрудничества с клиентами компании Contoso за счет карт постоянных клиентов. Команда Алисы должна создать это приложение. И она решает, что Azure дает дополнительные возможности для удовлетворения потребностей бизнеса. Алиса работает с Дэйвом из подразделения ETS, чтобы настроить две подписки для разработки и эксплуатации этого приложения.

### <a name="azure-subscriptions"></a>Подписки Azure

Дейв входит в Azure Enterprise Portal и видит, что Отдел цепочки поставок уже существует. Однако, поскольку этот проект является первым проектом разработки для группы цепочек поставок в Azure, Дейв распознает необходимость в новой учетной записи для команды разработчиков Алисы. Он создает учетную запись R&D для команды Алисы и предоставляет ей доступ. Алиса входит на портал Azure и создает две подписки: первую — для серверов разработки, а вторую — для рабочих серверов. При создании этих подписок она следует предварительно установленным стандартам именования.

| Назначение подписки | Имя |
| --- | --- |
| Разработка |Contoso SupplyChain ResearchDevelopment LoyaltyCard Development |
| Рабочая среда |Contoso SupplyChain Operations LoyaltyCard Production |

### <a name="policies"></a>Политики

Дейв и Алиса обсуждают приложение и выясняют, что оно обслуживает только клиентов в регионе "Северная Америка". Для создания приложения Алиса и ее команда планируют использовать среду службы приложений Azure и SQL Azure. Возможно, во время разработки им понадобится создать виртуальные машины. Алиса хочет обеспечить своих разработчиков ресурсами, необходимыми для выявления и изучения проблем без привлечения сотрудников ETS.

Для **подписки разработки** они создают следующую политику.

| Поле | Эффект | Описание |
| --- | --- | --- |
| расположение |audit |Аудит создания ресурсов в любом регионе. |

Они не ограничивают тип номера SKU, который пользователь может создавать при разработке, и не требует тегов для каких-либо групп ресурсов или ресурсов.

Для **рабочей подписки** они создают политики, указанные ниже.

| Поле | Эффект | Описание |
| --- | --- | --- |
| расположение |отклонить |Запретить создание ресурсов за пределами центров обработки данных США |
| теги |отклонить |Требование наличия тега владельца приложения. |
| теги |отклонить |Требуется тег отдела. |
| теги |append |Добавление к каждой группе ресурсов тега, обозначающего рабочую среду. |

Они не ограничивают тип номера SKU, который пользователь может создать в рабочей среде.

### <a name="resource-tags"></a>Теги ресурсов

Дейв понимает, что ему необходимы определенные сведения, чтобы правильно определить бизнес-группы для выставления счетов и установления принадлежности. Для этого он определяет теги ресурсов для групп ресурсов и ресурсов.

| Имя тега | Значение тега |
| --- | --- |
| ApplicationOwner |Имя пользователя, который управляет этим приложением. |
| Отдел |Расположение, связанное с возникающими затратами группы, оплачивающей потребление ресурсов Azure. |
| EnvironmentType |**Production** (хотя в имени подписки имеется значение **Production**, добавление этого тега упрощает идентификацию при просмотре ресурсов на портале или в счете). |

### <a name="core-networks"></a>Основные сети

Команда безопасности и управления рисками подразделения ETS Contoso проверяет предлагаемый Дейвом план перемещения приложения в Azure. Ей нужно убедиться, что приложение Loyalty Card правильно изолировано и защищено в сети периметра. Для выполнения этого требования Дэйв и Алиса создают внешнюю виртуальную сеть и группу безопасности сети, чтобы изолировать приложение Loyalty Card от корпоративной сети Contoso.

Для **подписки разработки** они создают следующее.

| Тип ресурса | Имя | Описание |
| --- | --- | --- |
| Виртуальная сеть |internal-vnet |Обслуживает среду разработки Loyalty Card компании Contoso и подключается к корпоративной сети Contoso с помощью ExpressRoute. |

Для **рабочей подписки** они создают следующие ресурсы.

| Тип ресурса | Имя | Описание |
| --- | --- | --- |
| Виртуальная сеть |external-vnet |Содержит приложение Loyalty Card и не подключена напрямую к каналу ExpressRoute компании Contoso. Код передается через систему управления исходным кодом непосредственно в службы PaaS. |
| Группа безопасности сети |loyaltycard-nsg |Гарантирует, что виды атак для этой рабочей нагрузки сведены к минимуму, разрешая только входящий трафик через TCP-порт 443. Компания Contoso также изучает использование брандмауэра веб-приложения для дополнительной защиты. |

### <a name="resource-locks"></a>Блокировки ресурсов

Дейв и Алиса советуются и решают добавить блокировки для некоторых ключевых ресурсов в среде, чтобы предотвратить случайное удаление при отправке кода с ошибкой.

Они создают следующую блокировку.

| Тип блокировки | Resource | Описание |
| --- | --- | --- |
| **CanNotDelete** |external-vnet |Предотвращает удаление виртуальной сети или подсетей пользователями. Эта блокировка не предотвращает добавление новых подсетей. |

### <a name="azure-automation"></a>Служба автоматизации Azure

У Алисы и ее команды разработчиков имеется множество модулей Runbook для управления средой этого приложения. С их помощью можно добавлять или удалять узлы для приложения, а также выполнять другие задачи разработки.

Чтобы использовать эти модули Runbook, Алиса и ее команда включают [службу автоматизации](/azure/automation/automation-intro).

### <a name="azure-security-center"></a>Центр безопасности Azure

ИТ-специалистам по управлению службами Contoso необходимо быстро выявлять угрозы и устранять их. Кроме того, им нужно понимать, какие проблемы могут возникнуть.

Для удовлетворения этих требований Дэйв включает центр безопасности Azure. Он гарантирует, что центр безопасности Azure отслеживает ресурсы и предоставляет доступ к группам DevOps и безопасности.

## <a name="next-steps"></a>Следующие шаги

- Чтобы узнать о создании шаблонов Resource Manager, ознакомьтесь со статьей [Рекомендации по созданию шаблонов Azure Resource Manager](/azure/azure-resource-manager/resource-manager-template-best-practices).
