---
title: Организация групп управления и подписок
description: Группа управления и организация подписки.
author: BrianBlanchard
ms.author: brblanch
ms.date: 06/15/2020
ms.topic: conceptual
ms.service: cloud-adoption-framework
ms.subservice: ready
ms.custom: think-tank
ms.openlocfilehash: 06ff80acc1da04697fbf42ef0e50ac9768a79e94
ms.sourcegitcommit: d957bfc1fa8dc81168ce9c7d801a8dca6254c6eb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/23/2020
ms.locfileid: "95447223"
---
# <a name="management-group-and-subscription-organization"></a>Организация групп управления и подписок

![Схема: иерархия групп управления](./media/sub-org.png)

_Рис. 1. иерархия групп управления._

## <a name="define-a-management-group-hierarchy"></a>Определение иерархии групп управления

Структуры групп управления в клиенте Azure Active Directory (Azure AD) поддерживают организационное сопоставление и должны тщательно продумываться при планировании масштабного внедрения Azure в организации.

**Рекомендации по проектированию:**

- Группы управления можно использовать для объединения политик и назначений инициатив с помощью политики Azure.
- Дерево группы управления может поддерживать до [шести уровней глубины](/azure/governance/management-groups/overview#hierarchy-of-management-groups-and-subscriptions). Данное ограничение не включает корневой уровень клиента или уровень подписки.
- Любой участник (пользователь, субъект-служба) в клиенте Azure AD может создавать новые группы управления, так как авторизация RBAC для операций группы управления не включена по умолчанию.
- По умолчанию все новые подписки будут помещены в корневую группу управления.

**Рекомендации по проектированию:**

- Разстарайтесь, чтобы иерархия группы управления была достаточно простой, не более чем с трех до четырех уровней, в идеале. Это ограничение снижает затраты на управление и сложность.
- Избегайте дублирования организационной структуры в иерархию групп управления с глубокой вложенностью. Группы управления следует использовать для назначения политик и выставления счетов. Этот подход требует использования групп управления в архитектуре корпоративного уровня, которая предоставляет политики Azure для рабочих нагрузок, для которых требуется такой же тип безопасности и соответствия, что и на одном уровне группы управления.
- Создайте группы управления в группе управления корневого уровня, чтобы представить типы рабочих нагрузок (архетипа), которые будут размещены и на основе требований к безопасности, соответствию, подключению и функциональности. Такая структура группирования позволяет использовать набор политик Azure, применяемых на уровне группы управления для всех рабочих нагрузок, которым требуются одинаковые параметры безопасности, соответствия, подключения и функции.
- Используйте теги ресурсов, которые можно принудительно применять или добавлять с помощью политики Azure, для запроса и горизонтального перехода по иерархии группы управления. Затем можно сгруппировать ресурсы для нужд поиска, не используя сложную иерархию групп управления.
- Создайте "песочницу" — группу управления верхнего уровня, чтобы позволить пользователям сразу же приступить к экспериментам с Azure. Пользователи могут поэкспериментировать с ресурсами, которые могут быть еще не разрешены в рабочих средах. Песочница обеспечивает изоляцию от сред разработки, тестирования и рабочей среды.
  - Дополнительные рекомендации по использованию группы управления "песочницы" верхнего уровня см. в [руководстве по реализации](./implementation-guidelines.md#sandbox-governance-guidance).
- Используйте выделенное имя субъекта-службы для выполнения операций управления группами управления и подписками и для назначения ролей. Использование имени субъекта-службы сокращает число пользователей с повышенными правами и соответствует рекомендациям по минимальным правам доступа.
- Назначьте `User Access Administrator` роль управления доступом на основе ролей Azure (RBAC) в области корневой группы управления ( `/` ), чтобы предоставить имени участника-службы только что упомянутый доступ на корневом уровне. После предоставления имени субъекта-службы `User Access Administrator` можно безопасно удалить эту роль. Таким образом, только имя субъекта-службы является частью `User Access Administrator` роли.
- Назначьте `Contributor` разрешение для имени участника-службы, упомянутое ранее в области корневой группы управления ( `/` ), что позволяет выполнять операции на уровне клиента. Этот уровень разрешений гарантирует, что имя субъекта-службы можно использовать для развертывания ресурсов и управления ими в любой подписке в организации.
- Создайте `Platform` группу управления в корневой группе управления для поддержки общей политики платформы и назначения RBAC. Такая структура группирования гарантирует, что к подпискам, используемым в основе Azure, можно применить различные политики. Это также гарантирует, что выставление счетов за общие ресурсы централизовано в одном наборе основных подписок.
- Ограничьте число назначений политики Azure, сделанных в корневой области группы управления ( `/` ). Это ограничение сводит к минимуму отладку унаследованных политик в группах управления нижнего уровня.
- Убедитесь, что только привилегированные пользователи могут управлять группами управления в клиенте, включив авторизацию RBAC в параметрах иерархии группы управления.
- Настройте по умолчанию выделенную группу управления для новых подписок, чтобы не помещать подписки в корневую группу управления.

## <a name="subscription-organization-and-governance"></a>Организация и управление подпиской

Подписка — это единица управления, выставления счетов и масштабирования в Azure. Подписки играют важную роль при проектировании для крупномасштабного внедрения Azure. Этот раздел поможет вам определить требования к подписке и спроектировать целевые подписки на основе критических факторов. Такими факторами являются тип среды, модель владения и управления, организационная структура и портфолио приложений.

**Рекомендации по проектированию:**

- Подписки служат границами для назначения политик Azure. Например, для обеспечения соответствия защищенным рабочим нагрузкам, таким как рабочие нагрузки в индустрии платежных карт, обычно требуются дополнительные политики. Вместо использования группы управления для группирования рабочих нагрузок, требующих соответствия требованиям к работе с платежными картами, можно добиться такой же изоляции с помощью подписки. Таким образом, у вас нет слишком большого количества групп управления с небольшим количеством подписок.
- Подписки служат в качестве единицы масштабирования, чтобы рабочие нагрузки компонентов могли масштабироваться в пределах [подписки](/azure/azure-subscription-service-limits)платформы. Обязательно учитывайте ограничения ресурсов подписки при проектировании рабочих нагрузок.
- Подписки обеспечивают границы управления для системы управления и изоляции, что создает четкое разделение проблем.
- Существует ручной процесс, запланированный в будущем, который можно использовать для ограничения использования клиентом Azure AD только подписок на регистрацию Соглашение Enterprise. Этот процесс предотвращает создание сетевых подписок разработчика Microsoft Developer в области корневой группы управления.

**Рекомендации по проектированию:**

- Подписку следует рассматривать как демократичными единицу управления в соответствии с потребностями бизнеса и приоритетами.
- Сообщите владельцам подписки об их ролях и обязанностях.
  - Выполняйте проверку доступа в Azure AD Privileged Identity Management ежеквартально или два раза в год, чтобы не допустить увеличения прав по мере перемещения пользователей в организации.
  - Возьмите на себя полную ответственность за расходование бюджета и использование ресурсов.
  - Обеспечьте соблюдение политик и исправление ошибок при необходимости.
- При определении требований для новых подписок руководствуйтесь следующими принципами.
  - **Ограничения масштабирования:** Подписки служат единицей масштабирования для рабочих нагрузок компонентов, чтобы масштабироваться в пределах подписок платформы. Например, крупные специализированные рабочие нагрузки, такие как высокопроизводительные вычисления, Интернет вещей и SAP, лучше подходят для использования отдельных подписок, чтобы избежать ограничений (например, ограничение в 50 интеграций фабрики данных Azure).
  - **Граница управления:** Подписки обеспечивают разграничение управления и изоляции, что позволяет четко отделить задачи. Например, различные среды, такие как разработка, тестирование и производство, часто изолируются с точки зрения управления.
  - **Граница политики:** Подписки служат в качестве границы для назначения политик Azure. Например, для обеспечения соответствия защищенным рабочим нагрузкам, таким как рабочие нагрузки в индустрии платежных карт, обычно требуются дополнительные политики. Эти дополнительные издержки не обязательно рассматривать в целом, если используется отдельная подписка. Аналогично среды разработки могут иметь более мягкие требования к политике по сравнению с рабочими средами.
  - **Топология целевой сети:** Виртуальные сети нельзя совместно использовать в подписках, но они могут подключаться с помощью различных технологий, таких как пиринг виртуальных сетей или Azure ExpressRoute. Определите, какие рабочие нагрузки должны взаимодействовать друг с другом, когда принимаете решение о том, нужна ли новая подписка.
- Сгруппируйте подписки вместе в группы управления, согласованные в рамках структуры групп управления и требований политики в масштабе. Группирование гарантирует, что подписки с одинаковым набором политик и назначений RBAC могут наследовать их от группы управления, что позволяет избежать дублирования назначений.
- Создайте выделенную подписку на управление в `Platform` группе управления для поддержки глобальных возможностей управления, таких как Azure Monitor log Analytics рабочих областей и модулей Runbook службы автоматизации Azure.
- При необходимости установите выделенную подписку на удостоверение в `Platform` группе управления для размещения контроллеров домена Windows Server Active Directory.
- Установите выделенную подписку на подключение в `Platform` группе управления, чтобы разместить виртуальный концентратор глобальной сети Azure, службу доменных имен (DNS), цепь ExpressRoute и другие сетевые ресурсы. Выделенная подписка гарантирует, что все основные сетевые ресурсы будут тарифицироваться вместе и будут изолированы от других рабочих нагрузок.
- Старайтесь не использовать модель жесткой подписки и вместо этого выберите набор гибких критериев для группировки подписок в организации. Такая гибкость гарантирует, что по мере изменения структуры организации и состава рабочих нагрузок вы сможете создавать новые группы подписок вместо использования фиксированного набора существующих подписок. Один размер не подойдет для всех подписок. То, что работает для одного подразделения, может не работать для другого. Некоторые приложения могут сосуществовать в одной подписке целевой зоны, а для других может потребоваться собственная подписка.

## <a name="configure-subscription-quota-and-capacity"></a>Настройка квоты и емкости подписки

Каждый регион Azure содержит конечное количество ресурсов. При рассмотрении внедрения Azure в масштабе предприятия, включающего большие объемы ресурсов, обеспечьте доступность достаточной емкости и номеров SKU, а также оценку и отслеживание полученной емкости.

**Рекомендации по проектированию:**

- Используйте ограничения и квоты на платформе Azure для каждой службы, необходимой для рабочих нагрузок.
- Рассмотрим доступность требуемых номеров SKU в выбранных регионах Azure. Например, новые функции могут быть доступны только в определенных регионах. Доступность определенных номеров SKU для таких ресурсов, как виртуальные машины, может отличаться в разных регионах.
- Учтите, что квоты подписки не гарантируют емкость и применяются для каждого региона.

**Рекомендации по проектированию:**

- Используйте подписки в качестве единиц масштабирования, а также выполняйте масштабирование ресурсов и подписок по мере необходимости. В этом случае рабочая нагрузка сможет при необходимости использовать необходимые ресурсы для масштабирования, не прибегая к ограничениям подписки на платформе Azure.
- Используйте зарезервированные экземпляры для приоритизации зарезервированной емкости в требуемых регионах. В этом случае рабочая нагрузка будет иметь необходимую емкость даже при высоком спросе на этот ресурс в определенном регионе.
- Создайте панель мониторинга с настраиваемыми представлениями для наблюдения за уровнем использования емкости. Настройте оповещения для случаев, когда использование емкости приближается к критическим уровням (например, 90 процентов загрузки ЦП).
- Создавайте запросы на поддержку для увеличения квоты в рамках подготовки подписки (например, общее количество доступных ядер виртуальных машин в подписке). Этот подход гарантирует, что квоты будут установлены до того, как рабочие нагрузки превысят ограничения по умолчанию.
- Убедитесь, что необходимые службы и функции доступны в выбранных регионах развертывания.

## <a name="establish-cost-management"></a>Настройка управления затратами

Прозрачность затрат в технической сфере — важная задача управления, с которой сталкивается каждая крупная корпоративная организация. В этом разделе рассматриваются ключевые аспекты, связанные с тем, как можно достичь прозрачности затрат в крупных средах Azure.

**Рекомендации по проектированию:**

- Потенциальная потребность в моделях беспрецедентных моделей, в которых связаны общие ресурсы платформы как услуга (PaaS), например Среда службы приложений Azure и служба Azure Kubernetes, которые могут быть доступны для достижения более высокой плотности.
- Используйте график отключения для непроизводственных рабочих нагрузок, чтобы оптимизировать расходы.
- Используйте Помощник по Azure для просмотра рекомендаций по оптимизации затрат.

**Рекомендации по проектированию:**

- Использование службы "Управление затратами Azure + выставление счетов за агрегирование затрат". Сделайте ее доступной для владельцев приложений.
- Используйте теги ресурсов Azure для классификации затрат и группирования ресурсов. Использование тегов позволяет использовать механизм возвратных платежей для рабочих нагрузок, совместно использующих подписку, или для конкретной рабочей нагрузки, охватывающей несколько подписок.
