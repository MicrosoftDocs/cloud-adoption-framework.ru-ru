---
title: Организация групп управления и подписок
description: Группа управления и организация подписки.
author: BrianBlanchard
ms.author: brblanch
ms.date: 06/15/2020
ms.topic: conceptual
ms.service: cloud-adoption-framework
ms.subservice: ready
ms.openlocfilehash: bbd645b5dca778da547540d73e1cdfd293e34012
ms.sourcegitcommit: 917188fa930cadddb03f9e9bbcdd7b630e4ee33e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "88285682"
---
# <a name="management-group-and-subscription-organization"></a>Организация групп управления и подписок

![Схема, показывающая иерархию групп управления.](./media/sub-org.png)

_Рис. 1. иерархия групп управления._

## <a name="define-a-management-group-hierarchy"></a>Определение иерархии групп управления

Структуры группы управления в клиенте Azure Active Directory (Azure AD) поддерживают сопоставление организаций и должны быть тщательно учтены, когда Организация планирует переход Azure в масштабе.

**Рекомендации по проектированию:**

- Группы управления можно использовать для объединения политик и назначений инициатив с помощью политики Azure.
- Дерево группы управления может поддерживать до [шести уровней глубины](/azure/governance/management-groups/overview#hierarchy-of-management-groups-and-subscriptions). Это ограничение не включает корневой уровень клиента или уровень подписки.

**Рекомендации по проектированию:**

- Разстарайтесь, чтобы иерархия группы управления была достаточно простой, не более чем с трех до четырех уровней, в идеале. Это ограничение снижает затраты на управление и сложность.
- Избегайте дублирования организационной структуры в иерархию глубоко вложенной группы управления. Группы управления следует использовать для назначения политик и выставления счетов. Этот подход требует использования групп управления в архитектуре корпоративного уровня, которая предоставляет политики Azure для рабочих нагрузок, для которых требуется такой же тип безопасности и соответствия, что и на одном уровне группы управления.
- Создайте группы управления в группе управления корневого уровня, чтобы представить типы рабочих нагрузок (архетипа), которые будут размещены и на основе требований к безопасности, соответствию, подключению и функциональности. Эта структура группирования позволяет использовать набор политик Azure на уровне группы управления для всех рабочих нагрузок, которым требуются те же параметры безопасности, соответствия, подключения и функции.
- Используйте теги ресурсов, которые могут быть применены или добавлены с помощью политики Azure, для запроса и горизонтального перехода по иерархии группы управления. Затем можно сгруппировать ресурсы для поиска, не используя сложную иерархию групп управления.
- Создайте группу управления "песочницу" верхнего уровня, чтобы позволить пользователям немедленно экспериментировать с Azure. Пользователи могут поэкспериментировать с ресурсами, которые могут быть еще не разрешены в рабочих средах. Песочница обеспечивает изоляцию от сред разработки, тестирования и рабочей среды.
- Используйте выделенное имя участника-службы (SPN) для выполнения операций управления группами управления, операций управления подписками и назначения ролей. Использование имени участника-службы сокращает число пользователей с повышенными правами и подчиняется рекомендациям по минимальным правам доступа.
- Назначьте `User Access Administrator` роль управления доступом на основе ролей Azure (RBAC) в области корневой группы управления ( `/` ), чтобы предоставить имени участника-службы только что упомянутый доступ на корневом уровне. После предоставления имени субъекта-службы `User Access Administrator` можно безопасно удалить эту роль. Таким образом, только имя субъекта-службы является частью `User Access Administrator` роли.
- Назначьте `Contributor` разрешение для имени участника-службы, упомянутое ранее в области корневой группы управления ( `/` ), что позволяет выполнять операции на уровне клиента. Этот уровень разрешений гарантирует, что имя субъекта-службы можно использовать для развертывания ресурсов и управления ими в любой подписке в Организации.
- Создайте `Platform` группу управления в корневой группе управления для поддержки общей политики платформы и назначения RBAC. Эта структура группирования гарантирует, что к подпискам, используемым в Azure Foundation, можно применить различные политики. Это также гарантирует централизованное выставление счетов за общие ресурсы в одном наборе базовых подписок.
- Ограничьте число назначений политики Azure, сделанных в корневой области группы управления ( `/` ). Это ограничение позволяет снизить уровень отладки наследуемых политик в группах управления более низкого уровня.
- Не создавайте подписки в корневой группе управления. Эта иерархия гарантирует, что подписки не только наследуют небольшой набор политик Azure, назначенных в группе управления корневого уровня, что не представляет полный набор, необходимый для рабочей нагрузки.

## <a name="subscription-organization-and-governance"></a>Организация и управление подпиской

Подписки — это единица управления, выставления счетов и масштабирования в Azure. Они играют важную роль при проектировании для крупномасштабного внедрения Azure. Этот раздел поможет вам собрать требования к подписке и спроектировать целевые подписки на основе критических факторов. Такими факторами являются тип среды, владелец и модель управления, организационная структура и портфолио приложений.

**Рекомендации по проектированию:**

- Подписки служат границами для назначения политик Azure. Например, для обеспечения соответствия защищенным рабочим нагрузкам, таким как рабочие нагрузки в индустрии платежных карт (PCI), обычно требуются дополнительные политики. Вместо использования группы управления для группирования рабочих нагрузок, требующих соответствия требованиям PCI, можно добиться такой же изоляции с помощью подписки. Таким образом, у вас нет слишком большого количества групп управления с небольшим количеством подписок.
- Подписки служат в качестве единицы масштабирования, чтобы рабочие нагрузки компонентов могли масштабироваться в пределах [подписки](/azure/azure-subscription-service-limits)платформы. Не забудьте рассмотреть ограничения ресурсов подписки во время сеансов разработки рабочей нагрузки.
- Подписки обеспечивают разграничение управления и изоляцию, что создает четкое разделение проблем.
- Существует ручной процесс, запланированный в будущем, который можно использовать для ограничения использования клиентом Azure AD только подписок на регистрацию Соглашение Enterprise. Этот процесс предотвращает создание сетевых подписок разработчика Microsoft Developer в области корневой группы управления.

**Рекомендации по проектированию:**

- Подписку следует рассматривать как демократичными единицу управления в соответствии с потребностями бизнеса и приоритетами.
- Владельцы подписки осведомлены о своих ролях и обязанностях:
  - Выполните проверку доступа в Azure AD Privileged Identity Management квартале или два раза в год, чтобы не допустить распространения прав по мере перемещения пользователей в Организации.
  - Проведите полное владение бюджетными затратами и использованием ресурсов.
  - Обеспечение соответствия политике и исправление при необходимости.
- При определении требований для новых подписок используйте следующие принципы.
  - **Ограничения масштабирования:** Подписки служат единицей масштабирования для рабочих нагрузок компонентов, чтобы масштабироваться в пределах подписок платформы. Например, крупные специализированные рабочие нагрузки, такие как высокопроизводительные вычислительные системы, IoT и SAP, лучше подходят для использования отдельных подписок, чтобы избежать ограничений (например, ограничение 50 интеграции фабрики данных Azure).
  - **Граница управления:** Подписки обеспечивают разграничение управления и изоляции, что позволяет четко отделить задачи. Например, различные среды, такие как разработка, тестирование и производство, часто изолируются с точки зрения управления.
  - **Граница политики:** Подписки служат в качестве границы для назначения политик Azure. Например, для достижения соответствия защищенным рабочим нагрузкам, таким как PCI, обычно требуются дополнительные политики. Эти дополнительные издержки не обязательно считать целостными, если используется отдельная подписка. Аналогичным образом, среды разработки могут иметь более строгие требования к политике, связанные с рабочими средами.
  - **Топология целевой сети:** Виртуальные сети нельзя совместно использовать в подписках, но они могут подключаться с помощью различных технологий, таких как пиринг виртуальных сетей или Azure ExpressRoute. Определите, какие рабочие нагрузки должны взаимодействовать друг с другом, когда решите, нужна ли новая подписка.
- Группировка подписок в группах управления в соответствии со структурой группы управления и требованиями политики в масштабе. Группирование гарантирует, что подписки с одинаковым набором политик и назначениями RBAC могут наследовать их от группы управления, что позволяет избежать дублирования назначений.
- Создайте выделенную подписку на управление в `Platform` группе управления для поддержки глобальных возможностей управления, таких как Azure Monitor log Analytics рабочих областей и модулей Runbook службы автоматизации Azure.
- При необходимости установите выделенную подписку на удостоверение в `Platform` группе управления для размещения контроллеров домена Windows server Active Directory.
- Установите выделенную подписку на подключение в `Platform` группе управления, чтобы разместить виртуальный концентратор глобальной сети Azure, службу доменных имен (DNS), цепь ExpressRoute и другие сетевые ресурсы. Выделенная подписка гарантирует, что все основные сетевые ресурсы будут выставляться вместе и изолированы от других рабочих нагрузок.
- Старайтесь не использовать модель жесткой подписки и отказаться от набора гибких критериев для группировки подписок в Организации. Такая гибкость гарантирует, что при изменении структуры и рабочей нагрузки Организации можно создать новые группы подписок, а не использовать фиксированный набор существующих подписок. Один размер не подходит для всех подписок. То, что работает для одного подразделения, может не работать для другого. Некоторые приложения могут сосуществовать в одной подписке на целевую зону, а другие могут потребовать собственную подписку.

## <a name="configure-subscription-quota-and-capacity"></a>Настройка квоты и емкости подписки

Каждый регион Azure содержит конечное количество ресурсов. При рассмотрении технологии внедрения Azure корпоративного уровня, включающей большие объемы ресурсов, обеспечьте доступность достаточной емкости и номеров SKU, а также оцените и отслеживайте достижимую емкость.

**Рекомендации по проектированию:**

- Используйте ограничения и квоты на платформе Azure для каждой службы, требуемой рабочими нагрузками.
- Рассмотрим доступность требуемых номеров SKU в выбранных регионах Azure. Например, новые функции могут быть доступны только в определенных регионах. Доступность определенных номеров SKU для таких ресурсов, как виртуальные машины, может отличаться от одного региона к другому.
- Учтите, что квоты подписки не гарантируют емкость и применяются для каждого региона.

**Рекомендации по проектированию:**

- Используйте подписки в качестве единиц масштабирования, а также выполняйте масштабирование ресурсов и подписок по мере необходимости. После этого Рабочая нагрузка может использовать необходимые ресурсы для масштабирования, если это необходимо, не прибегая к ограничениям подписки на платформе Azure.
- Используйте зарезервированные экземпляры для определения приоритета зарезервированной емкости в обязательных регионах. После этого Рабочая нагрузка будет иметь необходимую емкость даже при высоком спросе на этот ресурс в определенном регионе.
- Создайте панель мониторинга с настраиваемыми представлениями для наблюдения за используемыми уровнями емкости. Настройте оповещения, если использование емкости приближается к критическим уровням (например, 90 процента загрузки ЦП).
- Вызывайте запросы на поддержку для увеличения квоты в рамках подготовки подписки (например, общее количество доступных ядер виртуальных машин в подписке). Этот подход гарантирует, что квоты будут установлены до того, как рабочие нагрузки занимают ограничения по умолчанию.
- Убедитесь, что необходимые службы и компоненты доступны в выбранных регионах развертывания.

## <a name="establish-cost-management"></a>Создание управления затратами

Затраты на прозрачность по техническим затратам — это критически важный вопрос управления, с которым сталкиваются каждая крупная корпоративная организация. В этом разделе рассматриваются ключевые аспекты, связанные с тем, как можно достичь прозрачности затрат в крупных средах Azure.

**Рекомендации по проектированию:**

- Потенциальная потребность в моделях беспрецедентных моделей, в которых связаны общие ресурсы платформы как услуга (PaaS), например Среда службы приложений Azure и служба Azure Kubernetes, которые могут быть доступны для достижения более высокой плотности.
- Используйте расписание завершения работы для непроизводственных рабочих нагрузок, чтобы оптимизировать затраты.
- Использование помощника по Azure для проверки рекомендаций по оптимизации затрат.

**Рекомендации по проектированию:**

- Использование службы "Управление затратами Azure" и выставления счетов за агрегирование затрат. Сделать его доступным для владельцев приложений.
- Используйте теги ресурсов Azure для классификации затрат и группирования ресурсов. Использование тегов позволяет использовать механизм для рабочих нагрузок, совместно использующих подписку, или для конкретной рабочей нагрузки, охватывающей несколько подписок.