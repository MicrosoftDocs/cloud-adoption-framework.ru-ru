---
title: Следите за затратами между филиалами и средами
description: Используйте инфраструктуру внедрения в облаке для Azure, чтобы понять, какие решения и подходы к реализации могут создавать механизмы отслеживания.
author: BrianBlanchard
ms.author: brblanch
ms.date: 09/05/2019
ms.topic: guide
ms.service: cloud-adoption-framework
ms.subservice: ready
ms.openlocfilehash: bfd8fd5d227ea0329137015a41cd9f3cb8d8c19b
ms.sourcegitcommit: 0ea426f2f471eb7310c6f09478be1306cf7bf0d8
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/05/2020
ms.locfileid: "78384032"
---
# <a name="track-costs-across-business-units-environments-or-projects"></a>Отслеживание затрат по всем бизнес-единицам, средам или проектам

[Создание рентабельной организации](../../organize/cost-conscious-organization.md) требует видимости и надлежащего определения доступа к связанным с затратами данным (или их просмотра). В этой статье, основанной на передовом методе, описываются решения и подходы к созданию механизмов отслеживания.

![Структура процесса рентабельности](../../_images/ready/cost-optimization-process.png)

## <a name="establish-a-well-managed-environment-hierarchy"></a>Создание иерархии эффективно управляемой среды

Контроль за расходами, как и система управления и другие структуры управления, во многом зависит от эффективно управляемой среды. Создание такой среды (особенно сложной) требует последовательных процессов классификации и организации всех активов.

Активы (также известные как ресурсы) включают все виртуальные машины, источники данных и приложения, развернутые в облаке. Azure предоставляет несколько механизмов для классификации и организации активов. В статье [Масштабирование с использованием нескольких подписок Azure](../azure-best-practices/scaling-subscriptions.md) подробно описываются способы организации ресурсов на основе нескольких критериев для создания эффективно управляемой среды. Эта статья посвящена применению фундаментальных концепций Azure для обеспечения видимости затрат в облаке.

### <a name="classification"></a>Классификация

*Расстановка тегов* — это простой способ классификации активов. Расстановка тегов связывает метаданные с активом. Эти метаданные можно использовать для классификации актива, основанного на различных точках данных. Когда теги используются для классификации активов как частей работы по управлению затратами, компаниям часто требуются следующие теги: "бизнес-подразделение", "отдел", "платежный код", "регион", "среда", "проект", "рабочая нагрузка" или "категоризация приложений". Управления затратами Azure может использовать эти теги для создания различных представлений данных о затратах.

Расстановка тегов является основным способом распознавания данных в любой отчетности по затратам. Это фундаментальная часть любой эффективно управляемой среды. А также первый шаг на пути к созданию надлежащего управления любой окружающей средой.

Первым шагом в точном отслеживании информации о затратах по всем бизнес-единицам, средам и проектам является определение стандарта расстановки тегов. Вторым шагом является обеспечение последовательного применения стандарта расстановки тегов. Следующие статьи помогут выполнить каждый из этих шагов:

- [Разработка стандартов именования и расстановки тегов ](../azure-best-practices/naming-and-tagging.md)
- [Установка приложения MVP для обеспечения соблюдения стандартов расстановки тегов](../../govern/guides/complex/index.md)

### <a name="resource-organization"></a>Организация ресурсов

Существует несколько подходов к упорядочению активов. Данный раздел описывает лучшую методику, основанную на потребностях крупного предприятия со структурой затрат, распределенной по бизнес-единицам, регионам и IТ-организациям. Аналогичная рекомендация для небольших и менее сложных организаций доступна в [стандартном руководству по корпоративному управлению](../../govern/guides/standard/index.md).

Для крупного предприятия с помощью следующей модели для групп управления, подписок и ресурсных групп можно создать иерархию, которая позволит каждой команде иметь надлежащий уровень видимости для выполнения своих обязанностей. Когда предприятие нуждается в контроле над затратами для предотвращения перерасхода бюджета, оно может применить инструменты управления, такие как Azure Blueprints или политику Azure к подпискам в рамках этой структуры, чтобы быстро блокировать будущие ошибочные затраты.

![Диаграмма организации ресурсов для крупного предприятия](../../_images/govern/large-enterprise-resource-organization.png)

На предыдущей диаграмме корень иерархии группы управления содержит узел для каждой бизнес-единицы. В данном примере многонациональной компании необходима видимость в региональных бизнес-единицах, поэтому она создает географический узел для каждой бизнес-единицы в иерархии.

В пределах каждого географического региона существует отдельный узел для производственных и непроизводственных сред, чтобы изолировать контроли затрат, доступа и управления. Чтобы обеспечить более эффективные операции и более разумные инвестиции, компания использует подписки для дальнейшей изоляции производственных сред с различной степенью обязательств по операционной эффективности. Наконец, компания использует группы ресурсов для захвата развертываемых единиц функции, называемых приложениями.

На диаграмме показаны рекомендации, но не указаны эти варианты:

- Многие компании ограничивают операции одним геополитическим регионом. Такой подход уменьшает потребность в диверсификации дисциплин системы управления или данных о расходах на основе суверенных требований локальных данных. В таких случаях географический узел не требуется.
- Некоторые компании предпочитают дальнейшее разделение разработки, тестирование и среды контроля качества в отдельных подписках.
- Когда компания объединяет команду Cloud Center of Excellence (CCoE), подписки на общие службы в каждом географическом узле могут сократить дублирующиеся активы.
- Меньшие трудозатраты на внедрение могут иметь гораздо меньшую иерархию управления. Широко распространенным является наличие одного корневого узла в корпоративных IТ — организациях с одинарным уровнем подчиненных узлов в иерархии для различных сред. Это не является нарушением рекомендаций для эффективно управляемой среды. Однако это все же затрудняет создание модели с минимальными правами на доступ к контролю над затратами и выполнению других важных функций.

Остальная часть этой статьи предполагает использование подхода, основанного на рекомендациях, представленных на предыдущей схеме. Однако, следующие статьи могут помочь вам применить подход к организации ресурсов, который лучше всего подходит вашей компании.

- [Масштабирование с использованием нескольких подписок Azure](../azure-best-practices/scaling-subscriptions.md)
- [Развертывание программы Концепция MVP для управления стандартами эффективно управляемой среды](../../govern/guides/complex/index.md)

## <a name="provide-the-right-level-of-cost-access"></a>Предоставление правильного уровня доступа к затратам

Управление затратами является командной работой. Раздел "Готовность организации" в Cloud Adoption Framework определяет небольшое количество основных команд и описывает, как эти команды поддерживают трудозатраты по внедрению облачных технологий. Эта статья подробно описывает определения команд, чтобы определить объем и роли, которые необходимо назначить членам каждой команды для надлежащего уровня видимости данных по управлению затратами.

- *Роли* определяют, что пользователь может делать с различными ресурсами.
- *Область* определяет, с какими ресурсами (пользователь, группа, субъект-служба или управляемое удостоверение) пользователь может это сделать.

Ка правило, мы рекомендуем использовать модель с минимальными правами доступа при присвоении людям различных ролей и областей.

### <a name="roles"></a>Роли

Управление затратами Azure поддерживает следующие встроенные роли для каждой области применения.

- [Владелец](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#owner). Может просматривать затраты и управлять всем, включая конфигурацию затрат.
- [Участник](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#contributor). Может просматривать затраты и управлять всем, включая конфигурацию затрат, но не контролем доступа.
- [Читатель](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#reader). Может просматривать все, включая данные о затратах и конфигурации, но не может вносить никаких изменений.
- [Участник управления затратами](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#cost-management-contributor). Может просматривать затраты и управлять конфигурацией затрат.
- [Читатель управления затратами](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#cost-management-reader) может просматривать данные о затратах и конфигурации.

В соответствии с рекомендацией, членам всех групп должна быть назначена роль "Участник управления затратами". Эта роль предоставляет доступ к созданию бюджетов, управлению ними, а также их экспорта для более эффективного отслеживания затрат, а также их отчетности. Однако членам [команды по разработке стратегии облачных технологий](../../organize/cloud-strategy.md) следует назначить роль "Читатель управления затратами". Поскольку они не участвуют в составлении бюджетов в рамках инструмента Управление затратами Azure.

### <a name="scope"></a>Область видимости

Следующие настройки области и ролей создадут необходимую видимость в управлении затратами. Эта лучшая методика может потребовать незначительных изменений для соответствия с решениями об организации активов.

- [Команда по внедрению облачных технологий](../../organize/cloud-adoption.md). Ответственность за текущие изменения оптимизации требует доступа с ролью "Участник управления затратами" на уровне группы ресурсов.

  - **Среда выполнения**. Как минимум, команда по внедрению облачных технологий должна иметь доступ [Участник](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#contributor) ко всем затронутым группам ресурсов или, по крайней мере, к группам, связанным с разработкой/тестированием или текущей деятельностью по развертыванию. Дополнительная настройка области не требуется.
  - **Производственная среда**. Когда будет установлено надлежащее разделение ответственности, группа по внедрению облачных технологий, вероятно, больше не будет иметь доступ к группам ресурсов, связанным с ее проектами. Группам ресурсов, которые поддерживают производственные экземпляры своих рабочих нагрузок, понадобится дополнительная область, чтобы дать этой команде видимость влияния ее решений на производственные затраты. Установка параметра области [Участник управления затратами](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#cost-management-contributor) для групп производственных ресурсов этой команды позволит команде отслеживать затраты и составлять бюджеты на основе использования и текущих инвестиций в поддерживаемые рабочие нагрузки.

- [Команда по вопросам облачной стратегии](../../organize/cloud-strategy.md). Обязанности по отслеживанию затрат по нескольким проектам и бизнес-единицам требуют доступа с ролью "Читатель управления затратами" на корневом уровне иерархии групп управления.

  - Назначьте доступ [Читатель управления затратами](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#cost-management-reader) этой команде в группе управления. Это обеспечит постоянную видимость всех развертываний, связанных с планами, регулируемыми иерархией этих групп управления.

- [Команда управления облачными технологиями](../../organize/cloud-governance.md). Ответственность за управление затратами, согласование бюджета и отчетность в рамках всех работ по внедрению требует доступа с ролью "Участник оптимизации управления затратами" на корневом уровне иерархии группы управления.

  - В эффективно управляемой среде команда по управлению облачными технологиями, вероятно, уже имеет более высокий уровень доступа, что делает ненужным дополнительное распределение задач для [Участника управления затратами](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#cost-management-contributor).

- [Cloud Center of Excellence](../../organize/cloud-center-of-excellence.md). Ответственность за управление затратами, связанными с общими службами, требует доступа с ролью "Участник управления затратами" на уровне подписки. Также, этой группе может потребоваться доступ с ролью "Участник управления затратами" к группам ресурсов или подпискам, содержащим активы, развернутые инструментами автоматизации CCoE, чтобы распознавать, как эти инструменты влияют на затраты.

  - **Общие службы**. При использовании облачного центра, рекомендуемый подход, предполагает, что активы, управляемые Ккое, поддерживаются из централизованной подписки на общую службу в центральном и периферийном моделях. В данном сценарии CCoE, вероятно, имеет к этой подписке доступ "Участник" или "Владелец", что делает дополнительное назначение для области роли [Участник управления затратами](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#cost-management-contributor) ненужным.
  - **CCoE автоматизация/элементы управления**. CCoE обычно предоставляет элементы управления и сценарии автоматизированного развертывания командам внедрения облачных технологий. CCoE несет ответственность за распознавание влияния этих ускорителей на затраты. Чтобы получить такую видимость, команде нужен доступ [Участник управления затратами](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#cost-management-contributor) к любым группам ресурсов или подпискам, на которых запущены эти ускорители.

- **Команда по операциям в облаке**. Ответственность за управление текущими затратами на производственную среду требует доступа "Участник управления затратами" ко всем производственным подпискам.

  - Общая рекомендация помещает производственные и непроизводственные активы в отдельные подписки, управляемые узлами иерархии групп управления, связанной с рабочими средами. В эффективно управляемой среде члены команды по операциям, вероятно, уже имеют доступ "Владелец" или "Участник" к производственным подпискам, что делает роль [Участник управления затратами](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#cost-management-contributor) ненужной.

## <a name="additional-cost-management-resources"></a>Дополнительные ресурсы для управления затратами

Управление затратами Azure — хорошо задокументированный инструмент для составления бюджетов и получения видимости о затратах на облако для Azure или AWS. После того, как вы установите доступ к эффективно управляемой иерархии среды, следующие статьи помогут вам использовать этот инструмент, чтобы отслеживать и контролировать затраты.

### <a name="get-started-with-azure-cost-management"></a>Приступая к работе со службой "Управление затратами Azure"

Дополнительные сведения о работе с Azure Cost Management см. [Как оптимизировать инвестиции в облако с помощью службы "Управление затратами Azure"](https://docs.microsoft.com/azure/cost-management/cost-mgt-best-practices?toc=https://docs.microsoft.com/azure/cloud-adoption-framework/toc.json&bc=https://docs.microsoft.com/azure/cloud-adoption-framework/_bread/toc.json).

### <a name="use-azure-cost-management"></a>Использование службы "Управление затратами Azure"

- [Создание бюджетов и управление ими](https://docs.microsoft.com/azure/cost-management/tutorial-acm-create-budgets)
- [Экспорт данных о затратах](https://docs.microsoft.com/azure/cost-management/tutorial-export-acm-data)
- [Оптимизация затрат на основе рекомендаций](https://docs.microsoft.com/azure/cost-management/tutorial-acm-opt-recommendations)
- [Использование оповещения о затратах для отслеживания потребления и расходов](https://docs.microsoft.com/azure/cost-management/cost-mgt-alerts-monitor-usage-spending)

### <a name="use-azure-cost-management-to-govern-aws-costs"></a>Использование службы "Управление затратами Azure" для управления затратами AWS

- [Интеграция отчетов AWS о затратах и потреблении](https://docs.microsoft.com/azure/cost-management-billing/costs/aws-integration-set-up-configure)
- [Управление затратами AWS](https://docs.microsoft.com/azure/cost-management/aws-integration-manage)

### <a name="establish-access-roles-and-scope"></a>Установка доступа, ролей и областей

- [Сведения об области управления затратами](https://docs.microsoft.com/azure/cost-management/understand-work-scopes)
- [Настройка области для группы ресурсов](https://docs.microsoft.com/azure/role-based-access-control/quickstart-assign-role-user-portal)
