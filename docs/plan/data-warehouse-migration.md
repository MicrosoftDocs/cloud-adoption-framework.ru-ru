---
title: Планирование переноса хранилища данных
description: Узнайте о рекомендациях по переносу хранилища данных, выполнении основных шагов по переносу хранилища данных и задачам на каждом шаге.
author: v-hanki
ms.author: janet
ms.date: 06/24/2020
ms.topic: conceptual
ms.service: cloud-adoption-framework
ms.subservice: plan
ms.openlocfilehash: 4a0d6d857481b3c3bbd73d44a81ff5fe72e4a3fd
ms.sourcegitcommit: a7eb2f6c4465527cca2d479edbfc9d93d1e44bf1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/17/2020
ms.locfileid: "94712091"
---
<!-- cSpell:ignore Informatica gzipped Attunity -->

# <a name="plan-a-data-warehouse-migration"></a>Планирование переноса хранилища данных

Миграция хранилища данных является сложной задачей для любой компании. Чтобы хорошо выполнить его и избежать каких либо ненужных и незапланированных затрат, необходимо тщательно исследовать проблему, снизить риски и спланировать миграцию, чтобы убедиться, что вы все равно готовы. На высоком уровне план должен охватывать основные этапы процесса миграции хранилища данных и все задачи в них. Основные шаги процесса:

- Подготовка перед миграцией
- Стратегия и выполнение миграции
- Действия после миграции

Например, подготовка группы по переносу хранилища данных включает в себя навыки обучения и знакомства с технологиями. Он также включает в себя настройку лаборатории проверки концепции, понимание того, как вы будете управлять тестовыми и рабочими средами, обеспечивает достаточный зазор для переноса данных и рабочей системы за пределами корпоративного брандмауэра и настройку программного обеспечения миграции в центре обработки данных, чтобы обеспечить продолжение миграции.

Чтобы миграция хранилища данных работала непрерывно, ваш план должен четко понимать:

- Ваш бизнес-сценарий, в том числе его драйверы, преимущества для бизнеса и риски.
- Роли и обязанности группы миграции.
- Для обеспечения успешной миграции требуется набор навыков и обучение.
- Выделенный бюджет для полной миграции.
- Стратегия миграции.
- Как избежать риска в проекте миграции, чтобы избежать задержек или переработок.
- Существующая система хранилища данных, ее архитектура, схема, тома данных, потоки данных, безопасность и зависимости операционной системы.
- Различия между существующими СУБД в локальной системе хранения данных и Azure синапсе, такими как типы данных, функции SQL, логика и другие соображения.
- Что необходимо перенести и определить приоритеты.
- Задачи, подходы, порядок и сроки миграции.
- Как будет управлять миграцией.
- Как предотвратить прерывание работы пользователей во время переноса.
- Что необходимо сделать в локальной среде, чтобы избежать задержек и включить миграцию.
- Средства для обеспечения безопасного переноса схем, данных и ETL-процессов в Azure.
- Изменения структуры модели данных, необходимые во время и после миграции.
- Все изменения, выполняемые перед миграцией или после миграции, и способы их устранения.
- Нерекомендуемая технология, выполняемая после миграции.
- Способ реализации тестирования и контроля качества для подтверждения успеха.
- Контрольные точки, позволяющие оценивать ход выполнения и принимать решения.
- План на непредвиденные случаи и точки отката в случае неправильного выполнения.

Чтобы достичь этого понимания, необходимо подготовить и начать выполнение конкретных действий перед началом миграции. Давайте взглянем на то, что больше подробно рассматривается.

## <a name="pre-migration-preparation"></a>Подготовка перед миграцией

Прежде чем начать миграцию хранилища данных, необходимо решить несколько моментов.

### <a name="key-roles-in-a-data-warehouse-migration-team"></a>Основные роли в группе миграции хранилища данных

К ключевым ролям в проекте миграции относятся:

- Владелец бизнеса
- Руководитель проекта (с методологией Agile, например Scrum)
- Координатор проекта
- Облачный инженер
- Администратор базы данных (существующая СУБД хранилища данных и Azure синапсе)
- Модели данных
- Разработчики ETL
- Специалист по виртуализации данных (может быть DBA)
- Инженер тестирования
- Бизнес-аналитикы (для помощи в тестировании запросов, отчетов и анализа средств BI)

Кроме того, группе требуется поддержка локальной группы инфраструктуры.

### <a name="skills-and-training-to-ready-the-team-for-migration"></a>Навыки и обучение для подготовки группы к миграции

В отношении навыков в переносе хранилища данных важна квалификация. Поэтому убедитесь, что соответствующие члены группы миграции обучены в основах облака Azure, хранилище BLOB-объектов Azure, Azure Data Lake Storage, Azure Data Box, ExpressRoute, Azure Identity Management, фабрике данных Azure и Azure синапсе. Скорее всего, вашим моделям данных потребуется точная настройка моделей данных Microsoft Azure синапсе после переноса из существующего хранилища данных.

### <a name="assessing-your-existing-data-warehouse"></a>Оценка существующего хранилища данных

Еще одна часть подготовки к миграции — необходимость полной оценки существующего хранилища данных, чтобы полностью понять архитектуру, хранилища данных, схему, бизнес-логику, потоки данных, используемые функции СУБД, операции хранилища и зависимости. Чем больше понимание, тем лучше. Подробные сведения о том, как работает система, помогает общаться и охватывать все базовые возможности.

Цель оценки заключается не только в том, чтобы тщательно изучить текущую настройку в группе миграции, а также понять сильные и слабые стороны в текущей настройке. Таким образом, результат оценки текущего хранилища данных может повлиять на стратегию миграции с точки зрения точности и сдвига по сравнению с более широкими возможностями. Например, если результат оценки состоит в том, что хранилище данных находится в конце жизненного цикла, очевидно, что стратегия была бы более полной, чем перенос данных в созданное хранилище данных в Azure синапсе по сравнению с приближением и сдвигом.

### <a name="on-premises-preparation-for-data-migration"></a>Подготовка к переносу данных в локальной среде

В дополнение к подготовке и готовности группы миграции для целевой среды и оценке текущей настройки, также важно установить вещи в локальной среде, так как рабочие хранилища данных, как правило, сильно контролируются процедурами ИТ и утверждениями. Чтобы избежать задержек, убедитесь в том, что инфраструктура центра обработки данных и группы эксплуатации готовы к переносу на облачную службу Azure, схемы, задания ETL и т. д. Перенос данных может осуществляться через:

- AzCopy в хранилище BLOB-объектов Azure.
- Microsoft Azure ExpressRoute, чтобы передавать сжатые данные непосредственно в Azure.
- Экспорт файлов в Azure Data Box.

Основные факторы, влияющие на выбор из этих параметров, — размер тома данных (в терабайтах) и скорость сети (в Мбит/с). Для определения времени, затрачиваемого на миграцию данных по сети, необходимо выполнить вычисление, учитывая, что данные могут быть сжаты в хранилище данных и распакованы при экспорте. Такая ситуация может снизить производительность при переносе данных. Повторное сжатие данных через gzip при перемещении данных любым из указанных выше методов. Polybase может обрабатывать данные со сжатием gzip напрямую. Большие объемы данных, скорее всего, будут перенесены с помощью Azure Data Box, если перемещение данных займет слишком много времени.

Кроме того, для управления выполнением экспортов существующих данных хранилища данных из Azure с помощью фабрики данных Azure необходимо установить на своем компьютере программное обеспечение времени выполнения интеграции, чтобы разрешить продолжение миграции. Учитывая эти требования, если требуется формальное утверждение, чтобы это было возможно, запуск соответствующих процессов утверждения на раннем этапе, чтобы сделать это, поможет избежать задержки в строке.

### <a name="azure-preparation-for-schema-and-data-migration"></a>Подготовка Azure к переносу схем и данных

С точки зрения подготовки на стороне Azure импорт данных должен осуществляться с помощью Microsoft Azure ExpressRoute или Microsoft Azure Data Box. Конвейеры фабрики данных Azure — это идеальный способ загрузки данных в хранилище BLOB-объектов Azure и последующей их загрузки в Azure синапсе с помощью Polybase. Поэтому для разработки такого конвейера требуется подготовка на стороне Azure.

В качестве альтернативы можно использовать имеющийся инструмент ETL в Azure, если он поддерживает Azure синапсе. Это означает, что настройка средства в Azure из Azure Marketplace и подготовка конвейера для импорта данных и их загрузка в хранилище BLOB-объектов Azure.

## <a name="defining-a-migration-strategy"></a>Определение стратегии миграции

### <a name="migration-goals"></a>Цели миграции

В любой стратегии необходимо указать набор целей или целей, которые должны быть определены для обозначения успеха. Целевые объекты могут быть настроены для достижения этих целей и ответственность за их достижение. Примеры целей миграции и соответствующие метрики для установки целевых объектов в в облачном проекте миграции хранилища данных приведены в следующей таблице:

Типы целей и метрик:

#### <a name="improve-overall-performance"></a>Повышение общей производительности

- Производительность переноса данных
- Производительность ELT
- Производительность загрузки данных
- Производительность сложных запросов
- Число одновременных пользователей

#### <a name="run-at-lower-cost"></a>Выполнять с низкой стоимостью

- Стоимость вычислений по рабочей нагрузке, например число часов вычислений x стоимость за час для:
  - Стандартные отчеты
  - Нерегламентированные запросы
  - Обработка пакетного ELT
- Стоимость хранения (промежуточное хранение, рабочие таблицы, индексы, временное пространство)

#### <a name="operate-with-better-availability-and-service-levels"></a>Повышение доступности и уровней обслуживания

- Соглашения об уровне обслуживания
- Высокий уровень доступности

#### <a name="improve-productively"></a>Повышение продуктивности

- Задачи автоматизированного, сокращенное число администраторов

Успешная миграция хранилища данных может быть интерпретирована как хранилище данных, которое выполняется как быстрый или быстрее и с меньшими затратами, чем устаревшая система, из которой выполнялась миграция. Назначение владельцев этих целей создает ответственность за их достижение. Это также гарантирует, что тестирование в лаборатории подтверждения концепции (как определено в разделе о возможностях этого руководства) будет считаться успешным, если тесты определяют способы достижения целей.

### <a name="migration-approach"></a>Подход к миграции

Существует несколько стратегических вариантов переноса существующего хранилища данных в Azure синапсе.

- Поднимите и перенесите существующее хранилище данных "как есть".
- Упростите существующее хранилище данных, а затем перенесите его.
- Полностью переведите хранилище данных в Azure синапсе и перенесите данные.

Результаты оценки существующего хранилища данных должны существенно повлиять на вашу стратегию. Хороший результат оценки может порекомендовать стратегию прогнозирования и сдвига. Заурядногоный результат, обусловленный оценкой низкой гибкости, может указывать на то, что для миграции требуется упрощение. Плохой результат может означать, что требуется полная переработка.

Уменьшение и сдвиг оставляют архитектуру как есть, пытаясь максимально увеличить объем работы при перемещении существующей системы. Если имеющееся средство ETL уже поддерживает Azure синапсе, вы можете изменить целевой объект с минимальными усилиями. Однако существуют различия в типах таблиц, типах данных, функциях SQL, представлениях, бизнес-логике хранимых процедур и т. д. Эти различия и способы их устранения подробно описаны в документах более низкого уровня в этой серии миграции.

Упрощение существующего хранилища данных до миграции заключается в снижении сложности для упрощения миграции. Это может быть:

- Удаление или архивация неиспользуемых таблиц перед миграцией во избежание переноса неиспользуемых данных.
- Преобразование физических киосков данных в виртуальные киоски данных с помощью программного обеспечения виртуализации данных для сокращения числа миграций. Преобразование также повышает гибкость и снижает совокупную стоимость владения, поэтому ее можно рассматривать как модернизации во время миграции.

Вы также можете упростить сначала, а затем уменьшить и сместить оставшиеся изменения.

### <a name="migration-scope"></a>Область миграции

Какая бы стратегия была выбрана, следует четко определить область миграции, что будет перенесено, а также как выполнять миграцию постепенно или сразу. Один из примеров добавочной миграции — сначала перенос киосков данных, а затем хранилище данных. Такой подход позволит вам сосредоточиться на бизнес-областях с высоким приоритетом и позволить команде постепенно создавать знания по мере переноса каждого киоска, прежде чем переносить данные в хранилище данных.

### <a name="defining-what-has-to-be-migrated"></a>Определение переносимых

Выполните инвентаризацию всех элементов, которые необходимо перенести. К ним относятся схема, данные, процессы ETL (конвейеры), права авторизации, пользователи, уровни семантического доступа средства бизнес-аналитики и аналитические приложения. Подробные сведения о том, что происходит при переносе данных инвентаризации, приведены в каждой из статей, посвященных миграции более низкого уровня в этой серии. Ниже приведены ссылки на них.

- Рекомендации по миграции, проектированию и повышению производительности схемы.
- Перенос данных, обработка ETL и загрузка.
- Безопасность доступа и операции с хранилищем данных.
- Перенос визуализации и отчетов.
- Минимизация влияния проблем SQL.
- Сторонние средства, помогающие при переносе хранилища данных.

Если вы не уверены в оптимальном подходе, выполните тесты в лаборатории проверки концепции, чтобы найти оптимальные методы. Дополнительные сведения см. в разделе о том, как отменить риск для проекта миграции хранилища данных.

### <a name="migration-control"></a>Управление миграцией

Миграция хранилища данных в Azure синапсе включает задачи, которые необходимо выполнить.

- Локальная среда, например экспорт данных.
- В сети, например, для обмена данными.
- В облаке Azure, например преобразование данных, интеграция и загрузка.

Проблема заключается в том, что управление этими задачами может быть сложным, если все сценарии и служебные программы разрабатываются, тестируются и выполняются независимо в локальных средах и в среде Azure. Он усложняет сложность, особенно если управление версиями, Управление тестированием и выполнение миграции не согласовываются.

Следует избегать этих сложностей и управлять ими из общего места через репозиторий системы управления версиями для управления изменениями от разработки до тестирования и производства. При выполнении миграции будут задействованы задачи, которые должны выполняться локально, в сети и в Azure. Так как Azure синапсе является целевой средой, управление выполнением миграции из Azure упрощает управление. Используйте фабрику данных Azure (ADF), чтобы создать конвейер управления миграцией для управления выполнением как локально, так и в Azure. Это представляет собой автоматизацию и уменьшает количество ошибок. ADF-файл преобразуется в средство оркестрации для миграции, а не только для средства интеграции данных предприятия.

Другие параметры для управления миграцией, доступные для партнеров Майкрософт, работающих в Azure, включают средства автоматизации хранилища данных, которые пытаются автоматизировать миграцию. Например, такие поставщики, как Вхерескапе и Attunity. Большинство этих средств автоматизации ориентированы на подход к миграции с помощью точности и сдвига. Даже в этом случае могут существовать некоторые вещи, которые могут не поддерживаться такими инструментами, как, например, хранимые процедуры. Эти продукты и несколько других подробно описаны в отдельном разделе, посвященном сторонним средствам, которые помогут вам перейти на Azure синапсе.

### <a name="migration-testing"></a>Тестирование миграции

Первое, что необходимо для тестирования, — это определить ряд тестов и набор требуемых результатов для каждого теста, который необходимо выполнить для проверки и указания успеха. Важно убедиться, что все аспекты тестируются и сравниваются в существующих и перенесенных системах, включая:

- схема
- Типы данных, преобразованные при необходимости
- Использование определяемой пользователем схемы в Azure синапсе для различения таблиц "хранилище данных" и "киоск данных"
- Пользователи
- Роли и назначения пользователей для этих ролей
- Привилегии безопасности доступа к данным
- Конфиденциальность и соответствие данных
- Привилегии, регулирующие возможности администрирования
- Качество и целостность данных
- Обработка ETL, которая заполняет Azure синапсе как в хранилище данных, так и из хранилища данных в любые киоски данных, включая тестирование
- Все строки являются правильными во всех таблицах, включая журнал
- Обработка медленно изменяющегося измерения
- Обработка отслеживания измененных данных
- Вычисления и агрегаты, использующие функции, которые могут различаться в разных системах
- Результаты всех известных запросов, отчетов и панелей мониторинга
- Производительность и масштабирование
- Аналитические функции
- Расходы в новой среде с оплатой по мере использования

Автоматизируйте тестирование как можно больше, делая каждый тест повторяющимся и обеспечивая единообразный подход к оценке результатов. Если отчеты и панели мониторинга несогласованны, то возможность сравнивать журнал преобразований метаданных в исходных и перенесенных системах полезна во время тестирования миграции, так как она может выделить различия и определить, где они возникали, когда они не просто обнаруживаются.

Оптимальный способ обеспечения безопасности заключается в создании ролей, назначении прав доступа ролям и последующем присоединении пользователей к ролям. Чтобы получить доступ к только что перенесенному хранилищу данных, настройте автоматический процесс создания новых пользователей и назначения ролей. Сделайте то же самое для удаления пользователей из ролей.

Сообщите прямую миграцию всем пользователям, чтобы они знали, что меняется и чего следует рассчитывать.

## <a name="de-risking-your-data-warehouse-migration-project"></a>Отмена риска для проекта миграции хранилища данных

Другой критический фактор в переносе хранилища данных — это отмена риска проекта, чтобы максимально увеличить вероятность успеха. Существует несколько вещей, которые можно выполнить для отмены риска миграции хранилища данных. К ним относятся следующие:

- Создание лабораторной лаборатории, позволяющей команде опробовать вещи, проводить тесты, понимать любые проблемы и выявление исправлений и оптимизаций, помогающих проверить подходы к миграции, повысить производительность и снизить затраты. Кроме того, он помогает устанавливать способы автоматизации задач, использовать встроенные средства и шаблоны сборки для сбора рекомендаций, изучения опыта работы и отслеживания полученных уроков. Это неэффективный способ снизить риск и повысить вероятность успеха. Кроме того, можно назначить владельцев для тестов, которые могут быть доступны для достижения целей и целей миграции, как определено в стратегии миграции.
- Познакомьтесь с виртуализацией данных между инструментами бизнес-аналитики и хранилищем данных и киосками данных. Используйте прозрачность пользователей с помощью виртуализации данных, чтобы снизить риски при миграции хранилища данных, а также скрыть миграцию пользователей с помощью средств бизнес-аналитики для виртуализации данных, как показано на следующей схеме.

![Диаграмма миграции хранилища данных](../_images/data-warehouse-migration.png)

Это предназначено для того, чтобы разорвать зависимость между бизнес-пользователями, использующими средства самостоятельной бизнес-аналитики, и физической схемой базовых хранилищ данных и киосков данных, которые переносятся. Поставляя виртуализацию данных, любые изменения схемы, сделанные во время переноса хранилища данных и киоска данных в Azure синапсе (например, для оптимизации производительности), могут быть скрыты от бизнес-пользователей, так как они обращаются только к виртуальным таблицам на уровне виртуализации данных. Если требуется структурное изменение, необходимо изменить только сопоставления между хранилищем данных или киосками данных и виртуальными таблицами, чтобы пользователи оставались неосведомленными об этих изменениях и не подозревают о миграции.

- Заархивируйте все существующие таблицы, которые определены как никогда не использовавшиеся перед миграцией хранилища данных, так как некоторая миграция таблиц не используется. Одним из возможных способов сделать это является Архивация неиспользуемых данных в хранилище BLOB-объектов Azure или Azure Data Lake и создание внешних таблиц в Azure синапсе для этих данных, чтобы они остались в сети.
- Рассмотрим возможность внедрения виртуальной машины (ВМ) в Azure с версией для разработки (обычно бесплатно) существующей СУБД прежнего хранилища данных, работающей на этой виртуальной машине. Это позволяет быстро переместить существующую схему хранилища данных на виртуальную машину и переместить ее в Azure синапсе при полной работе в облаке Azure.
- Определите порядок миграции и зависимости.
- Убедитесь, что ваша инфраструктура и группы эксплуатации готовы к переносу данных в рамках проекта миграции как можно раньше.
- Выявление различий в функциональных возможностях СУБД и в случаях, когда собственная бизнес-логика может стать проблемой. Например, использование хранимых процедур для обработки ELT вряд ли будет легко переноситься и не будет содержать никаких преобразований метаданных, так как преобразования скрыты в коде.
- Сначала следует рассмотреть стратегию по переносу киосков данных, за которой следует хранилище данных, которое является источником киосков данных. Причина этого заключается в том, что она включает добавочную миграцию, она делает ее более управляемой и может назначать приоритеты для миграции на основе бизнес-потребностей.
- Учитывая возможность использования виртуализации данных для упрощения текущей архитектуры хранилища данных перед миграцией, например, чтобы заменить киоски данных виртуальными киосками данных, можно исключить физические хранилища данных и задания ETL для киосков данных без потери функциональности до миграции. Это сократит количество хранилищ данных для переноса, сократит число копий данных, сократит общую стоимость владения и повысит гибкость. Перед переносом хранилища данных необходимо переключиться с физического компьютера на виртуальные киоски данных. Во многих случаях вы можете рассмотреть это на этапе модернизации хранилища данных до миграции.

## <a name="next-steps"></a>Следующие шаги

Дополнительные сведения о миграции хранилища данных см. в [модернизации семинаре по хранилищу данных виртуального облака в Azure](https://now.informatica.com/Microsoft_CDW_Workshops.html) из Informatica.
