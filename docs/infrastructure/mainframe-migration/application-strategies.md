---
title: Стратегии миграции приложений мэйнфреймов
description: Изучите такие стратегии, как повторное размещение, снятие с учета, перестроение или замена приложений для переноса из сред мэйнфрейма в Azure.
author: njray
ms.author: v-nanra
ms.date: 12/26/2018
ms.topic: conceptual
ms.service: cloud-adoption-framework
ms.subservice: migrate
ms.openlocfilehash: 5c76356277f6ae911b2994dac0d6bcb66bcdd112
ms.sourcegitcommit: a7eb2f6c4465527cca2d479edbfc9d93d1e44bf1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/17/2020
ms.locfileid: "94712645"
---
<!-- docutune:casing GDGs "GT Software" "NTT Data" -->
<!-- cSpell:ignore Attunity Codit DRDA ISAM ISQL LPARS VSAM ODBC JDBC GDGs REXX dbextents Raincode Tmax -->

# <a name="mainframe-application-migration"></a>Перенос приложений с мейнфреймов

Многие команды прагматично подходят к переносу приложений из сред мейнфреймов в Azure: код при возможности используется повторно, а затем, если приложения необходимо переписать или заменить, они развертываются поэтапно.

Для переноса приложений обычно применяется одна или несколько из следующих стратегий:

- Повторное **Размещение:** Можно переместить существующий код, программы и приложения с мэйнфрейма, а затем повторно скомпилировать код для запуска в эмуляторе мэйнфрейма, размещенном в облачном экземпляре. Как правило, при этом подходе сначала приложения перемещаются в облачный эмулятор, а затем базы данных переносятся в облачную базу данных. По мере преобразования данных и файлов потребуется немного изменить код и выполнить рефакторинг.

    Кроме того, вы можете повторно разместить приложение у своего поставщика услуг размещения. Одним из основных преимуществ облака является аутсорсинг управления инфраструктурой. Вы можете найти центр обработки данных и разместить в нем рабочие нагрузки для своих мейнфреймов. Эта модель позволяет выиграть время, снизить зависимость от поставщика и сэкономить средства за определенный период.

- **Снять с учета:** Все приложения, которые больше не нужны, необходимо снять с учета перед миграцией.

- **Перестроение:** Некоторые организации решили полностью переписать программы с помощью современных методик. Учитывая добавленные затраты и сложность этого подхода, не так часто, как подход к точности и сдвигу. Если вы также выбрали этот подход, рекомендуем заменить модули и код с помощью механизмов преобразования кода после миграции.

- **Заменить:** Этот подход заменяет функциональные возможности мэйнфрейма эквивалентными функциями в облаке. Программное обеспечение как услуга (SaaS) — это один из вариантов, который используется в корпоративных решениях для отдела кадров, финансов, производства или планирования ресурсов предприятия. Кроме того, теперь многие приложения для отрасли позволяют решить проблемы, связанные с пользовательскими решениями для мэйнфреймов, которые используются для решения ранее.

Рекомендуется начать с планирования тех рабочих нагрузок, которые необходимо изначально перенести, а затем определить эти требования для перемещения связанных приложений, баз данных прежних версий и баз.

## <a name="mainframe-emulation-in-azure"></a>Эмуляция мейнфрейма в Azure

Облачные службы Azure позволяют эмулировать традиционные среды мейнфреймов, чтобы повторно использовать существующий код мейнфреймов и приложений. К общим компонентам сервера, которые можно эмулировать, относятся системы онлайн-обработки транзакций (OLTP), пакетной обработки и приема данных.

### <a name="oltp-systems"></a>Системы OLTP

Во многих мейнфреймах используются системы OLTP, обрабатывающие тысячи или миллионы обновлений для огромного числа пользователей. Эти приложения часто используют программное обеспечение для обработки транзакций и форм на экране, например систему управления сведениями о клиентах (CICS), систему управления информацией (МГНОВЕНные данные) и процессор интерфейса терминала (TIP).

При переносе приложений OLTP в Azure вы можете запускать эмуляторы для обработки транзакций мейнфреймов (TP) в виде IaaS (инфраструктура как услуга) на виртуальных машинах в Azure. Функциональные возможности для работы с формами и экраном также реализуются с помощью веб-серверов. Этот подход можно сочетать с API базы данных, такими как объекты данных ActiveX (ADO), Open Database Connectivity (ODBC) и Java Database Connectivity (JDBC) для доступа к данным и транзакций.

### <a name="time-constrained-batch-updates"></a>Пакетные обновления, ограниченные по времени

Во многих системах на базе мейнфреймов миллионы учетных записей обновляются ежемесячно или ежегодно, например в банках, страховых компаниях и государственных организациях. Мейнфреймы обрабатывают такие рабочие нагрузки с помощью систем обработки данных с высокой пропускной способностью. Чтобы повысить производительность, зависящую от скорости обработки (количества операций ввода-вывода в секунду) магистрали мейнфреймов, пакетные задания мейнфреймов обычно выполняются последовательно.

Для повышения производительности в облачных средах для пакетных операций используются параллельные вычисления и высокоскоростные сети. Если вам нужно оптимизировать производительность пакетных операций, Azure предоставляет различные варианты вычислений, хранения данных и сетей.

### <a name="data-ingestion-systems"></a>Системы приема данных

Мейнфреймы принимают для обработки большие пакеты данных из области розничной торговли, финансовых услуг, производства и других решений для обработки. Чтобы скопировать данные в расположение для хранения и из него, вы можете использовать простые средства командной строки Azure, такие как [AzCopy](/azure/storage/common/storage-use-azcopy). Кроме того, служба [Фабрика данных Azure](/azure/data-factory/introduction) позволяет принимать данные из разрозненных хранилищ, чтобы создавать и планировать рабочие процессы на основе этих данных.

Кроме среды эмуляции, Azure предоставляет службы PaaS (платформа как услуга) и аналитики, которые позволяют улучшить существующие среды мейнфреймов.

## <a name="migrate-oltp-workloads-to-azure"></a>Перенос рабочих нагрузок OLTP в Azure

Подход с приближением и сдвигом — это вариант без кода для быстрой миграции существующих приложений в Azure. Каждое приложение переносится без изменений, чтобы вы могли воспользоваться преимуществами облачной среды без рисков и затрат, связанных с изменением кода. С этой целью для мониторов обработки транзакций (TP) мейнфрейма в Azure применяется эмулятор.

Мониторы обработки транзакций предоставляются различными поставщиками и работают на виртуальных машинах (инфраструктура как услуга (IaaS) в Azure). На следующей схеме показан перенос веб-приложения на основе IBM DB2, системы управления реляционной базой данных (СУБД) на мейнфрейм IBM z/OS (до и после). DB2 для z/OS использует файлы метода доступа к виртуальному хранилищу (ВСАМ) для хранения данных и индексированного последовательного метода доступа (ISAM) для неструктурированных файлов. В этой архитектуре CICS также используется для мониторинга транзакций.

![Миграция среды мэйнфреймов в Azure с помощью программного обеспечения для эмуляции](../../_images/mainframe-migration/mainframe-vs-azure.png)

Для запуска диспетчера транзакций и пакетных заданий, использующих JCL, в Azure используется среда эмуляции. На уровне данных DB2 заменяется [Базой данных SQL Azure](/azure/sql-database/sql-database-technical-overview). Кроме того, можно использовать Microsoft SQL Server, DB2 LUW или Oracle Database. Эмулятор поддерживает IMS, VSAM и SEQ. Средства управления системой на мэйнфрейме заменены службами Azure и программным обеспечением от других поставщиков, которые работают на виртуальных машинах.

Как правило, функции обработки экрана и форм для ввода данных реализуются с помощью веб-серверов, которые можно комбинировать с API баз данных, такими как ADO, ODBC и JDBC, для транзакций и доступа к данным. Полный перечень IaaS-компонентов Azure зависит от операционной системы, которую вы предпочитаете использовать. Пример:

- **Виртуальные машины на основе Windows:** Internet Information Server (IIS) вместе с ASP.NET для обработки экрана и бизнес-логики. Для доступа к данным и транзакций используйте стандарт ADO.NET.

- **Виртуальные машины на основе Linux:** Доступные серверы приложений на базе Java, такие как Apache Tomcat для обработки экрана и бизнес-функции на основе Java. Для доступа к данным и транзакций используйте стандарт JDBC.

## <a name="migrate-batch-workloads-to-azure"></a>Перенос пакетных рабочих нагрузок в Azure

Пакетные операции в Azure отличаются от выполняемых в обычной среде для пакетных задач на мейнфреймах. Чтобы повысить производительность, зависящую от количества операций ввода-вывода в секунду в магистрали мейнфреймов, пакетные задания мейнфреймов обычно выполняются последовательно. Для повышения производительности пакетных операций в облачных средах используются параллельные вычисления и высокоскоростные сети.

Чтобы оптимизировать производительность пакетных операций с помощью Azure, учитывайте возможности [вычислительных ресурсов](/azure/virtual-machines/windows/overview), [хранилища](/azure/storage/blobs/storage-blobs-introduction), [сети](https://azure.microsoft.com/blog/maximize-your-vm-s-performance-with-accelerated-networking-now-generally-available-for-both-windows-and-linux) и [мониторинга](/azure/azure-monitor/overview), как описано ниже.

### <a name="compute"></a>Вычисления

Используйте следующую команду:

- Виртуальные машины с высокой тактовой частотой процессора. Часто приложения для мейнфреймов с высокой тактовой частотой ЦП бывают однопоточными.

- Виртуальные машины с большим объемом памяти для кэширования данных и рабочих областей приложений.

- Виртуальные машины с более высокой плотностью виртуальных ЦП, чтобы воспользоваться преимуществами многопоточной обработки, если приложение поддерживает несколько потоков.

- Параллельную обработку. Azure легко масштабируется для параллельной обработки, обеспечивая большую вычислительную мощность для выполнения пакетных операций.

### <a name="storage"></a>Память

Используйте следующую команду:

- [SSD Azure Premium](/azure/virtual-machines/windows/premium-storage) или [Azure Ultra SSD](/azure/virtual-machines/windows/disks-ultra-ssd) для максимального числа доступных операций ввода-вывода.

- Чередование нескольких дисков, чтобы увеличить отношение количества операций ввода-вывода в секунду к объему хранилища.

- Секционирование хранилища для распределения операций ввода-вывода на нескольких устройствах хранения Azure.

### <a name="networking"></a>Сеть

- Используйте [ускоренную сеть Azure](/azure/virtual-network/create-vm-accelerated-networking-powershell) для сокращения задержки.

### <a name="monitoring"></a>Мониторинг

- Использование средств мониторинга, [Azure Monitor](/azure/azure-monitor/overview), [Application Insights](/azure/application-insights/app-insights-overview)и журналов Azure позволяет администраторам наблюдать за производительностью пакетных запусков и устранять узкие места.

## <a name="migrate-development-environments"></a>Перенос сред разработки

В распределенных архитектурах облака используются разные наборы средств разработки, которые предоставляют преимущества современных методик и языков программирования. Чтобы облегчить переход, используйте среду разработки с другими средствами, предназначенными для эмуляции сред IBM z/OS. Ниже приведен список вариантов, предлагаемых корпорацией Майкрософт и другими поставщиками:

| Компонент        | Параметры Azure                                                                                                                                  |
|------------------|---------------------------------------------------------------------------------------------------------------------------------------------------|
| z/OS             | Windows, Linux или UNIX                                                                                                                      |
| CICS             | Службы Azure, предлагаемые Micro Focus, Oracle, GT Software (Fujitsu), TmaxSoft, Raincode и NTT Data. Также можно переписать решение с использованием Kubernetes. |
| IMS              | Службы Azure, предлагаемые Micro Focus и Oracle                                                                                  |
| Assembler        | Службы Azure, предлагаемые Raincode и TmaxSoft; COBOL, C или Java; сопоставление с функциями операционной системы               |
| JCL              | JCL, PowerShell или другие средства для работы со скриптами                                                                                                   |
| COBOL            | COBOL, C или Java                                                                                                                            |
| Natural          | Natural, COBOL, C или Java                                                                                                                  |
| Fortran и PL/I | Fortran, PL/I, COBOL, C или Java                                                                                                           |
| REXX и PL/I    | REXX, PowerShell или другие средства для работы со скриптами                                                                                                  |

## <a name="migrate-databases-and-data"></a>Перенос баз данных и данных

Как правило, при переносе приложений требуется повторное размещение приложения на уровне данных. Вы можете перенести SQL Server, Открытый исходный код и другие реляционные базы данных в полностью управляемые решения в Azure, такие как [Azure SQL управляемый экземпляр](/azure/sql-database/sql-database-managed-instance), [база данных Azure для PostgreSQL](/azure/postgresql/overview)и [база данных Azure для MySQL](/azure/mysql/overview) с [Azure Database Migration Service](/azure/dms/dms-overview).

К примеру, вы можете перенести приложение, если на уровне данных мейнфрейма используются:

- IBM DB2 или МГНОВЕНная база данных, используйте базу данных SQL Azure, SQL Server, DB2 LUW или Oracle Database в Azure.

- ВСАМ и другие неструктурированные файлы, используйте неструктурированные файлы с индексированным последовательным доступом (ISAM) для базы данных SQL Azure, SQL Server, DB2 LUW или Oracle.

- Группы дат поколения (Гдгс) — миграция в файлы в Azure, в которых используется соглашение об именовании и расширения имен файлов, обеспечивающие аналогичные функции для Гдгс.

На уровне данных IBM есть несколько основных компонентов, которые также необходимо перенести. Например, при переносе базы данных переносится и коллекция c данными в пулах, каждый из которых содержит "dbextents" — наборы данных VSAM z/OS. При миграции нужно указать каталог, определяющий расположения данных в пулах носителей. Кроме того, в плане миграции необходимо учесть журнал базы данных с записями операций, выполняемых в базе данных. База данных может иметь один, два (двойных или альтернативных) или четыре (двойных и альтернативных) журнала.

При переносе базы данных необходимо также перенести следующие компоненты:

- **Диспетчер баз данных:** Предоставляет доступ к данным в базе данных. Диспетчер базы данных запускается в отдельном разделе в среде z/OS.
- **Инициатор запроса приложения:** Принимает запросы от приложений перед их передачей на сервер приложений.
- **Адаптер Интернет-ресурсов:** Включает компоненты инициатора приложения для использования в транзакциях CICS.
- **Адаптер ресурсов пакетной службы:** Реализует компоненты инициатора запроса приложения для приложений пакетной службы z/OS.
- **Интерактивный SQL (ISQL):** Работает как приложение CICS и интерфейс, что позволяет пользователям вводить инструкции SQL или команды операторов.
- **Приложение CICS:** Выполняется под управлением CICS с использованием доступных ресурсов и источников данных в CICS.
- **Приложение пакетной службы:** Выполняет логику процесса без интерактивного взаимодействия с пользователями, например для создания пакетных обновлений данных или создания отчетов из базы данных.

## <a name="optimize-scale-and-throughput-for-azure"></a>Оптимизация масштаба и пропускной способности для Azure

В целом, большие ЭВМ масштабируются, в то время как облако масштабируется. Чтобы оптимизировать масштабирование и пропускную способность приложений в стиле мэйнфреймов, работающих в Azure, важно понимать, как большие ЭВМ могут разделять и изолировать приложения. Мэйнфрейм z/OS использует функцию, называемую логическими разделами (Лпарс), для изоляции ресурсов и управления ими для конкретного приложения в одном экземпляре.

Например, мэйнфрейм может использовать один ЛПАР для CICS региона со связанными программами COBOL, а также отдельный ЛПАР для DB2. Дополнительные логические разделы часто используются для сред разработки, тестирования и промежуточных сред.

В Azure чаще всего для этой цели используются отдельные виртуальные машины. В архитектурах Azure на уровне приложений обычно развертываются виртуальные машины: один набор виртуальных машин применяется на уровне данных, и другой набор используется для разработки и подобных целей. Каждый уровень обработки можно оптимизировать с помощью наиболее подходящего типа виртуальных машин и функций для этой среды.

Кроме того, на каждом уровне можно применять соответствующие службы аварийного восстановления. Например, для виртуальных машин, используемых в рабочей среде, и виртуальных машин с базами данных, возможно, потребуется "горячее" или "теплое" восстановление. А виртуальные машины для разработки и тестирования поддерживают "холодное" восстановление.

На следующем рисунке показан возможный процесс развертывания в Azure с помощью основного и дополнительного веб-сайта. На основном сайте рабочие и промежуточные виртуальные машины развертываются с высокой доступностью. Дополнительный сайт используется для резервного копирования и аварийного восстановления.

![Возможный процесс развертывания в Azure с помощью основного и дополнительного сайта](../../_images/mainframe-migration/migration-backup-dr.png)

## <a name="perform-a-staged-mainframe-to-azure"></a>Поэтапный перенос приложения с мейнфрейма в Azure

Возможно, перенести решения с мейнфрейма в Azure потребуется _поэтапно_. При этом одни приложения переносятся в первую очередь, а другие временно или навсегда остаются на мейнфрейме. Как правило, для реализации этого подхода необходимы системы, которые позволяют приложениям и базам данных взаимодействовать между мейнфреймом и Azure.

Распространенный сценарий — перенос приложения в Azure с сохранением данных, используемых приложением, на мейнфрейме. Чтобы предоставить приложениям в Azure доступ к данным с мейнфрейма, используется специальное программное обеспечение. К счастью, широкий выбор решений обеспечивает интеграцию между Azure и существующими средами мейнфреймов, поддержку гибридных сценариев и поэтапную миграцию. Партнеры корпорации Майкрософт, независимые поставщики программного обеспечения и системные интеграторы, смогут помочь вам реализовать такое взаимодействие.

Одним из вариантов является [Microsoft Host Integration Server](/host-integration-server), решение, предоставляющее архитектуру распределенной реляционной базы данных (DRDA), необходимую приложениям в Azure для доступа к данным в DB2, которые остаются на мэйнфрейме. Другие варианты интеграции с мэйнфреймом в Azure включают решения от IBM, Attunity, кодит, других поставщиков и параметры с открытым исходным кодом.

## <a name="partner-solutions"></a>Решения партнеров

Если вы планируете миграцию с мэйнфреймов, вам поможет партнерская экосистема.

Azure предоставляет проверенную, высокодоступную и масштабируемую инфраструктуру для систем, которые сейчас работают на мейнфреймах. Некоторые рабочие нагрузки можно перенести без особых трудностей. Другие рабочие нагрузки, зависящие от программного обеспечения устаревших систем, такие как CICS и IMS, можно со временем перенести в Azure с помощью решений партнеров. Какой бы из вариантов вы не выбрали, корпорация Майкрософт и ее партнеры готовы помочь вам оптимизировать решение для Azure, сохранив функциональные возможности программного обеспечения системы мейнфрейма.

## <a name="learn-more"></a>Подробнее

Дополнительные сведения см. в следующих ресурсах:

- [Начало работы с Azure](/azure)

- [Развертывание IBM DB2 Пурескале в Azure](https://azure.microsoft.com/resources/deploy-ibm-db2-purescale-on-azure)

- [Документация по Host Integration Server](/host-integration-server)
