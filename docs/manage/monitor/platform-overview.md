---
title: Обзор платформ мониторинга в облаке
description: Ознакомьтесь с общими сведениями о двух платформах мониторинга, которые помогут понять, как каждая из них предоставляет основные функции мониторинга.
author: mgoedtel
ms.author: magoedte
ms.date: 07/31/2019
ms.topic: conceptual
ms.service: cloud-adoption-framework
ms.subservice: operate
services: azure-monitor
ms.openlocfilehash: abe6fb81a1108e291d0a4f12382172a5f6b39e4d
ms.sourcegitcommit: bd9872320b71245d4e9a359823be685e0f4047c5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/26/2020
ms.locfileid: "83861487"
---
<!-- cSpell:ignore opsman ITSM -->

# <a name="cloud-monitoring-guide-monitoring-platforms-overview"></a>Руководство по мониторингу облака: Обзор платформ мониторинга

Корпорация Майкрософт предоставляет широкий спектр возможностей мониторинга из двух продуктов: System Center Operations Manager, разработанных для локальной среды, а затем расширенных в облаке, и Azure Monitor, который был разработан для облака, но также может отслеживать локальные системы. Эти два предложения предоставляют базовые службы мониторинга, такие как оповещения, отслеживание времени работы службы, мониторинг работоспособности приложений и инфраструктуры, диагностика и аналитика.

Многие организации используют новейшие методики для DevOps гибкости и облачных нововведений для управления разнородных средами. Но они также интересуются их возможностью принимать соответствующие и ответственные решения о том, как отслеживать эти рабочие нагрузки.

В этой статье представлен общий обзор наших платформ мониторинга, помогающих понять, как каждый из них предоставляет основные функции мониторинга.

## <a name="the-story-of-system-center-operations-manager"></a>История System Center Operations Manager

В 2000 мы указали поле Operations Management с помощью Microsoft Operations Manager (MOM) 2000. В 2007 мы представили реконструированную версию продукта с именем System Center Operations Manager. Он был перемещен за пределы простого мониторинга Windows Server и Concentrated на надежной, сквозной службе и мониторинге приложений, включая платформы разнородных, сетевые устройства, а также другие зависимости приложений или служб. Это установленная платформа мониторинга корпоративного уровня для локальных сред в том же классе, что и IBM Tivoli или HP Operations Manager в отрасли. Он увеличился для поддержки мониторинга вычислений и ресурсов платформы, работающих в Azure, Amazon Web Services (AWS) и других поставщиков облачных служб.

## <a name="the-story-of-azure-monitor"></a>История Azure Monitor

Когда служба Azure была выпущена в 2010, наблюдение за облачными службами было предоставлено с помощью агента система диагностики Azure, который предоставляет способ для получения диагностических данных из ресурсов Azure. Эта возможность была признана общим средством мониторинга, а не платформой мониторинга корпоративного класса.  

Application Insights была введена на смену отраслей, в которой было увеличено распространение облачных, мобильных и общепринятых устройств, а также даны рекомендации по DevOps. Она выросла из наблюдения за производительностью приложений в Operations Manager службы в Azure, где она обеспечивает широкие возможности мониторинга веб-приложений, написанных на различных языках. В 2015 Предварительная версия Application Insights для Visual Studio объявлена и более поздней, она называлась просто Application Insights. Он собирает сведения о производительности приложения, запросах и исключениях, а также трассировках.

В 2015 Служба оперативной аналитики Azure стала общедоступной. Она доставила Log Analytics Analysis Service, которые собирают и просматривают данные с компьютеров в Azure, в локальной среде или в других облачных средах и подключены к System Center Operations Manager. Пакеты аналитики были предоставлены с учетом множества предупакованных конфигураций управления и мониторинга, содержащих коллекцию логики запросов и аналитики, визуализации и правила сбора данных для таких сценариев, как аудит безопасности, оценка работоспособности и Управление оповещениями. Позже Служба оперативной аналитики Azure называлась Log Analytics.  

В 2016 Предварительная версия Azure Monitor была объявлена на конференции Microsoft Ignite. Она предоставляет общую платформу для сбора метрик платформы, журналов диагностики ресурсов и событий журнала действий уровня подписки из любой службы Azure, запущенной с помощью платформы. Ранее каждая служба Azure имела свой собственный метод мониторинга.

На Конференции 2018 Ignite мы объявили о том, что Azure Monitor торговая марка расширена для включения нескольких разных служб, изначально разработанных с помощью независимых функций:

- Исходный **Azure Monitor**для сбора метрик платформы, журналов диагностики ресурсов и журналов действий для ресурсов платформы Azure.
- **Application Insights**для мониторинга приложений.
- **Log Analytics**, основное расположение для сбора и анализа данных журнала.
- Новая **Служба единой системы предупреждений**, которая объединяет механизмы генерации оповещений из других упомянутых выше служб.  
- **Наблюдатель за сетями Azure**для мониторинга, диагностики и просмотра метрик для ресурсов в виртуальной сети.

## <a name="the-story-of-operations-management-suite-oms"></a>История использования Operations Management Suite (OMS)

С 2015 до 2018 апреля Operations Management Suite (OMS) был объединен со следующими службами управления Azure в целях лицензирования:

- Application Insights
- Служба автоматизации Azure
- Azure Backup
- Оперативная аналитика (в дальнейшем в качестве Log Analytics)
- Site Recovery

Функции служб, которые являлись частью OMS, не изменились, когда OMS была прекращена. Они были перераспределены по Azure Monitor.

## <a name="infrastructure-requirements"></a>Требования к инфраструктуре

### <a name="operations-manager"></a>Operations Manager

Operations Manager требует значительной инфраструктуры и обслуживания для поддержки группы управления, которая является базовой единицей функциональности. Как минимум, Группа управления состоит из одного или нескольких серверов управления, SQL Server экземпляра, размещающего рабочую и хранилище данных отчетов базу данных и агенты. Сложность структуры группы управления зависит от нескольких факторов, таких как объем рабочих нагрузок для мониторинга, а также от количества устройств или компьютеров, поддерживающих рабочие нагрузки. Если требуется высокая доступность и устойчивость к сайтам, как это обычно происходит при использовании корпоративных платформ мониторинга, требования к инфраструктуре и связанное обслуживание могут значительно повыситься.

![Схема группы управления Operations Manager](./media/monitoring-management-guidance-cloud-and-on-premises/operations-manager-management-group-optimized.svg)

### <a name="azure-monitor"></a>Azure Monitor

Azure Monitor является предложением SaaS, поэтому его поддерживающая инфраструктура выполняется в Azure и управляется корпорацией Майкрософт. Он выполняет мониторинг, анализ и диагностику в масштабе. Он доступен во всех национальных облаках. Основные части инфраструктуры (средства сбора данных, метрики, хранилища журналов и аналитики), поддерживающие Azure Monitor, поддерживаются корпорацией Майкрософт.  

![Схема Azure Monitor](./media/monitoring-management-guidance-cloud-and-on-premises/azure-monitor-greyed-optimized.svg)

## <a name="data-collection"></a>сбор данных

<!-- markdownlint-disable MD024 -->

### <a name="operations-manager"></a>Operations Manager

#### <a name="agents"></a>Агенты

Operations Manager собирает данные напрямую только из агентов, установленных на [компьютерах Windows](https://docs.microsoft.com/system-center/scom/plan-planning-agent-deployment?view=sc-om-1807#windows-agent). Он может принимать данные из пакета SDK Operations Manager, но этот подход обычно используется для партнеров, расширяющих продукт с помощью пользовательских приложений, а не для сбора данных мониторинга. Он может получать данные из других источников, таких как [компьютеры Linux](https://docs.microsoft.com/system-center/scom/plan-planning-agent-deployment?view=sc-om-1807#linuxunix-agent) и сетевые устройства, с помощью специальных модулей, которые выполняются в агенте Windows, который осуществляет удаленный доступ к этим устройствам.

![Схема агента Operations Manager](./media/monitoring-management-guidance-cloud-and-on-premises/data-collection-opsman-agents-optimized.svg)

Агент Operations Manager может выполнять собираются из нескольких источников данных на локальном компьютере, таких как журнал событий, пользовательские журналы и счетчики производительности. Он также может выполнять сценарии, которые могут получать данные с локального компьютера или из внешних источников. Можно создавать пользовательские скрипты для сбора данных, которые не могут быть собраны другими средствами, или для сбора данных с различных удаленных устройств, которые не могут контролироваться иным образом.

#### <a name="management-packs"></a>Пакеты управления

Operations Manager выполняет все операции мониторинга с рабочими процессами (правила, мониторы и операции обнаружения объектов). Эти рабочие процессы упаковываются в [пакет управления](https://docs.microsoft.com/system-center/scom/manage-overview-management-pack?view=sc-om-2019) и развертываются в агентах. Пакеты управления доступны для различных продуктов и служб, в том числе предопределенных правил и мониторов. Вы также можете создать собственный пакет управления для собственных приложений и пользовательских сценариев.

#### <a name="monitoring-configuration"></a>Конфигурация мониторинга

Пакеты управления могут содержать сотни правил, мониторов и правил обнаружения объектов. Агент выполняет все эти параметры мониторинга из всех применяемых пакетов управления, которые определяются правилами обнаружения. Каждый экземпляр каждого параметра мониторинга выполняется независимо друг от друга и немедленно реагирует на собираемые данные. Таким способом Operations Manager может достичь предупреждений почти в реальном времени и текущего состояния работоспособности отслеживаемых ресурсов.

Например, монитор может вычислить показания счетчика производительности каждые несколько минут. Если этот счетчик превышает пороговое значение, он немедленно устанавливает состояние работоспособности целевого объекта, который немедленно инициирует оповещение в группе управления. Запланированное правило может отслеживать создание определенного события и немедленно запускать оповещение при создании этого события в локальном журнале событий.

Поскольку эти параметры мониторинга изолированы друг от друга и работают из отдельных источников данных, Operations Manager имеет трудности, связанные с корреляцией данных между несколькими источниками. Также трудно реагировать на данные после их сбора. Вы можете запускать рабочие процессы, обращающиеся к базе данных Operations Manager, но этот сценарий обычно используется в ограниченном количестве рабочих процессов специального назначения.

![Схема группы управления Operations Manager](./media/monitoring-management-guidance-cloud-and-on-premises/operations-manager-management-group-optimized.svg)

### <a name="azure-monitor"></a>Azure Monitor

#### <a name="data-sources"></a>Источники данных

Azure Monitor собирает данные из различных источников, включая инфраструктуру Azure и ресурсы платформы, агенты на компьютерах под управлением Windows и Linux, а также данные мониторинга, собранные в службе хранилища Azure. Любой клиент RESTFUL может записывать данные журнала в Azure Monitor с помощью API, а также определять пользовательские метрики для веб-приложений. Некоторые данные метрик могут направляться в разные расположения в зависимости от их использования. Например, данные можно использовать для быстрого или долгосрочного поиска по анализу тенденций в сочетании с другими данными журнала.

#### <a name="monitoring-solutions-and-insights"></a>Мониторинг решений и аналитических сведений

Решения мониторинга используют платформу журналов в Azure Monitor для обеспечения мониторинга конкретного приложения или службы. Обычно они определяют сбор данных из агентов или служб Azure, а также предоставляют запросы журналов и представления для анализа этих данных. Обычно они не предоставляют правила генерации оповещений. Это означает, что необходимо определить собственные критерии оповещений на основе собранных данных.

Аналитические сведения, такие как Azure Monitor для контейнеров и Azure Monitor для виртуальных машин, используют платформу "журналы и метрики" Azure Monitor для предоставления настраиваемого интерфейса мониторинга для приложения или службы в портал Azure. В дополнение к настраиваемому анализу собранных данных они могут предоставлять условия наблюдения за работоспособностью и предупреждения.

#### <a name="monitoring-configuration"></a>Конфигурация мониторинга

Azure Monitor разделяет сбор данных от действий, выполняемых с этими данными, которые поддерживают распределенные микрослужбы в облачной среде. Она объединяет данные из нескольких источников в общую платформу данных, а также предоставляет возможности анализа, визуализации и создания предупреждений на основе собранных данных.

Данные, собранные Azure Monitor, хранятся в виде журналов или метрик, а различные функции Azure Monitor используют любой из них. Метрики содержат числовые значения во временных рядах, которые хорошо подходят для оповещений практически в реальном времени и быстрого обнаружения проблем. Журналы содержат текст или числовые данные, и их можно запросить с помощью мощного языка, особенно удобного для выполнения сложного анализа.

Поскольку Azure Monitor разделяет сбор данных между действиями с этими данными, в большинстве случаев может не поддерживаться оповещение практически в реальном времени. Для оповещения о данных журнала запросы выполняются по повторяющемуся расписанию, определенному в предупреждении. Такое поведение позволяет Azure Monitor легко сопоставлять данные из всех наблюдаемых источников, а также выполнять интерактивный анализ данных различными способами. Это особенно полезно для анализа основных причин и определения того, где может возникнуть проблема.

## <a name="health-monitoring"></a>Мониторинг работоспособности

### <a name="operations-manager"></a>Operations Manager

Пакеты управления в Operations Manager включают в себя модель службы, которая описывает компоненты отслеживаемого приложения и их связь. Мониторы указывают текущее состояние работоспособности каждого компонента на основе данных и скриптов на агенте. Сводный показатель состояния работоспособности позволяет быстро просмотреть сводное состояние работоспособности наблюдаемых компьютеров и приложений.

### <a name="azure-monitor"></a>Azure Monitor

Azure Monitor не предоставляет определяемый пользователем метод реализации модели или мониторов службы, которые указывают текущее состояние работоспособности всех компонентов службы. Поскольку решения для мониторинга основаны на стандартных функциях Azure Monitor, они не обеспечивают мониторинг на уровне состояния. Следующие функции Azure Monitor могут быть полезны:

- **Application Insights:** Создает составной карту веб-приложения и предоставляет состояние работоспособности для каждого компонента приложения или зависимости. Сюда входят состояние оповещений и детализация для более детальной диагностики приложения.

- **Azure Monitor для виртуальных машин:** Предоставляет возможности мониторинга работоспособности для гостевых виртуальных машин Azure, аналогичные Operations Manager, при мониторинге виртуальных машин Windows и Linux. Он оценивает работоспособность ключевых компонентов операционной системы с точки зрения доступности и производительности для определения текущего состояния работоспособности. Когда он определяет, что гостевая виртуальная машина испытывает устойчивую загрузку ресурсов, емкость места на диске или проблема, связанная с основными функциональными возможностями операционной системы, создает оповещение о том, что нужно уделить внимание.

- **Azure Monitor для контейнеров:** Отслеживание производительности и работоспособности службы Kubernetes Azure или экземпляров контейнеров Azure. Она позволяет собирать данные метрик памяти и процессора из контроллеров, узлов и контейнеров, доступных в Kubernetes, с помощью API метрик. Он также собирает журналы контейнеров и данные инвентаризации о контейнерах и их образах. Стандартные критерии работоспособности, основанные на собранных данных о производительности, помогают определить, существует ли проблема с узким местом или емкостью ресурса. Можно также оценить общую производительность или производительность определенного типа объекта Kubernetes (Pod, узла, контроллера или контейнера).

## <a name="analyze-data"></a>Анализ данных

### <a name="operations-manager"></a>Operations Manager

Operations Manager предоставляет четыре основных способа анализа данных после их сбора.

- **Анализатор работоспособности:** Помогает определить, какие мониторы идентифицируют проблемы с состоянием работоспособности и просмотреть сведения о мониторе и возможных причинах, связанных с ним.

- **Представления:** Предлагает предопределенные визуализации собранных данных, например диаграмму данных о производительности или список отслеживаемых компонентов и их текущее состояние работоспособности. Представления схемы визуально представляют модель службы приложения.

- **Отчеты:** Позволяют суммировать исторические данные, хранящиеся в хранилище данных Operations Manager. Можно настроить данные, на которых основаны представления и отчеты. Однако не существует функции, позволяющей выполнять сложный или интерактивный анализ собранных данных.

- **Командная оболочка Operations Manager:** Расширяет Windows PowerShell с помощью дополнительного набора командлетов и может запрашивать и визуализировать собранные данные. К ним относятся графики и другие визуализации, встроенная с помощью PowerShell или веб-консоль на основе HTML Operations Manager.

### <a name="azure-monitor"></a>Azure Monitor

С помощью мощного механизма Azure Monitor Analytics можно интерактивно работать с данными журнала и объединять их с другими данными мониторинга для трендов и анализа данных. Представления и панели мониторинга позволяют визуализировать данные запроса различными способами из портал Azure и импортировать их в Power BI. Решения для мониторинга включают в себя запросы и представления для представления собранных данных. Аналитические сведения, такие как Application Insights, Azure Monitor для виртуальных машин и Azure Monitor для контейнеров, включают в себя настраиваемые визуализации для поддержки интерактивных сценариев мониторинга.

## <a name="alerting"></a>Оповещение

### <a name="operations-manager"></a>Operations Manager

Operations Manager создает предупреждения в ответ на предопределенные события, при достижении порогового значения производительности и при изменении состояния работоспособности отслеживаемого компонента. Она включает полное управление оповещениями, позволяющее устанавливать их разрешение и назначать их различным операторам или инженерам системы. Можно настроить правила уведомления, указывающие, какие оповещения будут отправлять упреждающие уведомления.

Пакеты управления включают в себя различные предопределенные правила предупреждений для различных критических условий в отслеживаемом приложении. Вы можете настроить эти правила или создать настраиваемые правила для конкретных требований среды.

### <a name="azure-monitor"></a>Azure Monitor

С помощью Azure Monitor можно создавать оповещения на основе метрики, пересекающие пороговое значение, или на основе запланированного результата запроса. Хотя оповещения, основанные на метриках, могут достичь результатов практически в реальном времени, запланированные запросы имеют более длительное время ответа в зависимости от скорости приема и индексирования данных. Вместо того чтобы ограничиваться конкретным агентом, следует вести журнал запросов в Azure Monitor позволяют анализировать данные по всем данным, хранящимся в нескольких рабочих областях. Эти предупреждения также включают данные из определенного приложения Application Insights с помощью межрабочей области запроса.

Хотя решения для мониторинга могут включать правила генерации оповещений, их обычно создаются на основе собственных требований.

## <a name="workflows"></a>Рабочие процессы

### <a name="operations-manager"></a>Operations Manager

Пакеты управления в Operations Manager содержат сотни отдельных рабочих процессов, которые определяют, какие данные должны быть собраны, и какие действия с этими данными выполняются. Например, правило может вычислить показания счетчика производительности каждые несколько минут, сохраняя результаты для анализа. Монитор может вычислить один и тот же счетчик производительности и сравнить его значение с пороговым значением, чтобы определить состояние работоспособности наблюдаемого объекта. Другое правило может выполнить сценарий для получения и анализа данных на компьютере агента, а затем запустить оповещение, если оно возвращает определенное значение.

Рабочие процессы в Operations Manager не зависят друг от друга, что затрудняет анализ нескольких наблюдаемых объектов. Эти сценарии мониторинга должны основываться на данных после их сбора, что возможно, но может быть трудной задачей и нечасто.

### <a name="azure-monitor"></a>Azure Monitor

Azure Monitor отделяет сбор данных от действий и анализа, полученных из этих данных. Агенты и другие источники данных записывают данные журнала в Log Analytics рабочую область и записывают данные метрик в базу данных метрик без какого-либо анализа этих данных или знания того, как они могут использоваться. Монитор выполняет оповещения и другие действия из сохраненных данных, что позволяет выполнять анализ данных из всех источников.

## <a name="extend-the-base-platform"></a>Расширение базовой платформы

### <a name="operations-manager"></a>Operations Manager

Operations Manager реализует все логики мониторинга в пакете управления, который вы создаете самостоятельно или получаете от США или от партнера. При установке пакета управления он автоматически обнаруживает компоненты приложения или службы на разных агентах и развертывает соответствующие правила и мониторы. Пакет управления содержит определения работоспособности, правила генерации оповещений, правила сбора сведений о производительности и событиях, а также представления для обеспечения полного мониторинга, поддерживающего службу или приложение инфраструктуры.

Operations Manager SDK позволяет Operations Manager интегрироваться со сторонними платформами мониторинга или программным обеспечением управление ИТ-услугами (ITSM). Пакет SDK также используется некоторыми пакетами управления партнерами для поддержки мониторинга сетевых устройств и предоставления пользовательских возможностей представления, таких как квадратная панель мониторинга HTML5 или интеграция с Microsoft Office Visio.

### <a name="azure-monitor"></a>Azure Monitor

Azure Monitor собирает метрики и журналы из ресурсов Azure с минимальными настройками. Решения для мониторинга добавляют логику для мониторинга приложения или службы, но они по-прежнему работают в стандартных запросах журнала и представлениях в мониторе. Аналитические сведения, такие как Application Insights и Azure Monitor для виртуальных машин, используют платформу мониторинга для сбора и обработки данных. Они также предоставляют дополнительные средства для визуализации и анализа данных. Вы можете объединять данные, собранные аналитическими сведениями, с другими данными, используя основные функции монитора, такие как запросы журнала и оповещения.

Монитор поддерживает несколько методов сбора данных мониторинга или управления из Azure или внешних ресурсов. Затем можно извлечь и переслать данные из хранилища метрик или журналов в средства ITSM или мониторинга. Также можно выполнять административные задачи с помощью REST API Azure Monitor.

## <a name="next-steps"></a>Дальнейшие действия

> [!div class="nextstepaction"]
> [Мониторинг моделей облачного развертывания](./cloud-models-monitor-overview.md)
