---
title: Руководство по мониторингу облака — стратегия мониторинга для моделей облачного развертывания
titleSuffix: Microsoft Cloud Adoption Framework for Azure
description: Выберите, когда следует использовать Azure Monitor или System Center Operations Manager в Microsoft Azure
author: MGoedtel
ms.author: magoedte
ms.date: 07/31/2019
ms.topic: guide
ms.service: cloud-adoption-framework
ms.subservice: operate
services: azure-monitor
ms.openlocfilehash: 3659f5e965e5a80c3b490f8b106a4cc30f1711a9
ms.sourcegitcommit: 443c28f3afeedfbfe8b9980875a54afdbebd83a8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "71030415"
---
# <a name="cloud-monitoring-guide-monitoring-strategy-for-cloud-deployment-models"></a>Руководство по облачному мониторингу: Стратегия мониторинга для моделей облачного развертывания

Эта статья содержит рекомендованную стратегию мониторинга для каждой модели облачного развертывания на основе следующих критериев.

- Вам потребовалось продолжать обязательства по Operations Manager или другой корпоративной платформе мониторинга. Это обусловлено интеграцией с процессами ИТ-операций, знаниями и опытом, а также тем, что некоторые функции пока недоступны в Azure Monitor.
- Необходимо отслеживать рабочие нагрузки как локально, так и в общедоступном облаке или только в облаке.
- Стратегия миграции в облако включает модернизации ИТ и переход к нашим облачным службам и решениям мониторинга.
- У вас могут быть критически важные системы, гаппед или физически изолированные, размещенные в частном облаке или на физическом оборудовании, и их необходимо отслеживать.

Наша стратегия включает поддержку инфраструктуры мониторинга (вычислений, хранилища и рабочих нагрузок сервера), приложения (конечных пользователей, исключений и клиентов), а также сетевых ресурсов для предоставления комплексной перспективы мониторинга, ориентированной на службы.

## <a name="azure-cloud-monitoring"></a>Мониторинг облака Azure

Служба платформы Azure Monitor — это единый источник для мониторинга ресурсов Azure. Он предназначен для облачных решений, построенных на платформе Azure и поддерживающих бизнес-возможности, основанные на рабочих нагрузках виртуальных машин или сложных архитектурах, использующих микрослужбы и другие ресурсы платформы. Он отслеживает все слои стека, начиная с служб клиента, таких как Azure Active Directory доменных служб, а также событий уровня подписки и работоспособности службы Azure. Кроме того, он отслеживает ресурсы инфраструктуры, такие как виртуальные машины, хранилище и сетевые ресурсы, а также на верхнем уровне приложения. Мониторинг каждой из этих зависимостей и сбор правильных сигналов, которые каждый из них может порождать, дает вам наблюдаемые приложения и необходимую инфраструктуру ключей.

В следующей таблице приведена сводка рекомендуемых подходов к мониторингу каждого уровня стека.

<!-- markdownlint-disable MD033 -->

Слой | Resource | `Scope` | Метод
---|---|---|----
Приложение | Веб-приложение, работающее на платформе .NET, .NET Core, Java, JavaScript и Node. js на виртуальной машине Azure, в службах приложений Azure, Service Fabric Azure, функциях Azure и облачных службах Azure. | Отслеживайте активное веб-приложение для автоматического обнаружения аномалий производительности, выявления исключений и проблем с кодом, а затем собирайте данные телеметрии использования. |  Application Insights
Контейнеры | Служба Kubernetes Azure/экземпляры контейнеров Azure | Мониторинг емкости, доступности и производительности рабочих нагрузок, выполняемых в контейнерах и экземплярах контейнеров. | Azure Monitor для контейнеров
Операционная система на виртуальной машине | Операционная система Linux и Windows VM | Мониторинг емкости, доступности и производительности. Сопоставьте зависимости, размещенные на каждой виртуальной машине, включая видимость активных сетевых подключений между серверами, задержкой входящего и исходящего подключения и портами в любой архитектуре, подключенной по протоколу TCP. | Azure Monitor для виртуальных машин
Ресурсы Azure — PaaS | Службы баз данных Azure (например, SQL или mySQL) | Метрики производительности базы данных Azure для SQL. | Включите ведение журнала диагностики для потоковой передачи данных SQL в журналы Azure Monitor.
Ресурсы Azure — IaaS | 1. Служба хранилища Azure<br/> 2. Шлюз приложений Azure<br/> 3. Хранилище Azure Key Vault<br/> 4. Группы безопасности сети<br/> 5. Диспетчер трафика Azure | 1. Емкость, доступность и производительность.<br/> 2. Журналы производительности и диагностики (активность, доступ, производительность и брандмауэр).<br/> 3. Отслеживайте, как и когда осуществляется доступ к хранилищам ключей и кто.<br/> 4. Отслеживайте события при применении правил и счетчики, определяющие, сколько раз правило применяется к запрету или разрешению.<br/>5. Отслеживание доступности состояния конечных точек. | 1. Метрики хранилища для хранилища BLOB-объектов.<br/> 2. Включите ведение журнала диагностики и настройте потоковую передачу для Azure Monitor журналов.<br/> 3. Включите ведение журнала диагностики и настройте потоковую передачу для Azure Monitor журналов и включите [решение Azure Key Vault Analytics](https://docs.microsoft.com/azure/azure-monitor/insights/azure-key-vault). <br/> 4. Включите ведение журнала диагностики групп безопасности сети и настройте потоковую передачу для Azure Monitor журналов.<br/> 5. Включите ведение журнала диагностики конечных точек диспетчера трафика и настройте потоковую передачу для Azure Monitor журналов.
Network| Обмен данными между виртуальной машиной и одной или несколькими конечными точками (другой виртуальной машиной, полным доменным именем, универсальным идентификатором ресурса или IPv4-адресом). | Следите за достижимостью, задержкой и изменениями топологии сети, которые происходят между виртуальной машиной и конечной точкой. | Наблюдатель за сетями Azure
Подписка Azure | Работоспособность службы Azure и основная работоспособность ресурсов | <li> Административные действия, выполняемые в службе или ресурсе.<br/><li> Работоспособность службы в службе Azure находится в состоянии пониженной работоспособности или недоступности.<br/><li> Проблемы работоспособности, обнаруженные ресурсом Azure с точки зрения службы Azure.<br/><li> Операции, выполняемые с помощью автомасштабирования Azure, указывают на ошибку или исключение. <br/><li> Операции, выполняемые с помощью политики Azure, указывающие на то, что произошло разрешенное или отклоненное действие.<br/><li> Запись предупреждений, созданных центром безопасности Azure. |Доставляется в журнал действий для мониторинга и оповещений с помощью Azure Resource Manager.
Клиент Azure|Azure Active Directory || Включите ведение журнала диагностики и настройте потоковую передачу для Azure Monitor журналов.

<!-- markdownlint-enable MD033 -->

## <a name="hybrid-cloud-monitoring"></a>Гибридный мониторинг облака

В настоящее время этот раздел находится на стадии разработки, чтобы предоставить исчерпывающий набор рекомендаций, предназначенных для решения этой облачной модели, и вскоре станет доступным.  

## <a name="private-cloud-monitoring"></a>Мониторинг частного облака

Можно обеспечить целостный мониторинг Azure Stack с System Center Operations Manager. В частности, можно отслеживать рабочие нагрузки, выполняемые в клиенте, на уровне ресурсов, на виртуальных машинах и в инфраструктуре размещения Azure Stack (физические серверы и сетевые коммутаторы). Вы также можете добиться целостного мониторинга с помощью сочетания [возможностей мониторинга инфраструктуры](https://docs.microsoft.com/azure/azure-stack/azure-stack-monitor-health) , входящих в Azure Stack. Эти возможности помогают просматривать работоспособность и оповещения для Azure Stack региона и [службы Azure Monitor](https://docs.microsoft.com/azure/azure-stack/user/azure-stack-metrics-azure-data) в Azure Stack, которая предоставляет метрики и журналы инфраструктуры базового уровня для большинства служб.

Если вы уже собрались в Operations Manager, используйте пакет управления Azure Stack, чтобы отслеживать состояние доступности и работоспособности Azure Stack развертываний. Сюда входят регионы, поставщики ресурсов, обновления, запуски обновлений, единицы масштабирования, узлы единиц, роли инфраструктуры и их экземпляры (логические сущности, состоящие из аппаратных ресурсов). Для взаимодействия с Azure Stack в нем используются API-интерфейсы RESTFUL поставщика ресурсов работоспособности и обновления. Для мониторинга физических серверов и запоминающих устройств используйте пакет управления поставщика OEM (например, предоставляемый компанией Lenovo, Hewlett Packard или Dell). Operations Manager может самостоятельно отслеживать сетевые коммутаторы для сбора базовой статистики с помощью протокола SNMP. Наблюдение за рабочими нагрузками клиента возможно с помощью пакета управления Azure, выполнив два основных шага. Настройте подписку, которую требуется отслеживать, а затем добавьте мониторы для этой подписки.

## <a name="next-steps"></a>Следующие шаги

> [!div class="nextstepaction"]
> [Сбор требуемых данных](./data-collection.md)
