---
title: Планирование необходимых компонентов для служб управления Azure Server
description: Необходимые средства и планирование для служб управления Azure Server
author: BrianBlanchard
ms.author: brblanch
ms.date: 05/10/2019
ms.topic: article
ms.service: cloud-adoption-framework
ms.subservice: operate
ms.openlocfilehash: 934263f5c143d021ce97125f025f96d8ae6f338f
ms.sourcegitcommit: 2362fb3154a91aa421224ffdb2cc632d982b129b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/28/2020
ms.locfileid: "76807977"
---
# <a name="phase-1-prerequisite-planning-for-azure-server-management-services"></a>Этап 1. планирование необходимых компонентов для служб управления сервером Azure

На этом этапе вы знакомы с набором служб Azure Server Management Suite и планируете развертывание ресурсов, необходимых для реализации этих решений по управлению.

## <a name="understand-the-tools-and-services"></a>Общие сведения о средствах и службах

Подробные сведения о [средствах и службах управления сервером Azure](./tools-services.md) см. в следующих руководствах:

- Области управления, участвующие в текущих операциях Azure.
- Службы и средства Azure, которые помогают поддерживать вас в этих областях.

Несколько этих служб будут использоваться вместе в соответствии с вашими требованиями к управлению. Эти средства часто упоминаются в рамках этого руководства.

В следующих разделах рассматриваются планирование и подготовка, необходимые для использования этих средств и служб.

## <a name="log-analytics-workspace-and-automation-account-planning"></a>Планирование учетных записей рабочей области и службы автоматизации Log Analytics

Для многих служб, которые будут использоваться для подключения служб управления Azure, требуется рабочая область Log Analytics и связанная учетная запись службы автоматизации Azure.

[Рабочая область Log Analytics](https://docs.microsoft.com/azure/azure-monitor/learn/quick-create-workspace) — это уникальная среда для хранения данных журналов Azure Monitor. Каждая рабочая область имеет собственный репозиторий данных и конфигурацию. Источники данных и решения настраиваются для хранения данных в определенных рабочих областях. Решениям для мониторинга Azure требуется подключение всех серверов к рабочей области, чтобы их данные журналов можно было хранить и получать к ним доступ.

Для некоторых служб управления требуется учетная запись службы [автоматизации Azure](https://docs.microsoft.com/azure/automation/automation-intro) . Эта учетная запись и возможности службы автоматизации Azure используются для интеграции служб Azure и других общедоступных систем для развертывания, настройки и управления процессами управления сервером.

Для следующих служб управления сервером Azure требуется связанная Рабочая область Log Analytics и учетная запись службы автоматизации:

- [Управление обновлениями Azure](https://docs.microsoft.com/azure/automation/automation-update-management)
- [Отслеживание изменений и Инвентаризация](https://docs.microsoft.com/azure/automation/change-tracking)
- [Гибридный компонент Runbook Worker](https://docs.microsoft.com/azure/automation/automation-hybrid-runbook-worker)
- [Настройка требуемого состояния](https://docs.microsoft.com/azure/virtual-machines/extensions/dsc-overview)

Вторая фаза этого руководства посвящена развертыванию служб и скриптов автоматизации. В нем показано, как создать рабочую область Log Analytics и учетную запись службы автоматизации. В этом руководстве также показано, как использовать политику Azure, чтобы убедиться, что новые виртуальные машины подключены к нужной рабочей области.

В примерах этого руководства предполагается, что развертывание еще не развернуло серверы, развернутые в облаке. Дополнительные сведения о принципах и вопросах, связанных с планированием рабочих областей, см. [в статье Управление данными журнала и рабочими областями в Azure Monitor](https://docs.microsoft.com/azure/azure-monitor/platform/manage-access).

## <a name="planning-considerations"></a>Рекомендации относительно планирования

При подготовке рабочих областей и учетных записей, необходимых для адаптации служб управления, учитывайте следующие моменты.

- **География и соответствие нормативам Azure:** Регионы Azure организованы в *географические*области. [География Azure](https://azure.microsoft.com/global-infrastructure/geographies) гарантирует, что требования к местонахождение данных, независимости, соответствие требованиям и устойчивости будут учитываться в географических границах. Если ваши рабочие нагрузки подчиняются независимости данных или другим требованиям соответствия требованиям, рабочие области и учетные записи автоматизации должны быть развернуты в регионах в пределах того же Azure, что и ресурсы рабочей нагрузки, которые они поддерживают.
- **Число рабочих областей:** В качестве принципа GUID создайте минимальное число рабочих областей, необходимое для каждого региона Azure. Мы рекомендуем по крайней мере одну рабочую область для каждого географического хранилища Azure, где находятся ресурсы для вычислений или хранения. Это начальное выравнивание позволяет избежать будущих нормативных расходов при переносе данных в различные географические регионы.
- **Хранение и выделение данных:** При создании рабочих областей или учетных записей автоматизации может также потребоваться использовать политики хранения данных или требования ограниченного выделения данных. Дополнительные сведения об этих принципах и дополнительные рекомендации по планированию рабочих областей см. в статье [Управление данными журнала и рабочими областями в Azure Monitor](https://docs.microsoft.com/azure/azure-monitor/platform/manage-access).
- **Сопоставление регионов:** Связывание Log Analytics рабочей области и учетной записи службы автоматизации Azure поддерживается только между определенными регионами Azure. Например, если Рабочая область Log Analytics размещается в регионе *EastUS* , связанная учетная запись автоматизации должна быть создана в регионе *EastUS2* для использования со службами управления. Если у вас есть учетная запись службы автоматизации, созданная в другом регионе, она не сможет установить связь с рабочей областью в *EastUS*. Выбор региона развертывания может значительно повлиять на требования Azure geography. Просмотрите [таблицу "сопоставление регионов](https://docs.microsoft.com/azure/automation/how-to/region-mappings) ", чтобы выбрать регион для размещения рабочих областей и учетных записей автоматизации.
- **Многосайтовая Рабочая область:** В некоторых сценариях агент Azure Log Analytics поддерживает несколько сетевых возможностей, но при выполнении этой конфигурации агент сталкивается с несколькими ограничениями и проблемами. Если корпорация Майкрософт не рекомендовала его для конкретного сценария, мы не рекомендуем настраивать многосетевых параметров в агенте Log Analytics.

## <a name="resource-placement-examples"></a>Примеры размещения ресурсов

Существует несколько различных моделей выбора подписки, в которую вы размещаете Log Analytics рабочую область и учетную запись службы автоматизации. Вкратце, разместите рабочую область и учетные записи службы автоматизации в подписке, принадлежащей группе, которая отвечает за реализацию службы Управление обновлениями и службы Отслеживание изменений и инвентаризации.

Ниже приведены примеры некоторых способов развертывания рабочих областей и учетных записей автоматизации.

### <a name="placement-by-geography"></a>Размещение по географическому положению

В малых и средних средах есть одна подписка и несколько сотен ресурсов, охватывающих несколько географических регионов Azure. Для этих сред создайте одну рабочую область Log Analytics и одну учетную запись службы автоматизации Azure в каждом географическом регионе.

В каждой группе ресурсов можно создать рабочую область и учетную запись службы автоматизации Azure в виде одной пары. Затем разверните пару в соответствующем географическом регионе для виртуальных машин.

Кроме того, если политики соответствия данных не определяют, что ресурсы находятся в конкретных регионах, можно создать одну пару для управления всеми виртуальными машинами. Мы также рекомендуем разместить пары учетных записей рабочей области и службы автоматизации в отдельных группах ресурсов, чтобы обеспечить более детализированный контроль доступа на основе ролей (RBAC).

Пример на следующей диаграмме содержит одну подписку с двумя группами ресурсов, которые расположены в разных регионах:

![Модель рабочей области для малых и средних сред](./media/workspace-model-small.png)

### <a name="placement-in-a-management-subscription"></a>Размещение в подписке на управление

Более крупные среды охватывают несколько подписок и имеют центральную ИТ-отдел, который владеет мониторингом и соответствием. Для этих сред создайте пары рабочих областей и учетных записей автоматизации в подписке ИТ. В этой модели ресурсы виртуальной машины в географическом регионе хранят свои данные в соответствующей рабочей области geography в подписке ИТ-управления. Если группам приложений требуется запускать задачи автоматизации, но не требуется связанная Рабочая область и учетные записи автоматизации, они могут создавать отдельные учетные записи службы автоматизации в собственных подписках приложений.

![Модель рабочей области для крупных сред](./media/workspace-model-large.png)

### <a name="decentralized-placement"></a>Децентрализованное размещение

В альтернативной модели для крупных сред группа разработчиков приложений может отвечать за установку исправлений и управление. В этом случае разместите пары учетной записи рабочей области и службы автоматизации в подписках группы приложений вместе с другими ресурсами.

  ![Модель учетной записи рабочей области для децентрализованных сред](./media/workspace-model-decentralized.png)

## <a name="create-a-workspace-and-automation-account"></a>Создание рабочей области и учетной записи службы автоматизации

Выбрав лучший способ размещения и упорядочения пар рабочей области и учетной записи, убедитесь, что вы создали эти ресурсы перед началом процесса адаптации. В примерах автоматизации, приведенных далее в этом руководстве, создается пара учетных записей для рабочей области и службы автоматизации. Однако если вы хотите подключить с помощью портал Azure и у вас нет существующей пары рабочей области и учетной записи службы автоматизации, необходимо создать ее.

Сведения о создании рабочей области Log Analytics с помощью портал Azure см. в разделе [Создание рабочей области](https://docs.microsoft.com/azure/azure-monitor/learn/quick-create-workspace#create-a-workspace). Затем создайте соответствующую учетную запись службы автоматизации для каждой рабочей области, выполнив действия, описанные в разделе [Создание учетной записи службы автоматизации Azure](https://docs.microsoft.com/azure/automation/automation-quickstart-create-account).

> [!NOTE]
> При создании учетной записи службы автоматизации с помощью портал Azure портал по умолчанию пытается создать учетные записи запуска от имени как для Azure Resource Manager, так и для классической модели развертывания. Если у вас нет классических виртуальных машин в вашей среде и вы не являетесь соадминистратором подписки, на портале создается учетная запись запуска от имени для диспетчер ресурсов, но при развертывании классической учетной записи запуска от имени выдается ошибка. Если вы не планируете поддерживать классические ресурсы, эту ошибку можно пропустить.
>
> Вы также можете создавать учетные записи запуска от имени с помощью [PowerShell](https://docs.microsoft.com/azure/automation/manage-runas-account#create-run-as-account-using-powershell).

## <a name="next-steps"></a>Дальнейшие действия

Узнайте, как подключить [серверы](./onboarding-overview.md) к службам управления сервером Azure.

> [!div class="nextstepaction"]
> [Подключение к службам управления сервером Azure](./onboarding-overview.md)
