---
title: Автоматизация адаптации
description: Используйте образцы файлов для адаптации, чтобы помочь вам в автоматизации развертывания служб управления сервером Azure для повышения эффективности.
author: BrianBlanchard
ms.author: brblanch
ms.date: 05/10/2019
ms.topic: conceptual
ms.service: cloud-adoption-framework
ms.subservice: operate
ms.openlocfilehash: b3c32b6d6afa9b640dd379230865728fbd53c925
ms.sourcegitcommit: af521583b98153f7157895b7ba9de71183d437b0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/31/2020
ms.locfileid: "89176486"
---
# <a name="automate-onboarding"></a>Автоматизация адаптации

Чтобы повысить эффективность развертывания служб управления сервером Azure, рассмотрите возможность автоматизации развертывания, как описано в предыдущих разделах этого руководства. Скрипт и примеры шаблонов, приведенные в следующих разделах, являются начальными точками для разработки собственной автоматизации процессов адаптации.

Это руководство содержит вспомогательный репозиторий примера кода [клаудадоптионфрамеворк](https://aka.ms/caf/manage/automation-samples). В репозитории представлены примеры сценариев и шаблоны Azure Resource Manager, помогающие автоматизировать развертывание служб управления сервером Azure.

В примерах файлов показано, как использовать командлеты Azure PowerShell для автоматизации следующих задач:

- Создайте [рабочую область log Analytics](/azure/azure-monitor/platform/manage-access). (Или используйте существующую рабочую область, если она соответствует требованиям. Дополнительные сведения см. в разделе [планирование рабочей области](./prerequisites.md#log-analytics-workspace-and-automation-account-planning).

- Создайте учетную запись службы автоматизации или используйте существующую учетную запись, которая соответствует требованиям. Дополнительные сведения см. в разделе [планирование рабочей области](./prerequisites.md#log-analytics-workspace-and-automation-account-planning).

- Свяжите учетную запись службы автоматизации и рабочую область Log Analytics. Этот шаг не требуется при адаптации с помощью портал Azure.

- Включите Управление обновлениями, а также Отслеживание изменений и инвентаризацию для рабочей области.

- Подключение виртуальных машин Azure с помощью политики Azure. Политика устанавливает агент Log Analytics и Microsoft Dependency Agent на виртуальных машинах Azure.

- Автоматическое включение службы архивации Azure для виртуальных машин с помощью [политики Azure](https://docs.microsoft.com/azure/backup/backup-azure-auto-enable-backup)

- Подключите локальные серверы, установив на них агент Log Analytics.

В этом примере используются файлы, описанные в следующей таблице. Их можно настроить для поддержки собственных сценариев развертывания.

| Имя файла | Описание |
|-----------|-------------|
| `New-AMSDeployment.ps1` | Главный, координирующий сценарий, автоматизирующий подключение. Он создает группы ресурсов, расположение, рабочую область и учетные записи автоматизации, если они еще не существуют. Для этого скрипта PowerShell требуется существующая подписка. |
| `Workspace-AutomationAccount.json` | Шаблон диспетчер ресурсов, который развертывает ресурсы рабочей области и учетной записи службы автоматизации. |
| `WorkspaceSolutions.json` | Шаблон диспетчер ресурсов, который включает необходимые решения в рабочей области Log Analytics. |
| `ScopeConfig.json` | Шаблон диспетчер ресурсов, использующий модель согласия для локальных серверов с решением Отслеживание изменений. Использовать модель согласия необязательно. |
| `Enable-VMInsightsPerfCounters.ps1` | Сценарий PowerShell, позволяющий выполнять аналитику виртуальных машин для серверов и настраивать счетчики производительности. |
| `ChangeTracking-FileList.json` | Шаблон диспетчер ресурсов, определяющий список файлов, которые будут отслеживаться Отслеживание изменений. |

Для запуска выполните следующую команду `New-AMSDeployment.ps1` :

```powershell
.\New-AMSDeployment.ps1 -SubscriptionName '{Subscription Name}' -WorkspaceName '{Workspace Name}' -WorkspaceLocation '{Azure Location}' -AutomationAccountName {Account Name} -AutomationAccountLocation {Account Location}
```

## <a name="next-steps"></a>Дальнейшие действия

Узнайте, как настроить базовые оповещения для уведомления команды о событиях и проблемах управления ключами.

> [!div class="nextstepaction"]
> [Настройка базовых оповещений](./setup-alerts.md)
