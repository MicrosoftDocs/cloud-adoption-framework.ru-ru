---
title: Проектирование и эксплуатация кластеров
description: Узнайте о Kubernetes в облачной инфраструктуре внедрения для проектирования и эксплуатации кластеров.
author: sabbour
ms.author: asabbour
ms.date: 12/16/2019
ms.topic: conceptual
ms.service: cloud-adoption-framework
ms.subservice: innovate
ms.openlocfilehash: 31ea5b2e5906f08de5197906b57cbe32337e80f9
ms.sourcegitcommit: afe10f97fc0e0402a881fdfa55dadebd3aca75ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/31/2020
ms.locfileid: "80426842"
---
<!-- cSpell:ignore asabbour sabbour autoscaler PDBs -->

# <a name="cluster-design-and-operations"></a>Проектирование и эксплуатация кластеров

Определите конфигурацию и сетевую структуру кластера. Масштабируемость в будущем путем автоматизации подготовки инфраструктуры. Поддерживайте высокий уровень доступности, планируя непрерывность бизнес-процессов и аварийное восстановление.

## <a name="plan-train-and-proof"></a>Планирование, обучение и подтверждение

По мере того как вы приступите к работе, контрольный список и приведенные ниже ресурсы помогут вам спланировать структуру кластера. Вы можете ответить на следующие вопросы:

<!-- markdownlint-disable MD033 -->

> [!div class="checklist"]
>
> - Определили ли вы требования к проектированию сети для кластера?
> - У вас есть рабочие нагрузки с различными требованиями? Сколько пулов узлов вы собираетесь использовать?

<!-- -->

> [!div class="tdCol2BreakAll"]
>
> | Контрольный список  | Ресурсы |
> |------------------------------------------------------------------|-----------------------------------------------------------------|
> | **Выявление рекомендаций по проектированию сети.** Ознакомьтесь с вопросами по проектированию сети кластера, Сравните сетевые модели и выберите подключаемый модуль Kubernetes Networking, соответствующий вашим потребностям.    | [Кубенет и сетевой интерфейс контейнеров Azure (CNI)](https://docs.microsoft.com/azure/aks/concepts-network#azure-virtual-networks) <br/> [Использование кубенет Network с собственными диапазонами IP-адресов в службе Kubernetes Azure (AKS)](https://docs.microsoft.com/azure/aks/configure-kubenet) <br/> [Настройка сети Azure CNI в службе Kubernetes Azure (AKS)](https://docs.microsoft.com/azure/aks/configure-azure-cni) <br/> [Разработка безопасной сети для кластера AKS](https://github.com/Azure/sg-aks-workshop/blob/master/cluster-design/NetworkDesign.md)|
> | **Создайте несколько пулов узлов.** Для поддержки приложений, имеющих различные требования к вычислению или хранению, при необходимости можно настроить кластер с несколькими пулами узлов. Например, используйте дополнительные пулы узлов, чтобы предоставить графические процессоры для приложений с большим объемом вычислений или доступ к высокопроизводительному хранилищу SSD.   | [Создание нескольких пулов узлов для кластера и управление им в службе Kubernetes Azure](https://docs.microsoft.com/azure/aks/use-multiple-node-pools) |
> | **Решите требования к доступности.** Чтобы обеспечить более высокий уровень доступности приложений, кластеры можно распределять между зонами доступности. Эти зоны являются физически отдельными центрами обработки данных в пределах заданного региона. Когда компоненты кластера распределяются по нескольким зонам, кластер может допускать сбои в одной из этих зон. Приложения и операции управления по-прежнему будут доступны, даже если у всего центра обработки данных возникла проблема.   | [Создание кластера Azure Kubernetes Service (AKS), использующего зоны доступности](https://docs.microsoft.com/azure/aks/availability-zones) |

## <a name="go-to-production-and-apply-best-practices"></a>Перейдите в рабочую среду и примените рекомендации

При подготовке приложения для рабочей среды следует реализовать минимальный набор рекомендаций. На этом этапе используйте контрольный список. Вы должны иметь возможность ответить на следующие вопросы:

> [!div class="checklist"]
>
> - Вы можете уверенно повторно развернуть инфраструктуру кластера?
> - Были ли вы применены квоты ресурсов?

<!-- -->

> [!div class="tdCol2BreakAll"]
>
> | Контрольный список  | Ресурсы                                                                                                     |
> |------------------------------------------------------------------|-----------------------------------------------------------------|
> | **Автоматизируйте подготовку кластера.** С помощью инфраструктуры в качестве кода можно автоматизировать подготовку инфраструктуры, чтобы обеспечить повышенную устойчивость во время аварийных ситуаций и повысить гибкость при необходимости быстрого повторного развертывания инфраструктуры.     | [Создание кластера Kubernetes со службой Kubernetes Azure с помощью terraform](https://docs.microsoft.com/azure/terraform/terraform-create-k8s-cluster-with-tf-and-aks)|
> | **Планируйте доступность с помощью бюджетов прерываний Pod.** Чтобы обеспечить доступность приложений, определите бюджеты перерывов в устройстве (PDB), чтобы обеспечить доступность в кластере минимального числа модулей Pod при сбоях оборудования или обновлении кластера. | [Планирование доступности с использованием бюджетов нарушений Pod](https://docs.microsoft.com/azure/aks/operator-best-practices-scheduler#plan-for-availability-using-pod-disruption-budgets)  |
> | **Применение квот ресурсов для пространств имен.** Спланируйте и примените квоты ресурсов на уровне пространства имен. Квоты могут быть установлены для ресурсов вычислений, ресурсов хранилища и числа объектов.| [Принудительное применение квот ресурсов](https://docs.microsoft.com/azure/aks/operator-best-practices-scheduler#enforce-resource-quotas)  |

## <a name="optimize-and-scale"></a>Оптимизация и масштабирование

Теперь, когда приложение находится в рабочей среде, как можно оптимизировать рабочий процесс и подготовить приложение и команду к масштабированию? Используйте контрольный список оптимизации и масштабирования для подготовки. Вы должны иметь возможность ответить на следующие вопросы:

> [!div class="checklist"]
>
> - Есть ли у вас план обеспечения непрерывности бизнес-процессов и аварийного восстановления?
> - Можно ли масштабировать кластер в соответствии с потребностями приложений?
> - Вы можете отслеживать работоспособность кластера и приложения и получать оповещения?

<!-- -->

> [!div class="tdCol2BreakAll"]
>
> | Контрольный список  | Ресурсы |
> |------------------------------------------------------------------|-----------------------------------------------------------------|
> | **Автоматическое масштабирование кластера в соответствии с потребностями приложений.** Чтобы справиться с потребностями приложений, может потребоваться изменить число узлов, которые запускают рабочие нагрузки, автоматически с помощью автомасштабирования кластера. | [Настройка автомасштабирования кластера Kubernetes](https://docs.microsoft.com/azure/aks/cluster-autoscaler)    |
> | **Спланируйте непрерывность бизнес-процессов и аварийное восстановление.** Спланируйте развертывание в многорегионом, создайте план миграции хранилища и включите георепликацию для образов контейнеров. | [Рекомендации по развертыванию в нескольких регионах](https://docs.microsoft.com/azure/aks/operator-best-practices-multi-region)  <br/> [Георепликация реестра контейнеров Azure](https://docs.microsoft.com/azure/container-registry/container-registry-geo-replication)  |
> | **Настройка мониторинга и устранения неполадок в масштабе.** Настройка оповещений и мониторинга для приложений в Kubernetes. Узнайте о конфигурации по умолчанию, о том, как интегрировать более сложные метрики и как добавить собственные настраиваемые средства мониторинга и оповещения для надежной работы приложения. | [Начало работы с мониторингом и оповещениями для Kubernetes (видео)](https://www.youtube.com/watch?v=W7aN_z-cyUw&list=PLLasX02E8BPCrIhFrc_ZiINhbRkYMKdPT&index=16) <br/> [Настройка оповещений с помощью Azure Monitor для контейнеров](https://docs.microsoft.com/azure/azure-monitor/insights/container-insights-overview) <br/> [Обзор журналов диагностики для основных компонентов](https://docs.microsoft.com/azure/aks/view-master-logs) <br/> [Диагностика службы Azure Kubernetes Service (AKS)](https://docs.microsoft.com/azure/aks/concepts-diagnostics)    |
